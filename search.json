[{"title":"本站指引","url":"/posts/202012-b.html","content":"\n    <div class=\"note-plugin info\">\n      <span class=\"note-plugin__icon note-plugin__icon--info\">\n              <i class=\"fas fa-info-circle\"></i>\n            </span>\n      <p><strong>Tips</strong><br />如果您来自搜索引擎，可以再次使用右上角搜索内容</p>\n    </div>\n  \n<p>  这里是FF的博客，访问地址为 <a href=\"https://foolishfox.cn\">https://foolishfox.cn</a>，使用<code>Hexo</code>生成。</p>\n<ul>\n<li>境外部署在<code>Github Pages</code>，访问地址为：<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://yihui-liu.github.io\" >https://yihui-liu.github.io</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li>境内部署在<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.aliyun.com/1111/new?userCode=bwlcyen4\" >阿里云</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>ECS上，使用又拍云CDN加速，访问地址为：<a href=\"https://foolishfox.cn\">https://foolishfox.cn</a></li>\n</ul>\n<span id=\"more\"></span>\n\n        <h2 id=\"订阅我\"   >\n          <a href=\"#订阅我\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#订阅我\"></a> 订阅我</h2>\n      \n<p>  你可以通过<a href=\"/atom.xml\">RSS</a>来订阅本站的内容</p>\n\n        <h2 id=\"推荐页面\"   >\n          <a href=\"#推荐页面\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#推荐页面\"></a> 推荐页面</h2>\n      \n<ol>\n<li>关于我的介绍，<a href=\"/s/about\">戳这里</a></li>\n<li>我的锻炼记录，<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://run.foolishfox.cn/\" >戳这里</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li>博客访问记录，<a href=\"/s/statistics/\">戳这里</a></li>\n<li>镜像加速访问，<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://mirror.ffox.ml/\" >戳这里</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ol>\n<p>  更多页面请查看<a href=\"/s/lab/\">实验室</a></p>\n\n        <h2 id=\"文章系列\"   >\n          <a href=\"#文章系列\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#文章系列\"></a> 文章系列</h2>\n      \n\n        <h3 id=\"博客成长日志\"   >\n          <a href=\"#博客成长日志\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#博客成长日志\"></a> 博客成长日志</h3>\n      \n<ol>\n<li><a href=\"/posts/202012-heog.html\">博客成长日志 | 使用Hexo搭建博客</a></li>\n<li><a href=\"/posts/202103-move.html\">博客成长日志 | 服务器迁移</a></li>\n<li><a href=\"/posts/202104-waline.html\">博客成长日志 | 评论系统Waline</a></li>\n<li><a href=\"/posts/202105-visit.html\">博客成长日志 | 访问统计</a></li>\n</ol>\n\n        <h3 id=\"ae9ap9spm\"   >\n          <a href=\"#ae9ap9spm\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#ae9ap9spm\"></a> AE9/AP9/SPM</h3>\n      \n<ol>\n<li><a href=\"/posts/202102-ae9-1.html\">AE9/AP9/SPM | 介绍与安装</a></li>\n<li><a href=\"/posts/202102-ae9-2.html\">AE9/AP9/SPM | 输入文件</a></li>\n<li><a href=\"/posts/202102-ae9-3.html\">AE9/AP9/SPM | 输出数据</a></li>\n<li><a href=\"/posts/202103-ae9-4.html\">AE9/AP9/SPM | GUI使用</a></li>\n</ol>\n\n        <h3 id=\"天文\"   >\n          <a href=\"#天文\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#天文\"></a> 天文</h3>\n      \n<ol>\n<li><a href=\"/posts/202004-d.html\">夜空 | 2020-03-31</a></li>\n<li><a href=\"/posts/202004-b.html\">哈勃分歧 | 1.测定</a></li>\n<li><a href=\"/posts/202004-c.html\">哈勃分歧 | 2.分析</a></li>\n<li><a href=\"/posts/202009-a.html\">星座与节气</a></li>\n</ol>\n\n        <h3 id=\"大宋清平\"   >\n          <a href=\"#大宋清平\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#大宋清平\"></a> 大宋清平</h3>\n      \n<ol>\n<li><a href=\"/posts/202004-a.html\">大宋清平 | 0.大宋之辩</a></li>\n</ol>\n\n        <h3 id=\"ros\"   >\n          <a href=\"#ros\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#ros\"></a> ROS</h3>\n      \n<ol>\n<li><a href=\"/posts/202101-rosinstall.html\">在Ubuntu18.04安装ROS</a></li>\n</ol>\n\n        <h3 id=\"windows\"   >\n          <a href=\"#windows\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#windows\"></a> Windows</h3>\n      \n<ol>\n<li><a href=\"/posts/202101-a.html\">Windows | 包管理器Scoop的安装与使用</a></li>\n</ol>\n","categories":["随记"]},{"title":"星座故事 | 大熊座与小熊座","url":"/posts/202105-constellation1.html","content":"\n        <h2 id=\"传说\"   >\n          <a href=\"#传说\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#传说\"></a> 传说</h2>\n      \n<p>  在古代希腊的神话故事中，大熊是温柔美丽的少女卡力斯托的化身。传说卡力斯托被众神之王宙斯所爱，生下了儿子阿卡斯。宙斯的妻子赫拉知道后非常气愤，她决定要用法力对卡力斯托进行惩罚，于是她把卡力斯托白暂的双臂变成了长满黑毛的利爪，娇红的双唇变成了血盆似的大口，让卡力斯托变成了一只大母熊。后来宙斯知道了，就把大熊提升到天上，成为大熊星座。</p>\n<span id=\"more\"></span>\n<p>  而小熊是大熊卡力斯托的儿子阿卡斯。卡力斯托被宙斯的妻子赫拉所害变成一只大熊后，在悲哀和痛苦中度过了15个年头，这时卡力斯托的儿子阿卡斯长大了，成为一名英俊出色的猎手。一天，阿卡斯在林中打猎，被他的母亲卡力斯托看见了，她忘记了自己已经是熊身，便伸开双臂准备拥抱亲爱的孩子。但阿卡斯不知道这只大熊是自己的母亲，他急忙向大熊举起手中的长枪准备射击。幸亏宙斯，也就是阿卡斯的父亲，在天上看见了，他担心阿卡斯会杀死母亲，便用法术把阿卡斯也变成了一只小熊，并将母子俩一起都提升到天上，成为大熊座和小熊座。</p>\n<p>  赫拉看到卡力斯托母子都被弄到天上，嫉妒之心油然而生。 她去请自己的哥哥海神波塞冬帮忙：永远不让卡力斯托母子从天上下海来休息喝水。于是，母子俩只得永远在北极上空转圈，不能下海。尽管如此，赫拉还不满足，她又选派一个猎人带着两只凶猛的猎犬，紧跟在大熊和小熊的后面。这个猎人就是天上的牧夫座，而他牵着的两只猎犬就是猎犬座，猎人和猎犬忠实执行神后赫拉交付的任务：紧紧看守着大熊和小熊，不停地追捕着。</p>\n\n        <h2 id=\"星空\"   >\n          <a href=\"#星空\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#星空\"></a> 星空</h2>\n      \n<p>  大熊座是北方天空中最明亮、最重要的星座之一,著名的北斗七星就在这个星座里。大熊座一年四季都能看到，春季黄昏后是观测它的最好时机。在星图上，大熊座的星星被想象为一只大熊，北斗七星的斗柄是大熊的长长的尾巴，斗勺的四颗星是大熊的身躯，另一些较暗的星构成了大熊的头和脚。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/1622203030.jpg\"  alt=\"\" />\n      </p>\n<p>  北斗七星从勺口到柄尾依次是天枢、天璇、天玑、天权、玉衡、开阳、摇光。前四颗组成了斗身，叫做魁；后三颗组成了斗柄，叫做杓。而开阳是一个奇特的目视双星系统，伴星叫做开阳增一（也称为辅）。后续的研究发现，开阳和辅实际上就是双星系统，开阳就被分为了开阳A（大熊座<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msup><mi>ζ</mi><mo mathvariant=\"normal\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\zeta&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.946332em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>）和开阳B（大熊座<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msup><mi>ζ</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\zeta&#x27;&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.946332em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>）。</p>\n<p>  1989年光谱观测首先发现开阳A是分光双星，后来又发现开阳B也是分光双星，可能是三合星，所以开阳实际上是一个四合星甚至五合星系统。1996年通过极高分辨率的望远镜拍摄出开阳A的两颗子星A1和A2。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/20210528194950.png\"  alt=\"\" />\n      <br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"http://inews.gtimg.com/newsapp_match/0/8453683962/0.jpg\"  alt=\"\" />\n      </p>\n<p>  小熊座的7颗星星也被称为小北斗，其中除<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span></span></span></span>、<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05278em;\">β</span></span></span></span>是较亮的2等星外，其他都是较暗的星。因此，小熊座不如北斗七星那样耀眼，在明月之夜或大城市里就不容易看到。小熊座<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span></span></span></span>（勾陈一）就是现在的北极星，处于北斗七星中天枢和天璇的延长线上。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/1622201708-1-.jpg\"  alt=\"\" />\n      </p>\n<p>  在大熊星座的东南方向，有两个紧挨着的“邻居”：东边的是牧夫座，西边的是猎犬座。猎犬座原先是大熊座的一部份，是北天星座中的小星座。猎犬座也是最暗的星座之一，其中只有一颗三等星。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/1622203502.jpg\"  alt=\"\" />\n      </p>\n<p>  牧夫座的大角星是全天第四亮星，之所以叫做大角是因为它被看作是四象之一的东方苍龙的一只角。此外牧夫座还包括了8颗4等以上和21颗5等以上的亮星，其中几颗中等亮度的星构成了一个五边形，像个大风筝，而最亮的大角星就像挂在风筝下面的一盏明灯。5月下旬，沿着北斗七星斗柄几颗的曲线顺势延伸出去，画出一条大弧线，就可以在天顶附近的星空找到大角星。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/1622203810.png\"  alt=\"\" />\n      </p>\n","categories":["天文"],"tags":["科普","观星","星座"]},{"title":"Termux | 安装云探针","url":"/posts/202105-termux-status.html","content":"\n    <div class=\"note-plugin info\">\n      <span class=\"note-plugin__icon note-plugin__icon--info\">\n              <i class=\"fas fa-info-circle\"></i>\n            </span>\n      <p>有关Termux的详细教程，请查看<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.sqlsec.com/2018/05/termux.html\" >Termux 高级终端安装使用配置教程-国光</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span><br />以下内容可适用于其他Linux发行版</p>\n    </div>\n  \n\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  ServerStatus可以实时监控服务器的网络、负载、内存占用等信息，也被称为云探针、多服务器探针、云监控、多服务器云监控，本人追溯到最早源自于<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/BotoX\" >BotoX</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>的<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/BotoX/ServerStatus\" >项目</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>。</p>\n<blockquote>\n<p>Display and monitor your servers statistics in a beatiful way</p>\n</blockquote>\n<span id=\"more\"></span>\n<p>  后人经过多位大佬的修改、汉化和美化，已经有多个版本的ServerStatus可供部署，本文采用的是由<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/CokeMine\" >CokeMine</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>开发的<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/CokeMine/ServerStatus-Hotaru\" >ServerStatus-Hotaru</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>版本。</p>\n\n        <h2 id=\"安装\"   >\n          <a href=\"#安装\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装\"></a> 安装</h2>\n      \n\n        <h3 id=\"服务端\"   >\n          <a href=\"#服务端\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#服务端\"></a> 服务端</h3>\n      \n<ol>\n<li>获取文件</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">wget https://raw.githubusercontent.com/CokeMine/ServerStatus-Hotaru/master/status.sh</span><br><span class=\"line\">chmod +x status.sh</span><br></pre></td></tr></table></div></figure>\n<ol start=\"2\">\n<li>安装服务端<br />\n运行<code>./status.sh s</code>，配置按推荐即可，如果服务器上有Nginx/Apache，则不需要安装Caddy，否则建议选择Y一键配置HTTP服务<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/20210528173613.png\"  alt=\"\" />\n      </li>\n<li>添加客户端信息：打开<code>/usr/local/ServerStatus/server/config.json</code>，修改如下:</li>\n</ol>\n<figure class=\"highlight json\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"attr\">&quot;servers&quot;</span>:</span><br><span class=\"line\"> [</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">   <span class=\"attr\">&quot;username&quot;</span>: <span class=\"string\">&quot;A&quot;</span>,</span><br><span class=\"line\">   <span class=\"attr\">&quot;password&quot;</span>: <span class=\"string\">&quot;A&quot;</span>,</span><br><span class=\"line\">   <span class=\"attr\">&quot;name&quot;</span>: <span class=\"string\">&quot;Fox Home&quot;</span>,</span><br><span class=\"line\">   <span class=\"attr\">&quot;type&quot;</span>: <span class=\"string\">&quot;KVM&quot;</span>,  <span class=\"comment\">// 现在一般云服务器都是KVM</span></span><br><span class=\"line\">   <span class=\"attr\">&quot;host&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">   <span class=\"attr\">&quot;location&quot;</span>: <span class=\"string\">&quot;杭州&quot;</span>,</span><br><span class=\"line\">   <span class=\"attr\">&quot;disabled&quot;</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">   <span class=\"attr\">&quot;region&quot;</span>: <span class=\"string\">&quot;CN&quot;</span>   <span class=\"comment\">// region信息在文件/usr/local/ServerStatus/region.json中</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">&quot;username&quot;</span>: <span class=\"string\">&quot;B&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;password&quot;</span>: <span class=\"string\">&quot;B&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;name&quot;</span>: <span class=\"string\">&quot;Fox Lab&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;type&quot;</span>: <span class=\"string\">&quot;KVM&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;host&quot;</span>: <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;location&quot;</span>: <span class=\"string\">&quot;香港&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;disabled&quot;</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">    <span class=\"attr\">&quot;region&quot;</span>: <span class=\"string\">&quot;HK&quot;</span></span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"> ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<ol start=\"4\">\n<li>启动服务端</li>\n</ol>\n\n        <h3 id=\"客户端\"   >\n          <a href=\"#客户端\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#客户端\"></a> 客户端</h3>\n      \n<p>  运行<code>./status.sh c</code>安装客户端，配置信息按照前文服务端配置（<code>username</code>和<code>password</code>）填写即可</p>\n\n        <h2 id=\"其他\"   >\n          <a href=\"#其他\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#其他\"></a> 其他</h2>\n      \n\n        <h3 id=\"termux适配\"   >\n          <a href=\"#termux适配\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#termux适配\"></a> Termux适配</h3>\n      \n\n    <div class=\"note-plugin warning\">\n      <span class=\"note-plugin__icon note-plugin__icon--warning\">\n              <i class=\"fas fa-exclamation-circle\"></i>\n            </span>\n      <p>Termux端不建议按照服务端</p>\n    </div>\n  \n<p>  从仓库中下载<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://raw.githubusercontent.com/CokeMine/ServerStatus-Hotaru/master/clients/status-client.py\" >status-client.py</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，对一下内容进行修改：</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_hdd</span>():</span></span><br><span class=\"line\">    p = subprocess.check_output([<span class=\"string\">&#x27;df&#x27;</span>]).decode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">    <span class=\"comment\"># 在终端中运行df命令，查看/data对应的那一行的行号就是X+1</span></span><br><span class=\"line\">    total = p.splitlines()[X]</span><br><span class=\"line\">    used = <span class=\"built_in\">int</span>(total.split()[<span class=\"number\">2</span>])/<span class=\"number\">1024</span></span><br><span class=\"line\">    size = <span class=\"built_in\">int</span>(total.split()[<span class=\"number\">1</span>])/<span class=\"number\">1024</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">int</span>(size), <span class=\"built_in\">int</span>(used)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_load</span>():</span></span><br><span class=\"line\">    p = subprocess.check_output([<span class=\"string\">&#x27;uptime&#x27;</span>]).decode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">round</span>(<span class=\"built_in\">float</span>(p.split(<span class=\"string\">&#x27;, &#x27;</span>)[<span class=\"number\">3</span>].split(<span class=\"string\">&#x27;: &#x27;</span>)[<span class=\"number\">1</span>]), <span class=\"number\">2</span>)*<span class=\"number\">100</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"修改前端主题\"   >\n          <a href=\"#修改前端主题\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#修改前端主题\"></a> 修改前端/主题</h3>\n      \n<p>  由于前端文件已经被打包过了，所以不建议直接修改格式化打包后的js/css文件，建议自行下载修改再打包，复制dist目录到服务器。</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/CokeMine/Hotaru_theme.git</span><br><span class=\"line\"><span class=\"built_in\">cd</span> ./Hotaru_theme &amp;&amp; npm install</span><br><span class=\"line\"><span class=\"comment\"># 修改完成之后</span></span><br><span class=\"line\">npm run build</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"windows适配\"   >\n          <a href=\"#windows适配\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#windows适配\"></a> Windows适配</h3>\n      \n<p>  使用<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://raw.githubusercontent.com/CokeMine/ServerStatus-Hotaru/master/clients/status-psutil.py\" >Psutil版</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>即可使ServerStatus客户端在Windows等平台运行</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">pip install psutil</span><br><span class=\"line\"><span class=\"comment\"># 修改status-psutil.py</span></span><br><span class=\"line\">python status-psutil.py</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ol>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/CokeMine/ServerStatus-Hotaru\" >ServerStatus-Hotaru</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.cokemine.com/serverstatus-hotaru.html\" >ServerStatus-Hotaru云探针的安装与配置</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/CokeMine/ServerStatus-Hotaru/issues/75\" >想改网页内的几个字 如何操作</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ol>\n","categories":["Termux"],"tags":["安装","Python","ServerStatus"]},{"title":"博客成长日志 | 准实时访问统计","url":"/posts/202105-visit.html","content":"\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  通过百度统计、CNZZ等服务，我们可以记录站点的访问地图、访问量和来源，如果想要展示数据，可以选择直接导向服务商提供的公开页面，但是样式丑陋，所以本文通过百度统计API，使用Echarts制作站点访问准实时统计页面，效果可以参考<a href=\"/s/statistics/\">统计</a>。</p>\n<span id=\"more\"></span>\n<p>  之所以说是准实时统计，是因为为了解决跨域问题（CROS error），本文采用的方法是定时通过百度统计API将数据下载保存为json文件，放置在网站目录下（后续可能会发展为vercel api，挖坑）。不过作为个人博客，方式访问量不会很大，没有必要实时更新，目前本站设置是每隔6小时更新一次。</p>\n\n        <h2 id=\"数据获取\"   >\n          <a href=\"#数据获取\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#数据获取\"></a> 数据获取</h2>\n      \n\n        <h3 id=\"百度统计\"   >\n          <a href=\"#百度统计\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#百度统计\"></a> 百度统计</h3>\n      \n<p>  在设置样式之前首先需要获取统计数据，使用百度账号登陆<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://tongji.baidu.com/web/welcome/login\" >百度统计</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，根据<a href=\"#refer-4\">参考资料4</a>进行操作，获取token与site_id，具体教程可以查看<a href=\"#refer-1\">参考资料1</a>。</p>\n\n        <h3 id=\"下载文件\"   >\n          <a href=\"#下载文件\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#下载文件\"></a> 下载文件</h3>\n      \n<p>  通过6个链接，我们可以获取：一年内每日访问统计、访问地图数据、月度访问统计、来源分类统计、搜索引擎访问统计和外部链接访问统计；通过python或者nodejs都可以很方便的下载文件保存，以下为python的示例：</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> time, datetime</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 开始统计的日期</span></span><br><span class=\"line\">start_date   = <span class=\"string\">&#x27;20201218&#x27;</span></span><br><span class=\"line\">date         = datetime.datetime.now()</span><br><span class=\"line\"><span class=\"comment\"># 结束统计的日期</span></span><br><span class=\"line\">end_date     = <span class=\"built_in\">str</span>(date.year) + (<span class=\"built_in\">str</span>(date.month) <span class=\"keyword\">if</span> date.month &gt; <span class=\"number\">9</span> <span class=\"keyword\">else</span> (<span class=\"string\">&#x27;0&#x27;</span> + <span class=\"built_in\">str</span>(date.month))) + (<span class=\"built_in\">str</span>(date.day) <span class=\"keyword\">if</span> date.day &gt; <span class=\"number\">9</span> <span class=\"keyword\">else</span> (<span class=\"string\">&#x27;0&#x27;</span> + <span class=\"built_in\">str</span>(date.day)))</span><br><span class=\"line\"><span class=\"comment\"># token和siteid</span></span><br><span class=\"line\">access_token = <span class=\"string\">&#x27;121.6e...&#x27;</span></span><br><span class=\"line\">site_id      = <span class=\"string\">&#x27;16******&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># 百度统计API</span></span><br><span class=\"line\">dataUrl      = <span class=\"string\">&#x27;https://openapi.baidu.com/rest/2.0/tongji/report/getData?access_token=&#x27;</span> + access_token + <span class=\"string\">&#x27;&amp;site_id=&#x27;</span> + site_id</span><br><span class=\"line\"><span class=\"comment\"># 统计访问次数 PV 填写 &#x27;pv_count&#x27;，统计访客数 UV 填写 &#x27;visitor_count&#x27;，二选一</span></span><br><span class=\"line\">metrics      = <span class=\"string\">&#x27;pv_count&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">downFile</span>(<span class=\"params\">url, fileName, prefix=<span class=\"string\">&#x27;/home/API/data/&#x27;</span></span>):</span></span><br><span class=\"line\">    print(<span class=\"string\">&#x27;downloading :&#x27;</span>, url)</span><br><span class=\"line\">    down_res = requests.get(url)</span><br><span class=\"line\">    <span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(prefix+fileName, <span class=\"string\">&#x27;wb&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">        f.write(down_res.content)</span><br><span class=\"line\">    print(<span class=\"string\">&#x27;writing :&#x27;</span>, prefix+fileName)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 访客地图</span></span><br><span class=\"line\">downFile(dataUrl + <span class=\"string\">&#x27;&amp;start_date=&#x27;</span> + start_date + <span class=\"string\">&#x27;&amp;end_date=&#x27;</span> + end_date + <span class=\"string\">&#x27;&amp;metrics=&#x27;</span> + metrics + <span class=\"string\">&#x27;&amp;method=visit/district/a&#x27;</span>, </span><br><span class=\"line\">    <span class=\"string\">&#x27;map.json&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 访问趋势</span></span><br><span class=\"line\">downFile(dataUrl + <span class=\"string\">&#x27;&amp;start_date=&#x27;</span> + start_date + <span class=\"string\">&#x27;&amp;end_date=&#x27;</span> + end_date + <span class=\"string\">&#x27;&amp;metrics=&#x27;</span> + metrics + <span class=\"string\">&#x27;&amp;method=trend/time/a&amp;gran=month&#x27;</span>, </span><br><span class=\"line\">    <span class=\"string\">&#x27;trends.json&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 访问来源</span></span><br><span class=\"line\">downFile(dataUrl + <span class=\"string\">&#x27;&amp;start_date=&#x27;</span> + start_date + <span class=\"string\">&#x27;&amp;end_date=&#x27;</span> + end_date + <span class=\"string\">&#x27;&amp;metrics=&#x27;</span> + metrics + <span class=\"string\">&#x27;&amp;method=source/all/a&#x27;</span>, </span><br><span class=\"line\">    <span class=\"string\">&#x27;sources.json&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 搜索引擎</span></span><br><span class=\"line\">downFile(dataUrl + <span class=\"string\">&#x27;&amp;start_date=&#x27;</span> + start_date + <span class=\"string\">&#x27;&amp;end_date=&#x27;</span> + end_date + <span class=\"string\">&#x27;&amp;metrics=&#x27;</span> + metrics + <span class=\"string\">&#x27;&amp;method=source/engine/a&#x27;</span>, </span><br><span class=\"line\">    <span class=\"string\">&#x27;engine.json&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 外部链接</span></span><br><span class=\"line\">downFile(dataUrl + <span class=\"string\">&#x27;&amp;start_date=&#x27;</span> + start_date + <span class=\"string\">&#x27;&amp;end_date=&#x27;</span> + end_date + <span class=\"string\">&#x27;&amp;metrics=&#x27;</span> + metrics + <span class=\"string\">&#x27;&amp;method=source/link/a&#x27;</span>, </span><br><span class=\"line\">    <span class=\"string\">&#x27;link.json&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 访问日历</span></span><br><span class=\"line\"><span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">访问日历需要获取一年内的数据，按照一年365天计算，大概为52周多一点，所以前面有完整的52排，获取方式只要通过开始日期年份-1即可</span></span><br><span class=\"line\"><span class=\"string\">然后就是第53排的处理，python中的date.weekday()获取的星期几是0对应周一，所以通过(date.weekday()+1)%7即可转换到0对应周日</span></span><br><span class=\"line\"><span class=\"string\">于是在52周的基础上，减去星期数，就可以得到新的start_date</span></span><br><span class=\"line\"><span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\">date       = datetime.datetime(date.year-<span class=\"number\">1</span>, date.month, date.day)</span><br><span class=\"line\">date       = datetime.datetime.fromtimestamp(date.timestamp()-<span class=\"number\">3600</span>*<span class=\"number\">24</span>*((date.weekday()+<span class=\"number\">1</span>)%<span class=\"number\">7</span>))</span><br><span class=\"line\">start_date = <span class=\"built_in\">str</span>(date.year) + (<span class=\"built_in\">str</span>(date.month) <span class=\"keyword\">if</span> date.month &gt; <span class=\"number\">9</span> <span class=\"keyword\">else</span> (<span class=\"string\">&#x27;0&#x27;</span> + <span class=\"built_in\">str</span>(date.month))) + (<span class=\"built_in\">str</span>(date.day) <span class=\"keyword\">if</span> date.day &gt; <span class=\"number\">9</span> <span class=\"keyword\">else</span> (<span class=\"string\">&#x27;0&#x27;</span> + <span class=\"built_in\">str</span>(date.day)))</span><br><span class=\"line\">downFile(dataUrl + <span class=\"string\">&#x27;&amp;method=overview/getTimeTrendRpt&#x27;</span> + <span class=\"string\">&#x27;&amp;metrics=&#x27;</span> + metrics + <span class=\"string\">&#x27;&amp;start_date=&#x27;</span> + start_date + <span class=\"string\">&#x27;&amp;end_date=&#x27;</span> + end_date,</span><br><span class=\"line\">    <span class=\"string\">&#x27;calendar.json&#x27;</span>)</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"自动更新\"   >\n          <a href=\"#自动更新\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#自动更新\"></a> 自动更新</h3>\n      \n<p>  在Linux中可以通过<code>crontab</code>设置定时任务，以下为每整6小时的0点执行一次任务：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">0 0 * * * /usr/bin/python /home/API/data/get.py &gt;&gt; /home/API/data/get.log</span><br><span class=\"line\">0 6 * * * /usr/bin/python /home/API/data/get.py &gt;&gt; /home/API/data/get.log</span><br><span class=\"line\">0 12 * * * /usr/bin/python /home/API/data/get.py &gt;&gt; /home/API/data/get.log</span><br><span class=\"line\">0 18 * * * /usr/bin/python /home/API/data/get.py &gt;&gt; /home/API/data/get.log</span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">0 0,6,12,18 * * * /usr/bin/python /home/API/data/get.py &gt;&gt; /home/API/data/get.log</span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">0 */6 * * * /usr/bin/python /home/API/data/get.py &gt;&gt; /home/API/data/get.log</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"数据展示\"   >\n          <a href=\"#数据展示\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#数据展示\"></a> 数据展示</h2>\n      \n\n        <h3 id=\"统计图容器\"   >\n          <a href=\"#统计图容器\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#统计图容器\"></a> 统计图容器</h3>\n      \n<p>  在html代码中插入：</p>\n<figure class=\"highlight html\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/npm/echarts@4.7.0/dist/echarts.min.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/npm/echarts@4.7.0/map/js/china.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;max-width: 90%;margin: 0 auto;&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;calendar_container&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;data-container&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;map_container&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;data-container&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;height: 500px;&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;trends_container&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;data-container&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;height: 350px;&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;sources_container&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;data-container&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;height: 450px;&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;/js/calendar.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;/js/census.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"访问日历\"   >\n          <a href=\"#访问日历\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#访问日历\"></a> 访问日历</h3>\n      \n<p>  访问日历类似于Github贡献日历，有两种方法实现。</p>\n<ol>\n<li>源自于<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://zfe.space/post/hexo-githubcalendar.html\" >hexo-githubcalendar 插件</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，由<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.eurkon.com/\" >Eurkon</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>修改，原文见<a href=\"#refer-3\">参考资料3</a>。点击<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/YiHui-Liu/Fox-Home-CDN/blob/5eadc9f050b9d759dc14786085253b000049b7de/calendar.js\" >链接</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>下载<code>calendar.js</code>文件，需要修改的地方有：</li>\n</ol>\n<figure class=\"highlight javascript\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\"><span class=\"comment\">// 下面的链接是本站点的访问数据，需要修改为自己的，为了防止浏览器缓存的干扰，在url后添加了时间戳，可以进一步优化为时间的小时数对6取模</span></span><br><span class=\"line\">fetch(<span class=\"string\">&#x27;https://api.foolishfox.cn/data/calendar.json?date&#x27;</span>+<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> data.json()).then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"comment\">// 统计访问次数 PV 填写 &#x27;pv_count&#x27;，统计访客数 UV 填写 &#x27;visitor_count&#x27;，二选一</span></span><br><span class=\"line\">visit_calendar(<span class=\"string\">&#x27;pv_count&#x27;</span>, visit_color);</span><br><span class=\"line\">...</span><br></pre></td></tr></table></div></figure>\n<p>  另外，需要更改容器id可以直接搜索替换即可。</p>\n<ol start=\"2\">\n<li>通过<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://cdn.jsdelivr.net/gh/YiHui-Liu/Fox-Home-CDN/census.js\" >census.js</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>进行设置，包括后续的访问地图、访问趋势（访问次数）和访问来源都是基于此文件通过Echarts实现的。</li>\n</ol>\n<figure class=\"highlight javascript\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 统计访问次数 PV 填写 &#x27;pv_count&#x27;，统计访客数 UV 填写 &#x27;visitor_count&#x27;，二选一</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> metrics     = <span class=\"string\">&#x27;pv_count&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> metricsName = (metrics === <span class=\"string\">&#x27;pv_count&#x27;</span> ? <span class=\"string\">&#x27;访问次数&#x27;</span> : (metrics === <span class=\"string\">&#x27;visitor_count&#x27;</span> ? <span class=\"string\">&#x27;访客数&#x27;</span> : <span class=\"string\">&#x27;&#x27;</span>))</span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">calChart</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> script = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;script&quot;</span>)</span><br><span class=\"line\">    <span class=\"comment\">// 下面的链接是本站点的访问数据，需要修改为自己的，为了防止浏览器缓存的干扰，在url后添加了时间戳，可以进一步优化为时间的小时数对6取模</span></span><br><span class=\"line\">    fetch(<span class=\"string\">&#x27;https://api.foolishfox.cn/data/calendar.json?date&#x27;</span>+<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> data.json()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br><span class=\"line\">        ...</span><br><span class=\"line\">        <span class=\"comment\">// 颜色盒，用于设置不同数据的展示颜色，可更改</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> colorBox = [<span class=\"string\">&#x27;#EBEDF0&#x27;</span>, <span class=\"string\">&#x27;#FFE9BB&#x27;</span>, <span class=\"string\">&#x27;#FFD1A7&#x27;</span>, <span class=\"string\">&#x27;#FFBB95&#x27;</span>, <span class=\"string\">&#x27;#FFA383&#x27;</span>, <span class=\"string\">&#x27;#FF8D70&#x27;</span>, <span class=\"string\">&#x27;#FF745C&#x27;</span>, <span class=\"string\">&#x27;#FF5C4A&#x27;</span>, <span class=\"string\">&#x27;#FF4638&#x27;</span>, <span class=\"string\">&#x27;#FF2E26&#x27;</span>, <span class=\"string\">&#x27;#FF1812&#x27;</span>];</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"访问地图\"   >\n          <a href=\"#访问地图\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#访问地图\"></a> 访问地图</h3>\n      \n<p>  最简单的就是访问地图，直接修改json文件的请求url即可：</p>\n<figure class=\"highlight javascript\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 访问地图</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">mapChart</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> script = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;script&quot;</span>)</span><br><span class=\"line\">    <span class=\"comment\">// 下面的链接是本站点的访问数据，需要修改为自己的，为了防止浏览器缓存的干扰，在url后添加了时间戳，可以进一步优化为时间的小时数对6取模</span></span><br><span class=\"line\">    fetch(<span class=\"string\">&#x27;https://api.foolishfox.cn/data/map.json?date&#x27;</span>+<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> data.json()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"访问趋势\"   >\n          <a href=\"#访问趋势\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#访问趋势\"></a> 访问趋势</h3>\n      \n<p>  访问趋势中按照年份，将12个月的数据展开，需要从json中获取到年份和月份信息，由于时间日期格式是固定的，所以可以直接截取。本部分代码以下列展示的为准：</p>\n<figure class=\"highlight javascript\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 获取年份和月份</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">get_year</span>(<span class=\"params\">s</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">parseInt</span>(s.substr(<span class=\"number\">0</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">get_month</span>(<span class=\"params\">s</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">parseInt</span>(s.substr(<span class=\"number\">5</span>, <span class=\"number\">2</span>))</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 访问趋势</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">trendsChart</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> script = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">&quot;script&quot;</span>)</span><br><span class=\"line\">    <span class=\"comment\">// 下面的链接是本站点的访问数据，需要修改为自己的，为了防止浏览器缓存的干扰，在url后添加了时间戳，可以进一步优化为时间的小时数对6取模</span></span><br><span class=\"line\">    fetch(<span class=\"string\">&#x27;https://api.foolishfox.cn/data/trends.json?date&#x27;</span>+<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> data.json()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> date = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span><br><span class=\"line\">        <span class=\"keyword\">let</span> monthValueArr = &#123;&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> monthName = data.result.items[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"keyword\">let</span> monthValue = data.result.items[<span class=\"number\">1</span>];</span><br><span class=\"line\">        <span class=\"comment\">// 2020是起始年份，改为你自己的</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i =<span class=\"number\">2020</span>; i &lt;= date.getFullYear(); i++)   monthValueArr[<span class=\"built_in\">String</span>(i)] = [ ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ,  ];</span><br><span class=\"line\">        monthValueArr</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; monthName.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> year = get_year(monthName[i][<span class=\"number\">0</span>]);</span><br><span class=\"line\">            <span class=\"keyword\">let</span> month = get_month(monthName[i][<span class=\"number\">0</span>]);</span><br><span class=\"line\">            monthValueArr[<span class=\"built_in\">String</span>(year)][<span class=\"built_in\">String</span>(month-<span class=\"number\">1</span>)] = monthValue[i][<span class=\"number\">0</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 以后每过一年，需要手动添加以下legend和series</span></span><br><span class=\"line\">        script.innerHTML = <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">        var trendsChart = echarts.init(document.getElementById(&#x27;trends_container&#x27;), &#x27;light&#x27;);</span></span><br><span class=\"line\"><span class=\"string\">        var trendsOption = &#123;</span></span><br><span class=\"line\"><span class=\"string\">            title: &#123; text: &#x27;访问趋势&#x27;, x: &#x27;center&#x27; &#125;,</span></span><br><span class=\"line\"><span class=\"string\">            tooltip: &#123; trigger: &#x27;axis&#x27; &#125;,</span></span><br><span class=\"line\"><span class=\"string\">            legend: &#123; data: [&#x27;2020&#x27;, &#x27;2021&#x27;], x: &#x27;right&#x27; &#125;,</span></span><br><span class=\"line\"><span class=\"string\">            xAxis: &#123;</span></span><br><span class=\"line\"><span class=\"string\">                name: &#x27;日期&#x27;, type: &#x27;category&#x27;, boundaryGap: false,</span></span><br><span class=\"line\"><span class=\"string\">                data: [&#x27;一月&#x27;, &#x27;二月&#x27;, &#x27;三月&#x27;, &#x27;四月&#x27;, &#x27;五月&#x27;, &#x27;六月&#x27;, &#x27;七月&#x27;, &#x27;八月&#x27;, &#x27;九月&#x27;, &#x27;十月&#x27;, &#x27;十一月&#x27;, &#x27;十二月&#x27;]</span></span><br><span class=\"line\"><span class=\"string\">            &#125;,</span></span><br><span class=\"line\"><span class=\"string\">            yAxis: &#123; name: &#x27;<span class=\"subst\">$&#123;metricsName&#125;</span>&#x27;, type: &#x27;value&#x27; &#125;,</span></span><br><span class=\"line\"><span class=\"string\">            series: [</span></span><br><span class=\"line\"><span class=\"string\">                &#123;</span></span><br><span class=\"line\"><span class=\"string\">                    name: &#x27;2020&#x27;, type: &#x27;line&#x27;, smooth: true,</span></span><br><span class=\"line\"><span class=\"string\">                    data: [<span class=\"subst\">$&#123;monthValueArr[<span class=\"string\">&quot;2020&quot;</span>]&#125;</span>],</span></span><br><span class=\"line\"><span class=\"string\">                    markLine: &#123; data: [&#123;type: &#x27;average&#x27;, name: &#x27;平均值&#x27;&#125;] &#125;</span></span><br><span class=\"line\"><span class=\"string\">                &#125;,</span></span><br><span class=\"line\"><span class=\"string\">                &#123;</span></span><br><span class=\"line\"><span class=\"string\">                    name: &#x27;2021&#x27;, type: &#x27;line&#x27;, smooth: true,</span></span><br><span class=\"line\"><span class=\"string\">                    data: [<span class=\"subst\">$&#123;monthValueArr[<span class=\"string\">&quot;2021&quot;</span>]&#125;</span>],</span></span><br><span class=\"line\"><span class=\"string\">                    markLine: &#123; data: [&#123;type: &#x27;average&#x27;, name: &#x27;平均值&#x27;&#125;] &#125;</span></span><br><span class=\"line\"><span class=\"string\">                &#125;</span></span><br><span class=\"line\"><span class=\"string\">            ]</span></span><br><span class=\"line\"><span class=\"string\">        &#125;;</span></span><br><span class=\"line\"><span class=\"string\">        trendsChart.setOption(trendsOption);</span></span><br><span class=\"line\"><span class=\"string\">        window.addEventListener(&quot;resize&quot;, () =&gt; &#123; </span></span><br><span class=\"line\"><span class=\"string\">            trendsChart.resize();</span></span><br><span class=\"line\"><span class=\"string\">        &#125;);`</span></span><br><span class=\"line\">        <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">&#x27;trends_container&#x27;</span>).after(script);</span><br><span class=\"line\">    &#125;).catch(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(error);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"访问来源\"   >\n          <a href=\"#访问来源\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#访问来源\"></a> 访问来源</h3>\n      \n<p>  留在最后的是最复杂的访问来源，实际上百度的全部来源(<code>source/all/a</code>)API可以将来源分为：直达、外部链接和搜索引擎三个部分，直接使用并不困难。但是百度统计会将必应（<code>cn.bing.com</code>和<code>www.bing.com</code>）的来源归类到外部链接而不是搜索引擎，而且我自己还想统计来自于Github、十年之约等网站的流量，所以需要获取多个数据文件。</p>\n<figure class=\"highlight javascript\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\"><span class=\"comment\">// 下面的链接是本站点的访问数据，需要修改为自己的，为了防止浏览器缓存的干扰，在url后添加了时间戳，可以进一步优化为时间的小时数对6取模</span></span><br><span class=\"line\">fetch(<span class=\"string\">&#x27;https://api.foolishfox.cn/data/sources.json?date&#x27;</span>+<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> data.json()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> sourcesName = data.result.items[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> sourcesValue = data.result.items[<span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> sourcesArr = [];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; sourcesName.length; i++)</span><br><span class=\"line\">        sourcesArr.push(&#123; <span class=\"attr\">name</span>: sourcesName[i][<span class=\"number\">0</span>].name, <span class=\"attr\">value</span>: sourcesValue[i][<span class=\"number\">0</span>] &#125;);</span><br><span class=\"line\">    <span class=\"comment\">// 记录总体数据，方便后续调用（使用var定义在fetch外面）</span></span><br><span class=\"line\">    link = sourcesArr[<span class=\"number\">1</span>][<span class=\"string\">&#x27;value&#x27;</span>] ;</span><br><span class=\"line\">    search = sourcesArr[<span class=\"number\">2</span>][<span class=\"string\">&#x27;value&#x27;</span>];</span><br><span class=\"line\">    direct = sourcesArr[<span class=\"number\">0</span>][<span class=\"string\">&#x27;value&#x27;</span>];</span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"comment\">// 下面的链接是本站点的访问数据，需要修改为自己的，为了防止浏览器缓存的干扰，在url后添加了时间戳，可以进一步优化为时间的小时数对6取模</span></span><br><span class=\"line\">fetch(<span class=\"string\">&#x27;https://api.foolishfox.cn/data/link.json?date&#x27;</span>+<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> data.json()).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> linksName = data.result.items[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> linksValue = data.result.items[<span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> linksArr = &#123;&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; linksName.length; i++)</span><br><span class=\"line\">        linksArr[linksName[i][<span class=\"number\">0</span>].name] = linksValue[i][<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"comment\">// 除必应外，其他的都是自己想要统计的网站，都是http链接</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> sum = data.result.sum[<span class=\"number\">0</span>][<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> bing = linksArr[<span class=\"string\">&#x27;http://cn.bing.com&#x27;</span>]+linksArr[<span class=\"string\">&#x27;http://www.bing.com&#x27;</span>];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> github = linksArr[<span class=\"string\">&#x27;http://github.com&#x27;</span>];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> travel = linksArr[<span class=\"string\">&#x27;http://travellings.now.sh&#x27;</span>]+linksArr[<span class=\"string\">&#x27;http://travellings.vercel.app&#x27;</span>]+linksArr[<span class=\"string\">&#x27;http://www.foreverblog.cn&#x27;</span>];</span><br><span class=\"line\">    innerHTML += <span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">                    &#123;value: <span class=\"subst\">$&#123;bing&#125;</span>, name: &#x27;必应&#x27;&#125;,</span></span><br><span class=\"line\"><span class=\"string\">                    &#123;value: <span class=\"subst\">$&#123;direct&#125;</span>, name: &#x27;直达&#x27;&#125;,</span></span><br><span class=\"line\"><span class=\"string\">                    &#123;value: <span class=\"subst\">$&#123;github&#125;</span>, name: &#x27;Github&#x27;&#125;,</span></span><br><span class=\"line\"><span class=\"string\">                    &#123;value: <span class=\"subst\">$&#123;travel&#125;</span>, name: &#x27;开往/十年之约&#x27;&#125;,`</span>+</span><br><span class=\"line\">                    <span class=\"comment\">// 将来自于必应的访问减去</span></span><br><span class=\"line\">                    <span class=\"string\">`&#123;value: <span class=\"subst\">$&#123;sum-bing-github-travel+<span class=\"number\">65</span>&#125;</span>, name: &#x27;其他&#x27;&#125;</span></span><br><span class=\"line\"><span class=\"string\">                ]</span></span><br><span class=\"line\"><span class=\"string\">            &#125;,</span></span><br><span class=\"line\"><span class=\"string\">            &#123;</span></span><br><span class=\"line\"><span class=\"string\">                name: &#x27;访问来源&#x27;, type: &#x27;pie&#x27;, selectedMode: &#x27;single&#x27;, radius: [0, &#x27;30%&#x27;],</span></span><br><span class=\"line\"><span class=\"string\">                label: &#123; position: &#x27;inner&#x27;, fontSize: 14&#125;,</span></span><br><span class=\"line\"><span class=\"string\">                labelLine: &#123; show: false &#125;,</span></span><br><span class=\"line\"><span class=\"string\">                data: [`</span>+</span><br><span class=\"line\">                    <span class=\"comment\">// 将来自于必应的访问从外链中减去，加入搜索中</span></span><br><span class=\"line\">                    <span class=\"string\">`&#123;value: <span class=\"subst\">$&#123;search+bing&#125;</span>, name: &#x27;搜索&#x27;, itemStyle: &#123; color : &#x27;green&#x27; &#125;&#125;,</span></span><br><span class=\"line\"><span class=\"string\">                    &#123;value: <span class=\"subst\">$&#123;direct&#125;</span>, name: &#x27;直达&#x27;, itemStyle: &#123; color : &#x27;#FFDB5C&#x27; &#125;&#125;,</span></span><br><span class=\"line\"><span class=\"string\">                    &#123;value: <span class=\"subst\">$&#123;link-bing&#125;</span>, name: &#x27;外链&#x27;, itemStyle: &#123; color : &#x27;#32C5E9&#x27; &#125;&#125;</span></span><br><span class=\"line\"><span class=\"string\">                ]</span></span><br><span class=\"line\"><span class=\"string\">            &#125;,</span></span><br><span class=\"line\"><span class=\"string\">        ]</span></span><br><span class=\"line\"><span class=\"string\">    &#125;;</span></span><br><span class=\"line\"><span class=\"string\">...</span></span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"qa\"   >\n          <a href=\"#qa\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#qa\"></a> Q&amp;A</h2>\n      \n<ol>\n<li>\n<p>不想使用python下载文件保存，想要实时统计<br />\n根据<a href=\"#refer-2\">参考资料2</a>中4.3节——自建 Vercel API（可选）进行设置，替换上述文件中的url即可</p>\n</li>\n<li>\n<p>依然出现跨域问题？<br />\n请务必保证通过2.2节获取的文件保存在博客的网站目录下，并通过url可以访问；如果想要向我一样通过其他域名（例如<code>api.foolishfox.cn/data/*.json</code>）访问，需要对服务器进行设置，以Nginx为例：</p>\n</li>\n</ol>\n<figure class=\"highlight nginx\"><figcaption><span>configuration</span></figcaption><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#data CROS</span></span><br><span class=\"line\"><span class=\"attribute\">location</span> <span class=\"regexp\">~ ^/data/</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">if</span> ($http_origin <span class=\"regexp\">~* (http://localhost:4000|https://foolishfox.cn))</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">add_header</span> <span class=\"string\">&#x27;Access-Control-Allow-Origin&#x27;</span> <span class=\"string\">&quot;$http_origin&quot;</span>;</span><br><span class=\"line\">        <span class=\"attribute\">add_header</span> <span class=\"string\">&#x27;Access-Control-Allow-Credentials&#x27;</span> <span class=\"string\">&#x27;true&#x27;</span>;</span><br><span class=\"line\">        <span class=\"attribute\">add_header</span> <span class=\"string\">&#x27;Access-Control-Allow-Methods&#x27;</span> <span class=\"string\">&#x27;GET, POST, OPTIONS&#x27;</span>;</span><br><span class=\"line\">        <span class=\"attribute\">add_header</span> <span class=\"string\">&#x27;Access-Control-Allow-Headers&#x27;</span> <span class=\"string\">&#x27;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<ol start=\"3\">\n<li>\n<p>地图显示错误<br />\n务必注意，Echarts目前已经不提供地图js/json文件的下载，所以要通过npm获取到旧版本中的<code>China.js</code>文件，因此Echarts的版本最好也保持一致</p>\n</li>\n<li>\n<p>Echarts绘制的访问日历无法自动适应窗口大小<br />\n正在积极解决中…</p>\n</li>\n</ol>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<p><span id=\"refer-1\">1. <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.eurkon.com/post/ef1da941.html\" >Hexo 博客访问统计图</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></span><br />\n<span id=\"refer-2\">2. <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.eurkon.com/post/61763977.html\" >Hexo 博客实时访问统计图</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></span><br />\n<span id=\"refer-3\">3. <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.eurkon.com/post/1a169b5a.html\" >Hexo 博客访问日历图</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></span><br />\n<span id=\"refer-4\">4. <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://tongji.baidu.com/api/manual/\" >百度统计用户手册</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></span><br />\n<span id=\"refer-5\">5. <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://echarts.apache.org/examples/zh/index.html\" >Echarts文档</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></span></p>\n","categories":["博客成长日志"],"tags":["Hexo","Echarts","百度统计"]},{"title":"Yourls : 短链接生成器与短域名获取","url":"/posts/202105-yourls.html","content":"\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  你是否遇到过这样的场景？你有一个链接，例如<code>https://arxiv.org/abs/2104.14228</code>，需要分享给朋友，这个链接长而且不好记忆，需要经常用到的时候也不方便，假设你需要发微博，由于字数限制，链接长度越短越好，这时候如果有一个链接<code>https://ffox.ml/grid02</code>经过重定向可以指向前文的网址，那边就会很美观且方便，而这就需要用到短链接生成技术。</p>\n<span id=\"more\"></span>\n<p>  其实短链接的作用主要在于数据统计、控制访问、便于管理。另外相同的页面，短链接与原链接生成的二维码的复杂度也大大不同。目前市面上主要的短链接服务可以参考：<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://sina.lt/why.php\" >短网址服务，我们该怎么选？</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，其中安照优先级介绍了部分优质的服务提供商。</p>\n<p>  除了使用服务商提供的短链接生成服务外，我们其实还可以自己搭建一个这样的服务。原理很简单，通过某种算法将长链接<code>A</code>转化为一个短字符串<code>B</code>，浏览器结合域名<code>C</code>访问<code>C/B</code>，服务器响应跳转至<code>A</code>，并在过程中完成数据的统计。目前有很多开源的短链接服务，其中之一就是今天的主角<code>Yourls</code>。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/1621008545.png\"  alt=\"\" />\n      </p>\n\n        <h2 id=\"yourls\"   >\n          <a href=\"#yourls\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#yourls\"></a> Yourls</h2>\n      \n<blockquote>\n<p>YOURLS stands for Your Own URL Shortener. It is a small set of PHP scripts that will allow you to run your own URL shortening service (a la TinyURL or Bitly).<br />\nRunning your own URL shortener is fun, geeky and useful: you own your data and do not depend on third-party services. It is also a great way to add branding to your short URLs, instead of using the same public URL shortener everyone uses.</p>\n</blockquote>\n<p>  <code>Yourls</code>的特性是开源免费，可以管理、统计每一个短链接的数量，提供API接口，而且具有众多插件，便于进行二次开发，下面就一起搭建一个自己的软链接服务。</p>\n\n        <h3 id=\"准备\"   >\n          <a href=\"#准备\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#准备\"></a> 准备</h3>\n      \n<p>  <code>Yourls</code>是基于PHP和MySQL开发的，所以需要提前准备好：</p>\n<ul>\n<li>Apache（2.4版本及以上）或Nginx服务器</li>\n<li>PHP（7.4版本及以上）</li>\n<li>MySQL（5.0版本及以上）</li>\n</ul>\n<p>  另外如果需要使用API接口，还需要安装PHP <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.php.net/curl\" >cURL</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>拓展。</p>\n\n        <h3 id=\"安装\"   >\n          <a href=\"#安装\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装\"></a> 安装</h3>\n      \n\n        <h4 id=\"下载\"   >\n          <a href=\"#下载\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#下载\"></a> 下载</h4>\n      \n<p>  从<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/YOURLS/YOURLS/releases\" >Releases</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>下载最新版本的安装包，目前使用的是1.8.1版本，并解压至工作目录</p>\n\n        <h4 id=\"配置文件\"   >\n          <a href=\"#配置文件\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#配置文件\"></a> 配置文件</h4>\n      \n<p>  将<code>user</code>目录下的<code>config-sample.php</code>复制备份命名为<code>config.php</code>，修改配置如下，更多设置请参考<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://yourls.org/#Config\" >Config</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></p>\n<figure class=\"highlight php\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 数据库配置</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_DB_USER&#x27;</span>, <span class=\"string\">&#x27;yourls&#x27;</span> );   <span class=\"comment\">//用户名</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_DB_PASS&#x27;</span>, <span class=\"string\">&#x27;xxxxxxxx&#x27;</span> );   <span class=\"comment\">//密码</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_DB_NAME&#x27;</span>, <span class=\"string\">&#x27;yourls&#x27;</span> );   <span class=\"comment\">//数据库名</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_DB_HOST&#x27;</span>, <span class=\"string\">&#x27;localhost&#x27;</span> );   <span class=\"comment\">//地址</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_DB_PREFIX&#x27;</span>, <span class=\"string\">&#x27;yourls_&#x27;</span> );   <span class=\"comment\">//表前缀</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 站点设置</span></span><br><span class=\"line\"><span class=\"comment\">#设置站点</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_SITE&#x27;</span>, <span class=\"string\">&#x27;http://ozh.in&#x27;</span> );   <span class=\"comment\">//域名</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_LANG&#x27;</span>, <span class=\"string\">&#x27;&#x27;</span> );   <span class=\"comment\">//语言</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_UNIQUE_URLS&#x27;</span>, <span class=\"literal\">true</span> );   <span class=\"comment\">//是否允许长链接对应多个短链接</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_HOURS_OFFSET&#x27;</span>, <span class=\"string\">&#x27;-5&#x27;</span> );   <span class=\"comment\">//时区偏移</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_PRIVATE&#x27;</span>, <span class=\"string\">&#x27;true&#x27;</span> );   <span class=\"comment\">//是否私有，如果私有的，则api接口需要传递用户名和密码，如果公开，则可以自由访问后台</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_COOKIEKEY&#x27;</span>, <span class=\"string\">&#x27;modify this text with something random&#x27;</span> );   <span class=\"comment\">//设置cookie，可访问http://yourls.org/cookie生成</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 用户设置</span></span><br><span class=\"line\"><span class=\"variable\">$yourls_user_passwords</span> = <span class=\"keyword\">array</span>(</span><br><span class=\"line\">    <span class=\"string\">&#x27;username&#x27;</span> =&gt; <span class=\"string\">&#x27;password&#x27;</span>,   <span class=\"comment\">//用户名=&gt;密码，可填多个，登录成功后这里的明文密码会被加密</span></span><br><span class=\"line\">    );</span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_DEBUG&#x27;</span>, <span class=\"literal\">false</span> );   <span class=\"comment\">//是否开启调试</span></span><br><span class=\"line\">define( <span class=\"string\">&#x27;YOURLS_URL_CONVERT&#x27;</span>, <span class=\"number\">62</span> );   <span class=\"comment\">//短链接字符串使用36进制或2进制，建议62进制</span></span><br><span class=\"line\"><span class=\"variable\">$yourls_reserved_URL</span> = <span class=\"keyword\">array</span>(</span><br><span class=\"line\">    <span class=\"string\">&#x27;porn&#x27;</span>, <span class=\"string\">&#x27;faggot&#x27;</span>, <span class=\"string\">&#x27;sex&#x27;</span>, <span class=\"string\">&#x27;nigger&#x27;</span>, <span class=\"string\">&#x27;fuck&#x27;</span>, <span class=\"string\">&#x27;cunt&#x27;</span>, <span class=\"string\">&#x27;dick&#x27;</span>,   <span class=\"comment\">//黑名单</span></span><br><span class=\"line\">);</span><br></pre></td></tr></table></div></figure>\n\n        <h4 id=\"服务器设置\"   >\n          <a href=\"#服务器设置\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#服务器设置\"></a> 服务器设置</h4>\n      \n<ol>\n<li>Apache<br />\n需要开启<code>mod_rewrite</code>模块，编辑<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/YOURLS/YOURLS/wiki/.htaccess\" >.htaccess</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>文件：</li>\n</ol>\n<figure class=\"highlight apache\"><figcaption><span>configuration</span></figcaption><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 根目录http://yoursite/</span></span><br><span class=\"line\"><span class=\"comment\"># BEGIN YOURLS</span></span><br><span class=\"line\"><span class=\"section\">&lt;IfModule mod_rewrite.c&gt;</span></span><br><span class=\"line\"><span class=\"attribute\"><span class=\"nomarkup\">RewriteEngine</span></span> <span class=\"literal\">On</span></span><br><span class=\"line\"><span class=\"attribute\">RewriteBase</span> /</span><br><span class=\"line\"><span class=\"attribute\"><span class=\"nomarkup\">RewriteCond</span></span> <span class=\"variable\">%&#123;REQUEST_FILENAME&#125;</span> !-f</span><br><span class=\"line\"><span class=\"attribute\"><span class=\"nomarkup\">RewriteCond</span></span> <span class=\"variable\">%&#123;REQUEST_FILENAME&#125;</span> !-d</span><br><span class=\"line\"><span class=\"attribute\"><span class=\"nomarkup\">RewriteRule</span></span> ^.*$ /yourls-loader.php<span class=\"meta\"> [L]</span></span><br><span class=\"line\"><span class=\"section\">&lt;/IfModule&gt;</span></span><br><span class=\"line\"><span class=\"comment\"># END YOURLS</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 二级目录http://yoursite/somedir/</span></span><br><span class=\"line\"><span class=\"comment\"># BEGIN YOURLS</span></span><br><span class=\"line\"><span class=\"section\">&lt;IfModule mod_rewrite.c&gt;</span></span><br><span class=\"line\"><span class=\"attribute\"><span class=\"nomarkup\">RewriteEngine</span></span> <span class=\"literal\">On</span></span><br><span class=\"line\"><span class=\"attribute\">RewriteBase</span> /somedir/</span><br><span class=\"line\"><span class=\"attribute\"><span class=\"nomarkup\">RewriteCond</span></span> <span class=\"variable\">%&#123;REQUEST_FILENAME&#125;</span> !-f</span><br><span class=\"line\"><span class=\"attribute\"><span class=\"nomarkup\">RewriteCond</span></span> <span class=\"variable\">%&#123;REQUEST_FILENAME&#125;</span> !-d</span><br><span class=\"line\"><span class=\"attribute\"><span class=\"nomarkup\">RewriteRule</span></span> ^.*$ /somedir/yourls-loader.php<span class=\"meta\"> [L]</span></span><br><span class=\"line\"><span class=\"section\">&lt;/IfModule&gt;</span></span><br><span class=\"line\"><span class=\"comment\"># END YOURLS</span></span><br></pre></td></tr></table></div></figure>\n<ol start=\"2\">\n<li>Nginx<br />\n请注意宝塔用户安照<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/YOURLS/YOURLS/wiki/Nginx-configuration\" >文档</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>中的操作可能无效，可以更改为：</li>\n</ol>\n<figure class=\"highlight nginx\"><figcaption><span>configuration</span></figcaption><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># HTTP over IPv4 &amp; IPv6</span></span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> [::]:<span class=\"number\">80</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># HTTPS over IPv4 &amp; IPv6</span></span><br><span class=\"line\">  <span class=\"comment\"># MUST BE EDITED TO REFLECT YOUR CONFIGURATION</span></span><br><span class=\"line\">  <span class=\"attribute\">listen</span> <span class=\"number\">443</span> ssl;</span><br><span class=\"line\">  <span class=\"attribute\">listen</span> [::]:<span class=\"number\">443</span> ssl;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_certificate</span>     example.com.crt;</span><br><span class=\"line\">  <span class=\"attribute\">ssl_certificate_key</span> example.com.key;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Server names</span></span><br><span class=\"line\">  <span class=\"comment\"># MUST BE EDITED TO REFLECT YOUR CONFIGURATION</span></span><br><span class=\"line\">  <span class=\"attribute\">server_name</span> example.com www.example.com;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># Root directory</span></span><br><span class=\"line\">  <span class=\"comment\"># MUST BE EDITED TO REFLECT YOUR CONFIGURATION</span></span><br><span class=\"line\">  <span class=\"attribute\">root</span> /path/to/yourls/files;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># 更改部分在这里！！！</span></span><br><span class=\"line\">  <span class=\"comment\"># 更改部分在这里！！！</span></span><br><span class=\"line\">  <span class=\"comment\"># 更改部分在这里！！！</span></span><br><span class=\"line\">  <span class=\"attribute\">location</span> /  </span><br><span class=\"line\">  &#123;  </span><br><span class=\"line\">    <span class=\"attribute\">if</span> (!-f $request_filename)&#123;</span><br><span class=\"line\">      <span class=\"attribute\">set</span> $rule_0 <span class=\"number\">1</span>$rule_0;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"attribute\">if</span> (!-d $request_filename)&#123;</span><br><span class=\"line\">      <span class=\"attribute\">set</span> $rule_0 <span class=\"number\">2</span>$rule_0;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"attribute\">if</span> ($rule_0 = <span class=\"string\">&quot;21&quot;</span>)&#123;</span><br><span class=\"line\">      <span class=\"attribute\">rewrite</span><span class=\"regexp\"> ^/.*$</span> /yourls-loader.php <span class=\"literal\">last</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># PHP engine</span></span><br><span class=\"line\">  <span class=\"attribute\">location</span> <span class=\"regexp\">~ \\.php$</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">include</span> fastcgi.conf;</span><br><span class=\"line\">    <span class=\"comment\"># OR</span></span><br><span class=\"line\">    <span class=\"comment\"># include fastcgi_params;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"attribute\">fastcgi_index</span> index.php;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># MUST BE EDITED TO REFLECT YOUR CONFIGURATION</span></span><br><span class=\"line\">    <span class=\"attribute\">fastcgi_pass</span> unix:/var/run/php/php7.2-fpm.sock;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n        <h4 id=\"安装-2\"   >\n          <a href=\"#安装-2\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装-2\"></a> 安装</h4>\n      \n<p>  访问<code>http://domain.com/admin</code>完成初安装，输入配置文件设置的账号、密码登陆后台。如果安装出错，可能是PHP或者MySQL版本不符合要求，或者是数据库初始化失败，可以按照<a href=\"#refer-3\">参考资料3</a>进行解决。</p>\n\n        <h2 id=\"短域名\"   >\n          <a href=\"#短域名\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#短域名\"></a> 短域名</h2>\n      \n<p>  短链接最重要的还是根域名要短，但是以<code>.com</code>、<code>.cn</code>、<code>.org</code>、<code>.top</code>、<code>.xyz</code>等常见一级域名的短域名基本已经抢注完成，剩下的价格也很昂贵。为了减小这个问题带来的影响，有两种解决方案。</p>\n\n        <h3 id=\"付费域名\"   >\n          <a href=\"#付费域名\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#付费域名\"></a> 付费域名</h3>\n      \n<p>  在我国的<code>.cn</code>域名下有一类特殊的二级域名：按照国家各个省级行政区划分的行政区划域名，例如<code>bj.cn</code>代表北京，<code>sh.cn</code>代表上海等。这些域名注册比较少，一些比较短的域名（例如<code>fox.hn.cn</code>，湖南）很有可能没有被注册，而且价格很便宜。目前<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.west.cn/\" >西部数码</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>、<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.diymysite.com/\" >域趣网络</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>等都提供这一类域名的注册。</p>\n\n        <h3 id=\"免费域名\"   >\n          <a href=\"#免费域名\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#免费域名\"></a> 免费域名</h3>\n      \n<p>  <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.freenom.com/\" >Freenom</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>是国际著名的免费域名提供商，可以提供<code>.tk</code>（托克劳）、<code>.ml</code>（马里）、<code>.ga</code>（加蓬）、<code>.cf</code>（中非共和国）、<code>.gq</code>（赤道几内亚）等国家一级域名，除特殊域名（少于4个字母，特殊含义等）外均可免费获取。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/20210515005206.png\"  alt=\"\" />\n      <br />\n  在Freenom获取免费域名有几个需要注意的地方：</p>\n<ol>\n<li>需要科学上网</li>\n<li>注册账号时，填写的地址信息一定要与科学上网后的IP地址保持一致，最好在美国!最好在美国!最好在美国!</li>\n<li>点击上图的<code>现在获取</code>会显示不可用，此时你只需要在搜索框中输入<code>ffox.ga</code>就可以解决，自动帮你添加购物车<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/1621011489-1-.png\"  alt=\"\" />\n      <br />\n  更多的教程与介绍可以查看下面的视频。</li>\n</ol>\n<div style=\"position: relative; width: 100%; height: 0; padding-bottom: 75%;\">\n    <iframe src=\"//player.bilibili.com/player.html?aid=80621564&bvid=BV1zJ411W7p3&cid=137972479&page=1&high_quality=1\"  scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\" style=\"position: absolute; width: 100%; height: 100%; left: 0; top: 0;\"></iframe>\n</div>\n\n        <h2 id=\"拓展与配置\"   >\n          <a href=\"#拓展与配置\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#拓展与配置\"></a> 拓展与配置</h2>\n      \n<p>  <code>Yourls</code>具有丰富的插件和主题，还有各种语言的翻译包，所有的插件都能在<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/YOURLS/awesome-yourls\" >awesome-yourls</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>找到介绍与项目地址。下面介绍一些我使用的拓展。</p>\n\n        <h3 id=\"插件\"   >\n          <a href=\"#插件\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#插件\"></a> 插件</h3>\n      \n<ol>\n<li>\n<p>Allow Hyphens in Short URLs<br />\n  自带的插件，允许短链接中出现连字符</p>\n</li>\n<li>\n<p>Random ShortURLs<br />\n  默认情况下，短链接按照顺序生成，从1开始，但是更好的方式是使用时间戳或随机字符串，这一个插件就可以随机生成短链接字符串，还可以设置字符串的长度。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/1621045278-1-.png\"  alt=\"\" />\n      </p>\n</li>\n<li>\n<p>Cache stat pages<br />\n  后台查看统计报表的数据都是实时统计的，此插件可以将缓存统计报表，加快访问速度</p>\n</li>\n<li>\n<p>YOURLS Static Titles<br />\n  当你输入一个长链接生成短链时，YOURLS会抓取长链接对应页面的标题信息，所以创建短链接的速度会受到页面访问速度的影响，此插件可以经过设置跳过抓取标题，加快生成速度。除了这一种方案以外，还可以根据<a href=\"#refer-4\">参考资料4</a>进行配置。</p>\n</li>\n</ol>\n\n        <h3 id=\"翻译\"   >\n          <a href=\"#翻译\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#翻译\"></a> 翻译</h3>\n      \n<p>  下载<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/ZvonimirSun/YOURLS-zh_CN\" >汉化包</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>中的<code>zh_CN.mo</code>文件，移动至<code>/user/languages</code>文件夹下，设置配置文件中的语言为<code>zh_CN</code>即可。</p>\n\n        <h3 id=\"主题\"   >\n          <a href=\"#主题\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#主题\"></a> 主题</h3>\n      \n<p>  目前官方页面的<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/YOURLS/awesome-yourls#themes-\" >主题</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>只有3个，大家可以搜寻比较好看的。我使用的主题是<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/Flynntes/Sleeky\" >Sleeky</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，不仅很好看而且还会添加前端首页。</p>\n<ol>\n<li>下载文件</li>\n<li>移动<code>sleeky-frontend</code>文件夹到网站根目录下</li>\n<li>配置<code>frontend/config.php</code></li>\n<li>移动<code>sleeky-backend</code>文件夹至<code>user/plugins/</code>目录</li>\n<li>在后台管理中<code>example.com/admin/plugins.php</code>启用插件<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/1621046193-1-.png\"  alt=\"\" />\n      </li>\n</ol>\n\n        <h2 id=\"其他\"   >\n          <a href=\"#其他\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#其他\"></a> 其他</h2>\n      \n<p>  查看统计数据，可以在后台的管理界面中数据统计查看，也可以在短链接后面添加<code>+</code>查看，例如<code>https://ffox.ml/LL+</code>，包括访问量、地区和来源等。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/1621046295-1-.jpg\"  alt=\"\" />\n      <br />\n  最后欢迎大家来玩–&gt;<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://ffox.ml/\" >FF的短链接生成器</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></p>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<p><span id=\"refer-1\">1. <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://yourls.org/\" >YOURLS: Your Own URL Shortener</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></span><br />\n<span id=\"refer-2\">2. <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/YOURLS/YOURLS/wiki\" >YOURLS Wiki</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></span><br />\n<span id=\"refer-3\">3. <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.cnblogs.com/myIvan/p/10582849.html\" >用yourls 搭建短链接地址服务</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></span><br />\n<span id=\"refer-4\">4. <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.csdn.net/hfut_wowo/article/details/108734217\" >关于yourls生成短链耗时太长问题解决</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></span><br />\n<span id=\"refer-5\">5. <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://hongcyu.cn/posts/hexo-bilibili.html\" >HEXO博客引用B站视频并自动适配</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></span></p>\n","categories":["软件/程序"],"tags":["安装","Nginx","PHP","域名"]},{"title":"Python模拟锁相放大器的工作过程","url":"/posts/202105-amplifier.html","content":"<style>\n  .Note {\n    width: 100%;\n    height: 7200px;\n    border: medium none;\n  }\n</style>\n<!-- <iframe src=\"https://lastknightcoder.gitee.io/jupyter-for-iframe/numpy%E5%85%A5%E9%97%A8.html\" class=\"Note\"></iframe> -->\n\n        <h2 id=\"准备\"   >\n          <a href=\"#准备\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#准备\"></a> 准备</h2>\n      \n<p>  本篇笔记将使用python演示锁相放大器的基本原理。<br />\n  首先引入需要用到的package，使用<code>%matplotlib widget</code>可以产生交互式的图片。</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy.fftpack <span class=\"keyword\">import</span> fft</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy <span class=\"keyword\">import</span> signal <span class=\"keyword\">as</span> sg</span><br><span class=\"line\"><span class=\"keyword\">from</span> matplotlib <span class=\"keyword\">import</span> pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\">%matplotlib widget</span><br></pre></td></tr></table></div></figure>\n<span id=\"more\"></span>\n\n        <h3 id=\"绘图\"   >\n          <a href=\"#绘图\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#绘图\"></a> 绘图</h3>\n      \n<p>  在本文中将会产生许多的图片，为了方便绘图编写一个展示信号的绘图函数。</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">draw</span>(<span class=\"params\">x, y, title=<span class=\"string\">&#x27;&#x27;</span>, xlable=<span class=\"string\">&#x27;time(s)&#x27;</span>, ylable=<span class=\"string\">&#x27;amplitude&#x27;</span>, L=-<span class=\"number\">3.8</span>, H=<span class=\"number\">3.8</span></span>):</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">    draw</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Parameters</span></span><br><span class=\"line\"><span class=\"string\">    ----------</span></span><br><span class=\"line\"><span class=\"string\">        x : numpy array</span></span><br><span class=\"line\"><span class=\"string\">            abscissa</span></span><br><span class=\"line\"><span class=\"string\">        y : numpy array</span></span><br><span class=\"line\"><span class=\"string\">            ordinate</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns</span></span><br><span class=\"line\"><span class=\"string\">    -------</span></span><br><span class=\"line\"><span class=\"string\">    &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">    <span class=\"comment\"># canvas settings</span></span><br><span class=\"line\">    plt.close()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> L!=H:</span><br><span class=\"line\">        plt.ylim(L, H)</span><br><span class=\"line\">    plt.title(title)</span><br><span class=\"line\">    plt.xlabel(xlable)</span><br><span class=\"line\">    plt.ylabel(ylable)</span><br><span class=\"line\"></span><br><span class=\"line\">    plt.plot(x, y)</span><br><span class=\"line\">    plt.show()</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"正弦波\"   >\n          <a href=\"#正弦波\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#正弦波\"></a> 正弦波</h3>\n      \n<p>  在本实验中将采用正弦波作为输入信号。另外，参考信号、噪声信号等都需要用到正弦信号，所以第一步将编写一个产生给定幅度、频率和相位的正弦信号的函数。</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">g_sin</span>(<span class=\"params\">t=<span class=\"number\">1</span>, amp=<span class=\"number\">1</span>, f0=<span class=\"number\">10</span>, fs=<span class=\"number\">500</span>, phi=<span class=\"number\">0</span></span>):</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">    generate sinusoid</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Parameters</span></span><br><span class=\"line\"><span class=\"string\">    ----------</span></span><br><span class=\"line\"><span class=\"string\">        t   : float</span></span><br><span class=\"line\"><span class=\"string\">            time length of the generated sequence</span></span><br><span class=\"line\"><span class=\"string\">        amp : float</span></span><br><span class=\"line\"><span class=\"string\">            amplitude</span></span><br><span class=\"line\"><span class=\"string\">        f0  : float</span></span><br><span class=\"line\"><span class=\"string\">            frequency of sinusoid in Hz</span></span><br><span class=\"line\"><span class=\"string\">        fs  : float</span></span><br><span class=\"line\"><span class=\"string\">            sampling rate per second</span></span><br><span class=\"line\"><span class=\"string\">        phi : float</span></span><br><span class=\"line\"><span class=\"string\">            initial phase in deg</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns</span></span><br><span class=\"line\"><span class=\"string\">    -------</span></span><br><span class=\"line\"><span class=\"string\">        anonymous : list[numpy array, numpy array]</span></span><br><span class=\"line\"><span class=\"string\">            [abscissa, a sinusoid signal]</span></span><br><span class=\"line\"><span class=\"string\">    &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">    T = <span class=\"number\">1</span>/fs</span><br><span class=\"line\">    N = t/T</span><br><span class=\"line\">    x = <span class=\"number\">2</span>*np.pi*np.arange(N)*T</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [np.arange(<span class=\"number\">0</span>, t, T), amp*np.sin(f0*x+phi*np.pi/<span class=\"number\">180</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">x, y = g_sin()</span><br><span class=\"line\">draw(x, y)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_1.png\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"方波\"   >\n          <a href=\"#方波\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#方波\"></a> 方波</h3>\n      \n<p>  参考信号可以使用正弦波、方波等。在本实验中将使用方波，而方波的傅里叶级数为：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>4</mn><mi>π</mi></mfrac><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">∞</mi></munderover><mfrac><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><msub><mi>ω</mi><mi>r</mi></msub><mi>t</mi><mo stretchy=\"false\">]</mo></mrow><mrow><mn>2</mn><mi>n</mi><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">f(x)=\\frac{4}{\\pi}\\sum\\limits_{n=0}^{\\infty}\\frac{sin[(2n+1)\\omega_rt]}{2n+1}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9185100000000004em;vertical-align:-1.267113em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">π</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6513970000000002em;\"><span style=\"top:-1.882887em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">n</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">∞</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.267113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">n</span><span class=\"mopen\">[</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathdefault\">n</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathdefault\">t</span><span class=\"mclose\">]</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>  所以我们可以利用上面的正弦波函数，产生一个近似的方波，方波的阶数（即K）越大近似效果越好，K=50时就有很好的效果。  (PS：此处方波均指占空比为50%，正负对称的方波)</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">g_square_wave</span>(<span class=\"params\">t=<span class=\"number\">1</span>, amp=<span class=\"number\">1</span>, f0=<span class=\"number\">10</span>, fs=<span class=\"number\">500</span>, K=<span class=\"number\">50</span></span>):</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">    generate square wave</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Parameters</span></span><br><span class=\"line\"><span class=\"string\">    ----------</span></span><br><span class=\"line\"><span class=\"string\">        t   : float</span></span><br><span class=\"line\"><span class=\"string\">            time length of the generated sequence</span></span><br><span class=\"line\"><span class=\"string\">        amp : float</span></span><br><span class=\"line\"><span class=\"string\">            amplitude</span></span><br><span class=\"line\"><span class=\"string\">        f0  : float</span></span><br><span class=\"line\"><span class=\"string\">            frequency of sinusoid in Hz</span></span><br><span class=\"line\"><span class=\"string\">        fs  : float</span></span><br><span class=\"line\"><span class=\"string\">            sampling rate per second</span></span><br><span class=\"line\"><span class=\"string\">        K   : int</span></span><br><span class=\"line\"><span class=\"string\">            order of fourier series</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns</span></span><br><span class=\"line\"><span class=\"string\">    -------</span></span><br><span class=\"line\"><span class=\"string\">        anonymous : list[numpy array, numpy array]</span></span><br><span class=\"line\"><span class=\"string\">            [abscissa, a square wave]</span></span><br><span class=\"line\"><span class=\"string\">    &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">    T = <span class=\"number\">1</span>/fs</span><br><span class=\"line\">    N = t/T</span><br><span class=\"line\">    x = <span class=\"number\">2</span>*np.pi*np.arange(N)*T</span><br><span class=\"line\"></span><br><span class=\"line\">    y = np.zeros(<span class=\"built_in\">len</span>(x))</span><br><span class=\"line\">    k = <span class=\"number\">2</span>*np.arange(<span class=\"number\">1</span>, K)-<span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(x)):</span><br><span class=\"line\">        y[i] = amp*np.<span class=\"built_in\">sum</span>(np.sin(k*f0*x[i])/k)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [np.arange(<span class=\"number\">0</span>, t, T), <span class=\"number\">4</span>*y/np.pi]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">x, y = g_square_wave()</span><br><span class=\"line\">draw(x, y)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_2.png\"  alt=\"\" />\n      </p>\n<p>  使用上述两个函数，可以叠加产生带有噪声的信号。</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">x, y1 = g_sin(amp=<span class=\"number\">0.2</span>, f0=<span class=\"number\">30</span>)</span><br><span class=\"line\">x, y2 = g_sin(amp=<span class=\"number\">0.35</span>, f0=<span class=\"number\">3</span>, phi=<span class=\"number\">45</span>)</span><br><span class=\"line\">x, y3 = g_square_wave(amp=<span class=\"number\">0.1</span>, f0=<span class=\"number\">10</span>)</span><br><span class=\"line\">draw(x, y1+y2+y3)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_3.png\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"频域分析\"   >\n          <a href=\"#频域分析\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#频域分析\"></a> 频域分析</h3>\n      \n<p>  这些噪声在时域中难以分辨。不过信号与噪声不同，往往具有明显的频率特征，而噪声一般是与频率无关的，或者是在特定频率范围内的，所以在频域内可以很好的分辨出输入信号的各种成分。<br />\n  使用快速傅里叶变换（FFT）从时域转化到频域，并且对振幅谱进行取半归一化。</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">FFT</span>(<span class=\"params\">s, fs</span>):</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">    fast fourier transform</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Parameters</span></span><br><span class=\"line\"><span class=\"string\">    ----------</span></span><br><span class=\"line\"><span class=\"string\">        s  : numpy array</span></span><br><span class=\"line\"><span class=\"string\">            signal</span></span><br><span class=\"line\"><span class=\"string\">        fs : float</span></span><br><span class=\"line\"><span class=\"string\">            sampling rate per second</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Returns</span></span><br><span class=\"line\"><span class=\"string\">    -------</span></span><br><span class=\"line\"><span class=\"string\">    &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">    X  = fft(s)</span><br><span class=\"line\">    mX = np.<span class=\"built_in\">abs</span>(X)   <span class=\"comment\"># magnitude</span></span><br><span class=\"line\">    pX = np.angle(X) <span class=\"comment\"># phase</span></span><br><span class=\"line\"></span><br><span class=\"line\">    draw(np.arange(<span class=\"built_in\">int</span>(fs/<span class=\"number\">2</span>)), mX[<span class=\"built_in\">range</span>(<span class=\"built_in\">int</span>(fs/<span class=\"number\">2</span>))]/fs, </span><br><span class=\"line\">         <span class=\"string\">&#x27;Input signal in frequency domain&#x27;</span>, <span class=\"string\">&#x27;frequency(Hz)&#x27;</span>, <span class=\"string\">&#x27;amplitude&#x27;</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">FFT(y1+y2+y3, <span class=\"number\">500</span>)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_4.png\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"高斯白噪声\"   >\n          <a href=\"#高斯白噪声\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#高斯白噪声\"></a> 高斯白噪声</h3>\n      \n<p>  上面的信号添加的噪声还是正弦信号，而现实中比较常见的噪声是白噪声。下面的函数可以根据输入信号产生一个特定信噪比的白噪声。<br />\n  信噪比的定义是：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>S</mi><mi>N</mi><mi>R</mi><mo stretchy=\"false\">(</mo><mi>d</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>10</mn><mi>l</mi><mi>g</mi><mfrac><msub><mi>P</mi><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>l</mi></mrow></msub><msub><mi>P</mi><mrow><mi>n</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>e</mi></mrow></msub></mfrac><mo>=</mo><mn>20</mn><mi>l</mi><mi>g</mi><mfrac><msub><mi>A</mi><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>a</mi><mi>l</mi></mrow></msub><msub><mi>A</mi><mrow><mi>n</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>e</mi></mrow></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">SNR(dB)=10lg\\frac{P_{signal}}{P_{noise}}=20lg\\frac{A_{signal}}{A_{noise}}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">d</span><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.19633em;vertical-align:-0.8360000000000001em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.36033em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">o</span><span class=\"mord mathdefault mtight\">i</span><span class=\"mord mathdefault mtight\">s</span><span class=\"mord mathdefault mtight\">e</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">s</span><span class=\"mord mathdefault mtight\">i</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">a</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.19633em;vertical-align:-0.8360000000000001em;\"></span><span class=\"mord\">2</span><span class=\"mord\">0</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.36033em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">o</span><span class=\"mord mathdefault mtight\">i</span><span class=\"mord mathdefault mtight\">s</span><span class=\"mord mathdefault mtight\">e</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361079999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">s</span><span class=\"mord mathdefault mtight\">i</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">a</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.01968em;\">l</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p>  在本实验中，功率<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span></span></span></span>可以用功<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>W</mi><mo>=</mo><mo>∫</mo><mi>P</mi><mi>d</mi><mi>t</mi><mo>=</mo><mi>C</mi><mo>∫</mo><msup><mi>A</mi><mn>2</mn></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">W=\\int Pdt=C\\int A^2dt</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">W</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.11112em;vertical-align:-0.30612em;\"></span><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathdefault\">d</span><span class=\"mord mathdefault\">t</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.120228em;vertical-align:-0.30612em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">C</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord mathdefault\">d</span><span class=\"mord mathdefault\">t</span></span></span></span>代替，因为信号和噪声的积分时间是相同的。而信号的波形是采样得到的，所以<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>W</mi></mrow><annotation encoding=\"application/x-tex\">W</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">W</span></span></span></span>可以用<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>∑</mo><msubsup><mi>x</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding=\"application/x-tex\">\\sum x_i^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.072772em;vertical-align:-0.258664em;\"></span><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-2.441336em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.258664em;\"><span></span></span></span></span></span></span></span></span></span>代替，于是有：</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>S</mi><mi>N</mi><mi>R</mi><mo>=</mo><mn>10</mn><mi>l</mi><mi>g</mi><mfrac><mrow><mo>∑</mo><msubsup><mi>s</mi><mi>i</mi><mn>2</mn></msubsup></mrow><mrow><mo>∑</mo><msubsup><mi>n</mi><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac><mo>⟹</mo><mo>∑</mo><msubsup><mi>n</mi><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><mrow><mo>∑</mo><msubsup><mi>s</mi><mi>i</mi><mn>2</mn></msubsup></mrow><mrow><mn>1</mn><msup><mn>0</mn><mrow><mi>S</mi><mi>N</mi><mi>R</mi><mi mathvariant=\"normal\">/</mi><mn>10</mn></mrow></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">SNR=10lg\\frac{\\sum s_i^2}{\\sum n_i^2} \\Longrightarrow \\sum n_i^2= \\frac{\\sum s_i^2}{10^{SNR/10}}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4539720000000003em;vertical-align:-0.9628639999999999em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.491108em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7959080000000001em;\"><span style=\"top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span><span style=\"top:-3.0448000000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.27686399999999994em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-2.441336em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.258664em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9628639999999999em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.6000100000000002em;vertical-align:-0.55001em;\"></span><span class=\"mop op-symbol large-op\" style=\"position:relative;top:-0.000004999999999977245em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1951080000000003em;vertical-align:-0.704em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.491108em;\"><span style=\"top:-2.2960000000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mtight\">/</span><span class=\"mord mtight\">1</span><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:-0.0000050000000000050004em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-2.441336em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.258664em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.704em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">wgn</span>(<span class=\"params\">x, snr</span>):</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">    generate Gauss white noise</span></span><br><span class=\"line\"><span class=\"string\">    </span></span><br><span class=\"line\"><span class=\"string\">    Parameters</span></span><br><span class=\"line\"><span class=\"string\">    ----------</span></span><br><span class=\"line\"><span class=\"string\">        x   : numpy array</span></span><br><span class=\"line\"><span class=\"string\">            signal</span></span><br><span class=\"line\"><span class=\"string\">        snr : float</span></span><br><span class=\"line\"><span class=\"string\">            signal-to-noise ratio</span></span><br><span class=\"line\"><span class=\"string\">        </span></span><br><span class=\"line\"><span class=\"string\">    Returns</span></span><br><span class=\"line\"><span class=\"string\">    -------</span></span><br><span class=\"line\"><span class=\"string\">        anonymous : numpy array</span></span><br><span class=\"line\"><span class=\"string\">            Gauss white noise</span></span><br><span class=\"line\"><span class=\"string\">    &#x27;&#x27;&#x27;</span></span><br><span class=\"line\">    snr    = <span class=\"number\">10</span>**(snr/<span class=\"number\">10.0</span>)</span><br><span class=\"line\">    xpower = np.<span class=\"built_in\">sum</span>(x**<span class=\"number\">2</span>)/<span class=\"built_in\">len</span>(x)</span><br><span class=\"line\">    npower = xpower / snr</span><br><span class=\"line\">    <span class=\"keyword\">return</span> np.random.randn(<span class=\"built_in\">len</span>(x)) * np.sqrt(npower)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">noise = wgn(np.sin(np.arange(<span class=\"number\">0</span>, <span class=\"number\">1000000</span>)*<span class=\"number\">0.1</span>), <span class=\"number\">6</span>)</span><br><span class=\"line\">plt.close()</span><br><span class=\"line\">plt.subplot(<span class=\"number\">211</span>)</span><br><span class=\"line\">plt.hist(noise, bins=<span class=\"number\">100</span>)</span><br><span class=\"line\">plt.subplot(<span class=\"number\">212</span>)</span><br><span class=\"line\">plt.psd(noise)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_5.png\"  alt=\"\" />\n      </p>\n\n        <h2 id=\"模拟\"   >\n          <a href=\"#模拟\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#模拟\"></a> 模拟</h2>\n      \n<p>  下面开始正式的模拟过程：</p>\n<ol>\n<li>获得输入信号，输入信号由10Hz的目标信号和其他频率的正弦噪声以及白噪声组成</li>\n</ol>\n<p>  A. 增加正弦部分</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">x, y1  = g_sin(amp=<span class=\"number\">0.1</span>)</span><br><span class=\"line\">x, y2  = g_sin(amp=<span class=\"number\">0.5</span>, f0=<span class=\"number\">50</span>)</span><br><span class=\"line\">x, y3  = g_sin(amp=<span class=\"number\">0.8</span>, f0=<span class=\"number\">3</span>)</span><br><span class=\"line\">x, y4  = g_sin(amp=<span class=\"number\">0.3</span>, f0=<span class=\"number\">200</span>)</span><br><span class=\"line\">signal = y1+y2+y3+y4</span><br></pre></td></tr></table></div></figure>\n<p>  B. 增加白噪声部分</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">noise = wgn(signal, <span class=\"number\">10</span>)</span><br><span class=\"line\">sn    = signal+noise</span><br><span class=\"line\">draw(x, sn)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_6.png\"  alt=\"\" />\n      <br />\n  C. 查看输入信号的频域信息</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">FFT(sn, <span class=\"number\">500</span>)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_7.png\"  alt=\"\" />\n      </p>\n<ol start=\"2\">\n<li>获得参考信号，方波频率与目标信号相同，为10Hz</li>\n</ol>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">x, y   = g_square_wave(K=<span class=\"number\">100</span>)</span><br><span class=\"line\">square = y</span><br><span class=\"line\">draw(x, square)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_8.png\"  alt=\"\" />\n      </p>\n<ol start=\"3\">\n<li>前置放大×2倍</li>\n</ol>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">sn = sn*<span class=\"number\">2</span></span><br><span class=\"line\">draw(x, sn)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_9.png\"  alt=\"\" />\n      </p>\n<ol start=\"4\">\n<li>输入信号进行带通滤波，除去/抑制部分噪声，增强锁相放大器的性能（动态储备和输出动态范围）</li>\n</ol>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">b, a = sg.butter(<span class=\"number\">1</span>, [<span class=\"number\">0.02</span>, <span class=\"number\">0.12</span>], <span class=\"string\">&#x27;bandpass&#x27;</span>) <span class=\"comment\"># 5Hz - 30Hz</span></span><br><span class=\"line\">snq  = sg.filtfilt(b, a, sn)</span><br><span class=\"line\">draw(x, snq)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_10.png\"  alt=\"\" />\n      </p>\n<ol start=\"5\">\n<li>调谐放大输入信号×5，增大信噪比</li>\n</ol>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">b, a = sg.butter(<span class=\"number\">1</span>, [<span class=\"number\">0.038</span>, <span class=\"number\">0.042</span>], <span class=\"string\">&#x27;bandpass&#x27;</span>) <span class=\"comment\"># 9.5Hz - 10.5Hz</span></span><br><span class=\"line\">sns  = sg.filtfilt(b, a, snq)</span><br><span class=\"line\">snq  = sns*<span class=\"number\">4</span>+snq</span><br><span class=\"line\">draw(x, snq)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_11.png\"  alt=\"\" />\n      </p>\n<ol start=\"6\">\n<li>PSD（相敏检波器）处理输入与参考信号（本质为乘法器）</li>\n</ol>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">snqx = snq*square</span><br><span class=\"line\">draw(x, snqx)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_12.png\"  alt=\"\" />\n      </p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">FFT(snqx, <span class=\"number\">500</span>)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_13.png\"  alt=\"\" />\n      </p>\n<ol start=\"7\">\n<li>低通滤波，减少其他信号对直流分量的影响（等效噪声宽度很小）</li>\n</ol>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">b, a = sg.butter(<span class=\"number\">3</span>, <span class=\"number\">0.00004</span>, <span class=\"string\">&#x27;lowpass&#x27;</span>) <span class=\"comment\"># 0 - 0.01Hz</span></span><br><span class=\"line\">sns  = sg.filtfilt(b, a, snqx)</span><br><span class=\"line\">draw(x, sns)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_14.png\"  alt=\"\" />\n      </p>\n<ol start=\"8\">\n<li>直流放大×5</li>\n</ol>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">sns = sns*<span class=\"number\">5</span></span><br><span class=\"line\">draw(x, sns)</span><br></pre></td></tr></table></div></figure>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/amplifier_15.png\"  alt=\"\" />\n      </p>\n","categories":["学习"],"tags":["Python","信号处理"]},{"title":"建国以来土地政策的变化","url":"/posts/202104-land.html","content":"\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  我国在相当长的时间内是一个传统的农业国，哪怕工业化之后，农民仍然占据人口的大多数，土地依旧是百姓关注的焦点，“耕者有其田”是自古以来百姓所渴望实现的目标。而且土地还关系到粮食生产的多少，直接影响国家的安危。</p>\n<span id=\"more\"></span>\n<p>  封建土地所有制在我国持续了两千多年。尽管统治者一直试图抑制土地兼并，保证自耕农阶层的稳定，但是每到封建王朝末期，严重的土地兼并和高额的赋税，使得大量自耕农破产，权贵阶层则手握大量土地，而朝廷却国库空虚，最终矛盾激化，政权更替<sup><a href=\"#refer-1\">[1]</a></sup>。</p>\n<p>  辛亥革命之后，以孙中山为代表的部分人努力实现“耕者有其田”的目标，但是由于官僚主义、帝国主义、封建主义这三座大山的压迫，广大农民的处境并没有得到改善，土地依然大量掌握在军阀、权贵手中，“富者阡陌连田，穷者无立锥之地”的情形时有发生。</p>\n<p>  中国共产党成立之后，以马克思主义为指导思想，结合实际情况摸索实践，建立了一个适合中国国情的、与时俱进、不断迭代优化的土地政策，实现了千百年来中华民族关于土地的愿望。本文以我党上世纪的土地政策为例，论述我党土地政策的内容和思想，探讨其中蕴含的马克思主义思想和中国特色。</p>\n\n        <h2 id=\"我国土地政策的变化\"   >\n          <a href=\"#我国土地政策的变化\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#我国土地政策的变化\"></a> 我国土地政策的变化</h2>\n      \n<p>  从土地革命战争到家庭联产承包制，再到土地使用权流转，中国共产党的土地政策上世纪中不断变化着。我党的土地政策阶段，主要可以分为三个阶段，分别是建党后至建国前，建国后至改革开放前和改革开放后。</p>\n\n        <h3 id=\"建国前耕者有其田的伟大目标\"   >\n          <a href=\"#建国前耕者有其田的伟大目标\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#建国前耕者有其田的伟大目标\"></a> 建国前：耕者有其田的伟大目标</h3>\n      \n\n        <h4 id=\"土地革命战争破除封建土地所有制\"   >\n          <a href=\"#土地革命战争破除封建土地所有制\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#土地革命战争破除封建土地所有制\"></a> 土地革命战争：破除封建土地所有制</h4>\n      \n<p>  1921年至1937年被称为土地革命战争时期，这一时期社会的主要矛盾是代表广大人民利益的中国共产党和代表地主、资本家、军阀、买办利益的国民党反动派之间的矛盾，我党在广大的苏区农村地区展开了大规模的土地革命。最初党提出了“限租限地”的政策，保护佃农的权益，打击土地兼并。随着根据地的不断扩大和革命的深入，党逐渐意识到“中国革命的根本问题是土地问题”，而要解决土地问题，关键就在于土地所有权<sup><a href=\"#refer-2\">[2]</a></sup>，于是党提出要没收大地主、军阀、劣绅和宗祠的土地，主张“耕地农有”，即谁耕种的土地归谁所有，将大量土地分给农民，切实解决农民土地所有权问题。</p>\n<p>  1928年，我党第一部土地法《井冈山土地法》颁布，规定“没收农村一切土地”，然而这一过程却损害了所有农民的利益，而不仅仅是大地主和富农<sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">1</a></sup>。于是在1929年的《兴国县土地法》中做出了更正：“没收一切公共土地及地主阶级的土地”<sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">2</a></sup>，毛泽东称其为“一个原则的改正”<sup class=\"footnote-ref\"><a href=\"#fn3\" id=\"fnref3\">3</a></sup><sup><a href=\"#refer-3\">[3]</a></sup>。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/20210515115650.png\"  alt=\"\" />\n      </p>\n<div style=\"margin: 0 auto;text-align: center;\"><b>图 1 井冈山土地法</b></div>\n<p>  在这一时期，我党土地改革所参考的形式是苏联斯大林模式的农村集体化道路，认为“广大农民得到解放的必由之路是由土地国有过渡到大规模的社会主义生产”<sup class=\"footnote-ref\"><a href=\"#fn4\" id=\"fnref4\">4</a></sup>“没收一切土地,客观上是实行土地的国有”，最终目标是要“实现集体的社会主义的土地生产道路”<sup class=\"footnote-ref\"><a href=\"#fn5\" id=\"fnref5\">5</a></sup>，这些举措是我党土地政策的创新与实践，赢得了广大群众的支持，帮助我党在国民党反动派的打压下，不断扩大并巩固了革命根据地。</p>\n\n        <h4 id=\"抗日战争减租减息巩固民族统一战线\"   >\n          <a href=\"#抗日战争减租减息巩固民族统一战线\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#抗日战争减租减息巩固民族统一战线\"></a> 抗日战争：减租减息巩固民族统一战线</h4>\n      \n<p>  抗日战争中，中日民族矛盾取代土地革命战争时期的人民与国民党反动派的矛盾，成为了社会主要矛盾。为了建立巩固民族统一战线，在1937年六届中央政治局于陕北召开洛川会议，决定将“减租减息”作为抗战期间的土地政策，列入《抗日救国十大纲领》之中<sup><a href=\"#refer-4\">[4]</a></sup>。“地主减租减息，农民交租交息”，通过这一方式，我党调节了农民和和地主富农之间的矛盾，将他们一同纳入抗日民族统一战线之中。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/05/20210515140446.png\"  alt=\"\" />\n      </p>\n<div style=\"margin: 0 auto;text-align: center;\"><b>图 2 中国共产党抗日救国十大纲领</b></div>\n<p>  在这一特殊时期，我党推行的“减租减息”政策暂缓了土地改革的进程，但是起到了团结社会各阶级的作用，不仅壮大了抗日力量，而且还巩固了革命根据地的统治<sup class=\"footnote-ref\"><a href=\"#fn6\" id=\"fnref6\">6</a></sup>。</p>\n\n        <h4 id=\"解放战争耕者有其田目标的实现\"   >\n          <a href=\"#解放战争耕者有其田目标的实现\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#解放战争耕者有其田目标的实现\"></a> 解放战争：耕者有其田目标的实现</h4>\n      \n<p>  随着抗日战争的结束，中日民族矛盾基本得到了解决，国共两党曾试图通过和平方式协商统一，于是在抗战后的一段时间内，我党沿用了抗战时期的土地政策，毛泽东在1945年11月指出：“目前我党的方针，仍然是减租而不是没收土地”<sup class=\"footnote-ref\"><a href=\"#fn7\" id=\"fnref7\">7</a></sup><sup><a href=\"#refer-4\">[4]</a></sup>。</p>\n<p>  随着蒋介石政府发动内战的迹象越来越明显，而人民群众希望废除封建土地制度，解决土地问题的呼声越来越大，我党土地政策的核心内容从“减租减息”变为“没收地主土地，彻底废除封建土地制度”。1947年，中共中央颁布了《中国土地法大纲》，明确了“土地均分给农民这一原则”<sup class=\"footnote-ref\"><a href=\"#fn8\" id=\"fnref8\">8</a></sup>。土地改革从根本上改变了土地所有制，实现了中国百姓几千年来“耕者有其田”的梦想。</p>\n<p>  建国前，我党的土地政策经过了没收土地、耕地农有、减租减息、土地革命等多个阶段，这些政策是根据社会主要矛盾的演变而与时俱进的。通过近30年的努力，我党完全废除了封建土地所有制，实现了中国百姓的夙愿，巩固了农村基层组织，让我党获得了广大群众的拥护和支持。这一时期的土地政策，为建国后的土地政策和土地立法提供了丰富的经验。</p>\n\n        <h3 id=\"改开前土地公有制的伟大尝试\"   >\n          <a href=\"#改开前土地公有制的伟大尝试\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#改开前土地公有制的伟大尝试\"></a> 改开前：土地公有制的伟大尝试</h3>\n      \n\n        <h4 id=\"改造集体土地所有制\"   >\n          <a href=\"#改造集体土地所有制\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#改造集体土地所有制\"></a> 改造：集体土地所有制</h4>\n      \n<p>  建国后并没有停下土地改革的进程。农民经过土地革命，虽然分到了土地，但是由于自然经济生产经营分散，技术地下，抗风险能力弱，所以我国农业在经过短暂的快速发展后，又陷入了瓶颈。</p>\n<p>  毛泽东从马克思主义的角度出发，思考了中国历朝历代的土地政策，认为只有实现土地公有制度，才能从根本上解决土地问题。于是我国仿照苏联进行农业集体化的方式，针对中国地少人多的实际情况，开始了新的土地制度改革路程<sup><a href=\"#refer-5\">[5]</a></sup>。</p>\n<p>  1953年开始的农业合作化，是社会主义三大改造的一部分。农业合作化的实质是通过互助合作的形式将生产资料私有制为基础的小私有经济改造成生产资料公有为基础的合作经济的过程。农业合作化先后经历了具有社会主义萌芽的互助组、土地入股统一经营的初级阶段和土地、耕畜、农具等折价归集体所有的高级阶段。到1956年已经基本完成农业社会主义改造，初步建立了农村土地集体所有制。</p>\n\n        <h4 id=\"推进合作社与人民公社\"   >\n          <a href=\"#推进合作社与人民公社\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#推进合作社与人民公社\"></a> 推进：合作社与人民公社</h4>\n      \n<p>  1958年3月中共中央通过了《关于把小型的农业合作社适当地合并为大社的意见》<sup class=\"footnote-ref\"><a href=\"#fn9\" id=\"fnref9\">9</a></sup>，鼓励“有条件的地方，把小型的农业合作社有计划地适当地合并为大型的合作社“，这是人民公社化的前奏。同年8月，中共中央通过了《关于在农村建立人民公社问题的决议》，提出要通过建立人民公社“加快社会主义建设的速度”，其本质特征是规模“巨型化”和实行“政社合一”的管理体制<sup class=\"footnote-ref\"><a href=\"#fn10\" id=\"fnref10\">10</a></sup>。</p>\n<p>  总的来说，农业的社会主义改造和人民公社化解决了农村贫富分化现象重新出现、个体农业不能满足工业需求、自然经济抗风险能力差等问题。人民公社20年，全国人口增长近2.8亿，为工业化、现代化提供了8000多亿的资金，修建了价值约180万亿的水利工程，功在当代，利在千秋。但是在这个过程也出现了浮夸风、共产风、一刀切和平均主义的隐患，为后来人民公社的取缔埋下了伏笔。</p>\n\n        <h3 id=\"改开后土地生产力的蓬勃发展\"   >\n          <a href=\"#改开后土地生产力的蓬勃发展\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#改开后土地生产力的蓬勃发展\"></a> 改开后：土地生产力的蓬勃发展</h3>\n      \n\n        <h4 id=\"改革农村土地承包与城市土地流转\"   >\n          <a href=\"#改革农村土地承包与城市土地流转\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#改革农村土地承包与城市土地流转\"></a> 改革：农村土地承包与城市土地流转</h4>\n      \n<p>  文革后的短时间内，全国经济不振，长期的平均主义政策抑制了农民的劳动积极性，致使农业生产长期停滞不前，农民生活质量得不到明显改善，再加上天灾不断，迫使我党对土地政策做出了调整。</p>\n<p>  1978年12月，十三届三中全会的召开拉开了改革开放的序幕。同时期，关于建立具有中国特色的土地政策的改革也在农村和城市地区引起了广泛讨论。</p>\n<p>  以安徽凤阳小岗村为代表的包产到户掀起了农村土地政策变革的大幕。1980年9月，中央下发《关于进一步加强和完善农业生产责任制的几个问题的通知》<sup class=\"footnote-ref\"><a href=\"#fn11\" id=\"fnref11\">11</a></sup>的文件，明确在坚持土地集体所有的前提下，“可以包产到户，也可以包干到户”，在1982年颁布的中央1号文件中，中央强调，“包产到户”“包干到户”“都是建立在土地公有制基础上的，是社会主义农业经济的组成部分”<sup class=\"footnote-ref\"><a href=\"#fn12\" id=\"fnref12\">12</a></sup>。</p>\n<p>  家庭联产承包责任制总体上而言，改变了我国农村旧的经营管理体制，解放了农村生产力，调动了广大农民的生产经营积极性。但是家庭分散经营，经营规模小、风险大，抗风险能力差，难以形成规模经济效益，而且农民不能自由处置土地，限制了农民的择业自由，另外分散化也导致农村基础设施难以建设，农业生产长期高成本。</p>\n\n        <h4 id=\"发展解决问题细化管理\"   >\n          <a href=\"#发展解决问题细化管理\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#发展解决问题细化管理\"></a> 发展：解决问题，细化管理</h4>\n      \n<p>  为了解决农业发展的问题，推动农业发展走向规模化、现代化，提升农业的市场竞争力，中央在各地进行了积极探索，尝试了多种土地流转形式。</p>\n<p>  1992年邓小平南巡讲话后, 国家确立了建设社会主义市场经济的改革方针, 农业与农村经济发展掀起了新浪潮。1993年全国人大修正了宪法，从根本大法上确立了家庭联产承包责任制的法律地位，终止了多年来对家庭联产承包责任制的非议与争论，推动农业发展。</p>\n<p>  我国经济在改革开放后进入高速发展期，这对土地管理制度提出了更高的要求。完善土地管理制度成为了这一时期的当务之急。由于在很长的一段时间内，我国的农村地区占据主要地位，农村土地也是土地的主要部分，所以在1982年之前，我国的土地管理制度主要是农村土地管理。但是伴随着城市的发展，土地管理制度也做出了重大改变。</p>\n<p>  1982年至1986年期间，我国的实行城乡土地分割管理的制度，农村用地由农业部负责，城市用地由建设部管理，但是这一制度不能适应我国耕地不足的情况，所以在1986年我国决定建立城乡土地统一管理制度。特别是针对耕地管理，我国在1997年发布了《关于进一步加强土地管理切实保护耕地的通知》提出要加强土地宏观管理，特别是加强土地管理的执法监督检查<sup class=\"footnote-ref\"><a href=\"#fn13\" id=\"fnref13\">13</a></sup>；在1998年通过了《土地管理法》，确立了保护耕地的基本国策<sup><a href=\"#refer-6\">[6]</a></sup>。</p>\n<p>  改革开放以来的土地政策相较于之前发生了巨大的改变，也取得了很大的成效。我党在这一时期的土地政策，充满了创新、探索，特别是发挥了试点作用，在一项政策取得成功后不断推广，有很好的反响。我国的土地政策不断完善，对解放土地生产力发挥了重要作用。</p>\n\n        <h2 id=\"土地政策马克思主义中国化的产物\"   >\n          <a href=\"#土地政策马克思主义中国化的产物\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#土地政策马克思主义中国化的产物\"></a> 土地政策：马克思主义中国化的产物</h2>\n      \n<p>  马克思从未明确提出过 “土地产权” 这一概念，但是我们依然可以在他的著作中提取到他的土地产权理论，这一套理论包括了土地产权制度及其变迁、 土地产权权能、 土地产权结合与分离、土地产权商品化及配置市场化等诸多部分，对我党土地制度的建立与改革产生了深远影响<sup><a href=\"#refer-7\">[7]</a></sup>。</p>\n<p>  几十年来，中国共产党始终以马克思主义作为指导思想，把“以人民为中心”作为政策主线，从无到有建立了符合实际，切合国情的中国特色社会主义土地制度，并且随着社会主要矛盾的改变不断完善土地政策和基于土地集体所有的生产关系。从思想特质上来所，我党的的土地政策是马克思主义中国化的产物。</p>\n<p>  在土地革命战争时期，以毛泽东为核心的第一代党中央领导集体把马克思列宁主义的基本原理同中国的国情相结合，制定了具有中国特色的土地路线、方针和政策，是毛泽东思想的重要组成部分。在这一思想的指导下，我党将这一时期的工作重心放在农村，深入基层，发动农民进行抗争，一起废除腐朽的封建土地制度，并且在实践中不断探索、创新，制定出符合中国实际情况的土地改革制度<sup><a href=\"#refer-8\">[8]</a></sup>。这一过程充分体现了毛泽东思想中“结合实际，实事求是”的基本点，邓小平同志腾说：“毛泽东同志所以伟大，能把中国革命引导到胜利，归根到底，这是靠这个”<sup class=\"footnote-ref\"><a href=\"#fn14\" id=\"fnref14\">14</a></sup>。</p>\n<p>  改革开放后至今的土地政策，与建立社会主义市场经济体制的改革总目标保持紧密结合。社会主义市场经济体制不是资本主义，它是与中国特色社会主义的基本制度结合在一起的，目标是使市场在国家宏观调控下对资源配置起到基础性作用。在全球化日益加深和改革开放不断深入、扩大的背景下，土地政策要在坚持土地公有制的前提下，发挥市场对土地资源配置的基础作用，但也要处理好土地管理中国家计划与资本市场之间的关系，发挥制度优势<sup><a href=\"#refer-8\">[8]</a></sup>。</p>\n<div style=\"max-width: 900px;margin: 0 auto;\">\n    <div id=\"food_container\" style=\"max-width: 900px;height:400px;\"></div>\n</div>\n<script src=\"https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js\"></script>\n<script type=\"text/javascript\">\n    var food = echarts.init(document.getElementById('food_container'));\n    var base = new Date(), date = [];\n\tvar data = [395.95, 395.95, 395.95, 395.95, 395.95, 443.93, 443.93, 443.93, 443.93, 443.93, 494.65, 494.65, 494.65, 684.31, 684.31, 684.31, 684.31, 684.31, 838.44, 838.44, 838.44, 838.44, 838.44, 1020.46, 1020.46, 1020.46, 1117.50, 1325.30, 1454.10, 1635.87, 1865.30, 2074.47, 2380.15, 2506.40, 2771.75, 3160.49, 3666.89, 4100.58, 4954.30, 5146.43, 5588.02, 6605.14, 9169.22, 11884.60, 13539.80, 13852.50, 14241.90, 14106.20, 13873.60, 14462.79, 14931.50, 14870.11, 18138.36, 19613.37, 21522.28, 24444.68, 27679.94, 29938.81, 35909.07, 40339.62, 44845.72, 48943.94, 51851.12, 54205.34, 55659.89, 58059.76, 61452.60, 66066.45];\n    var dyear = base.getFullYear(), dmonth = base.getMonth()+1;\n    var year = 1952;\n    while ( year<dyear ) {\n        date.push([year].join('/'));\n        year += 1;\n    }\n    var food_option = {\n        title: { text: '我国农业总产值', subtext: '自1952年起，数据来源国家统计局' },\n        tooltip: { trigger: 'axis' },\n        xAxis: { type: 'category', data: date },\n        yAxis: { type: 'value' },\n        dataZoom: [{}],\n        series: [{\n            type: 'line',\n            data: data\n        }]\n    };\n\tfood.setOption(food_option);\n</script>\n<div style=\"margin: 0 auto;text-align: center;\"><b>图 3 1952年以来我国农业生产总产值</b></div>\n<p>  事实也证明，我党的土地政策是有利于农业发展，提高农民生活水平的。从图 3可以看出，每当农业发展到瓶颈时，我党总是能够适时的完善、改革土地政策：1978年改革开放，随后开始了家庭联产承包责任制，我国农业迅速从文革中恢复，开始增长；1992年，邓小平南巡讲话，1993年宪法确立了联产承包的法律地位，我国农业顿时跃上了一个新台阶；世纪之交，我国经济形势发生了重大变化，为了适应新世纪的需要，2002年党的十六大正式提出允许土地使用权流转，农业生产总产值再次迅速增加，至今我国农业已经连续二十多年取得丰收，农民的生活也获得了巨大改善。</p>\n<div style=\"margin: 0 auto;text-align: center;\"><b>表 1 农村发展数据</b></div>\n<div class=\"table-container\"><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">年份</th>\n<th style=\"text-align:center\">粮食产量（万吨）</th>\n<th style=\"text-align:center\">农村居民人均纯收入（元）</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1980年</td>\n<td style=\"text-align:center\">32055.50</td>\n<td style=\"text-align:center\">191.3</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2000年</td>\n<td style=\"text-align:center\">46217.52</td>\n<td style=\"text-align:center\">2253.4</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2020年</td>\n<td style=\"text-align:center\">66949.00</td>\n<td style=\"text-align:center\">14617.0（2018）</td>\n</tr>\n</tbody>\n</table></div>\n\n        <h2 id=\"总结\"   >\n          <a href=\"#总结\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#总结\"></a> 总结</h2>\n      \n<p>  回顾土地政策的发展演变历史，土地政策的变革是毛泽东思想和中国特色社会主义的实践与证明。毛泽东指出：“当革命的形势己经改变的时候，革命的策略、革命的领导方式，也必须跟着改变。”<sup class=\"footnote-ref\"><a href=\"#fn15\" id=\"fnref15\">15</a></sup>而随着主要矛盾的改变，我们的土地政策也必须要做出相应的改变。</p>\n<p>  邓小平思想中关于三个有利于的说法，也可以延伸出一个标准：是否有利于解放和发展生产力是衡量中国一切政党政策及其实践的根本标准。三个代表重要思想也提出“中国共产党始终代表中国先进生产力的发展要求，就是要不断地解放和发展生产力”。</p>\n<p>  土地政策的变革证明，我党的土地政策，极具中国特色，而且切实解决了千百年来的土地问题；我党的土地政策，既是中国人民智慧的结晶，又是马克思主义指导的成果；我党的土地政策，不仅没有背离马克思主义的指导，更是拓宽了马克思主义关于土地问题的思考与探索<sup><a href=\"#refer-9\">[9]</a></sup>。总而言之，我党的土地政策，是马克思主义中国化的代表与证明。</p>\n\n        <h2 id=\"参考文献\"   >\n          <a href=\"#参考文献\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考文献\"></a> 参考文献</h2>\n      \n<p><span id=\"refer-1\">1. 党的以人民为中心的土地政策_百年沿革与发展_俞明轩[J].</span><br />\n<span id=\"refer-2\">2. 俞明轩, 谷雨佳, 李睿哲. 党的以人民为中心的土地政策：百年沿革与发展[J]. 管理世界, 2021,37(04): 24-35.</span><br />\n<span id=\"refer-3\">3. 温锐, 杨丽琼. 中央苏区平分土地政策与农民权益保障的再认识[J]. 中共党史研究, 2010(05): 64-70.</span><br />\n<span id=\"refer-4\">4. 阎庆生, 黄正林. 论陕甘宁边区的土地政策和土地立法[J]. 西北师大学报(社会科学版), 2001(06): 54-59.</span><br />\n<span id=\"refer-5\">5. 郑品芳, 李佑新. 中国共产党百年农村土地政策制度改革研究[J]. 湖南大学学报(社会科学版), 2021,35(02): 9-16.</span><br />\n<span id=\"refer-6\">6. 姜爱林. 改革开放以来中国土地政策的发展变迁[J]. 中州学刊, 2003(05): 48-53.</span><br />\n<span id=\"refer-7\">7. 洪名勇. 论马克思的土地产权理论[J]. 经济学家, 1998(01): 28-33.</span><br />\n<span id=\"refer-8\">8. 张永泉. 毛泽东在解决农民土地问题上的重大贡献[J]. 浙江学刊, 1994(01): 21-24.</span><br />\n<span id=\"refer-9\">9. 姜炳三. 中国农村土地制度建设的理论指南──学习建设中国特色社会主义理论的几点体会[J]. 浙江社会科学, 1995(01): 36-42.</span></p>\n<hr class=\"footnotes-sep\" />\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p>《中央通讯二十八号——农民运动的策略(一)(1929年2月3日),《第一、二次国内革命战争时期土地斗争史料选编》,人民出版社,1981年,第 272 页 <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p>《建党以来重要文献选编（1921—1949）》（第 6 册）,中国文献出版社,2011 年版,第 184 页 <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn3\" class=\"footnote-item\"><p>《毛泽东农村调查文集》,人民出版社,1982年,第 40 页 <a href=\"#fnref3\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn4\" class=\"footnote-item\"><p>《江西省致湘江赣边特委(综合)指示》(1929年9月6日),《第一、二次国内革命战争时期土地斗争史料选编》,第 320 页 <a href=\"#fnref4\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn5\" class=\"footnote-item\"><p>《土地问题与反富农策略》(1931年2月8日),苏区中央局,《第一、二次国内革命战争时期土地斗争史料选编》,第 492 页 <a href=\"#fnref5\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn6\" class=\"footnote-item\"><p>《中国共产党历史第一卷（1921-1949）》（下册）,中共党史出版社,2002 年版,第 596~597 页 <a href=\"#fnref6\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn7\" class=\"footnote-item\"><p>《减租和生产是保卫解放区的两件大事》,《毛泽东选集》第4卷,人民出版社1991年版,第 1173 页 <a href=\"#fnref7\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn8\" class=\"footnote-item\"><p>《中央关于土地问题的指示》,《中国中央文件选集》第16册,人民出版社1992年版,第 528~530 页 <a href=\"#fnref8\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn9\" class=\"footnote-item\"><p>《建国以来重要文献选编》（第 11 册）,中央文献出版社,2011 年版,第 209~211 页 <a href=\"#fnref9\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn10\" class=\"footnote-item\"><p>《建国以来重要文献选编》（第 11 册）,中央文献出版社,2011 年版,第 446~451页 <a href=\"#fnref10\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn11\" class=\"footnote-item\"><p>《新时期农业和农村工作重要文献选编》,中央文献出版社,1992 年版,第 60 页 <a href=\"#fnref11\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn12\" class=\"footnote-item\"><p>《全国农村工作会议纪要》,《新时期重要文献选编》（三中全会以来重要文件选编下）,人民数据 <a href=\"#fnref12\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn13\" class=\"footnote-item\"><p>《中共中央、国务院关于进一步加强土地管理切实保护耕地的通知》,《新时期重要文献选编》（十四大以来重要文件选编下）,人民数据 <a href=\"#fnref13\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn14\" class=\"footnote-item\"><p>《邓小平文选》第2卷,人民出版社,1993年,第121页 <a href=\"#fnref14\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn15\" class=\"footnote-item\"><p>《论反对日本帝国主义的策略》,《毛泽东选集》第1卷,人民出版社1991年版,第 142-169 页 <a href=\"#fnref15\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>\n</section>\n","categories":["随记"],"tags":["马列毛邓"]},{"title":"宝塔Nginx反向代理导致css/js/png等重定向过多","url":"/posts/202104-redirect.html","content":"\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  在之前的文章<a href=\"/posts/move.html\">博客服务器迁移过程</a>中介绍了<code>footprint</code>打造旅行地图，然后使用Nginx反向代理，将<code>ff.cn/travel</code>指向<code>127.0.0.1:886</code>，原本访问一切正常，但是昨天碰到了一个新的问题：css/js/png等文件请求301重定向过多，花了蛮久才解决问题，所以记下来提醒自己。</p>\n<span id=\"more\"></span>\n\n        <h2 id=\"复现\"   >\n          <a href=\"#复现\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#复现\"></a> 复现</h2>\n      \n<p>  在网站<code>/travel/</code>目录下创建<code>hello.js</code>文件，请求<code>ff.cn/travel/hello.js</code>，显示<code>ff.cn 将您重定向的次数过多</code>。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/04/20210412203604.png\"  alt=\"\" />\n      <br />\n  在开发者模式下查看网络请求，发现服务器将<code>ff.cn/travel/hello.js</code>重定向给自身，导致出现死循环。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/04/20210412203648.png\"  alt=\"\" />\n      </p>\n\n        <h2 id=\"解决\"   >\n          <a href=\"#解决\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#解决\"></a> 解决</h2>\n      \n<ol>\n<li>浏览器提示清除cookie：</li>\n</ol>\n<blockquote>\n<p>当相应网页尝试对您进行重定向的次数过多时，您就会看到这条错误消息。<br />\n有时，网页打不开是因为 Cookie 出问题了。要修正该错误，请尝试清除 Cookie。</p>\n</blockquote>\n\n    <div class=\"note-plugin danger\">\n      <span class=\"note-plugin__icon note-plugin__icon--danger\">\n              <i class=\"fas fa-minus-circle\"></i>\n            </span>\n      <p>无作用</p>\n    </div>\n  \n<ol start=\"2\">\n<li>刷新DNS/更换DNS<br />\n  重定向过多可能发生了DNS劫持，可以刷新DNS或者换一个DNS地址。</li>\n</ol>\n\n    <div class=\"note-plugin danger\">\n      <span class=\"note-plugin__icon note-plugin__icon--danger\">\n              <i class=\"fas fa-minus-circle\"></i>\n            </span>\n      <p>无作用</p>\n    </div>\n  \n<ol start=\"3\">\n<li>SSL证书问题<br />\n  如果开启了强制访问HTTPS或者SSL证书更换，可能导致前后端接口不一致，陷入反复跳转，造成重定向过多，可以重置SSL证书或者重启强制访问HTTPS。</li>\n</ol>\n\n    <div class=\"note-plugin danger\">\n      <span class=\"note-plugin__icon note-plugin__icon--danger\">\n              <i class=\"fas fa-minus-circle\"></i>\n            </span>\n      <p>无作用</p>\n    </div>\n  \n\n        <h2 id=\"分析\"   >\n          <a href=\"#分析\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#分析\"></a> 分析</h2>\n      \n<p>  查看Nginx日志，发现浏览器发出请求<code>ff.cn/travel/hello.js</code>时，本应该转给<code>127.0.0.1:886/hello.js</code>，然而日志中显示回应请求的链接是<code>127.0.0.1:80/travel/hello.js</code>，怀疑是代理设置出现问题。<br />\n  查看<code>ff.cn</code>的配置文件如下：</p>\n<figure class=\"highlight nginx\"><figcaption><span>configuration</span></figcaption><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">server</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">listen</span> <span class=\"number\">443</span> ssl http2;</span><br><span class=\"line\">    <span class=\"attribute\">server_name</span> ff.cn;</span><br><span class=\"line\">    <span class=\"attribute\">index</span> index.php index.html index.htm default.php default.htm default.html;</span><br><span class=\"line\">    <span class=\"attribute\">root</span> /ff.cn;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#SSL-START SSL相关配置，请勿删除或修改下一行带注释的404规则</span></span><br><span class=\"line\">    <span class=\"comment\">#error_page 404/404.html;</span></span><br><span class=\"line\">    <span class=\"comment\">#HTTP_TO_HTTPS_START</span></span><br><span class=\"line\">    <span class=\"attribute\">if</span> ($server_port !<span class=\"regexp\">~ 443)</span>&#123;</span><br><span class=\"line\">        <span class=\"attribute\">rewrite</span><span class=\"regexp\"> ^(/.*)$</span> https://$host<span class=\"variable\">$1</span> <span class=\"literal\">permanent</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#SSL-END</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#ERROR-PAGE-START  错误页配置，可以注释、删除或修改</span></span><br><span class=\"line\">    <span class=\"comment\">#error_page 404 /404.html;</span></span><br><span class=\"line\">    <span class=\"comment\">#error_page 502 /502.html;</span></span><br><span class=\"line\">    <span class=\"comment\">#ERROR-PAGE-END</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#PHP-INFO-START  PHP引用配置，可以注释或修改</span></span><br><span class=\"line\">    <span class=\"comment\">#清理缓存规则</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attribute\">location</span> <span class=\"regexp\">~ /purge(/.*)</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">proxy_cache_purge</span> cache_one $host<span class=\"variable\">$1</span>$is_args$args;</span><br><span class=\"line\">        <span class=\"comment\">#access_log  /www/wwwlogs/ff.cn_purge_cache.log;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">#引用反向代理规则，注释后配置的反向代理将无效</span></span><br><span class=\"line\">    <span class=\"attribute\">include</span> /www/server/panel/vhost/nginx/proxy/ff.cn/<span class=\"regexp\">*.conf</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attribute\">include</span> enable-php-<span class=\"number\">00</span>.conf;</span><br><span class=\"line\">    <span class=\"comment\">#PHP-INFO-END</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#REWRITE-START URL重写规则引用,修改后将导致面板设置的伪静态规则失效</span></span><br><span class=\"line\">    <span class=\"attribute\">include</span> /www/server/panel/vhost/rewrite/ff.cn.conf;</span><br><span class=\"line\">    <span class=\"comment\">#REWRITE-END</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#禁止访问的文件或目录</span></span><br><span class=\"line\">    <span class=\"attribute\">location</span> <span class=\"regexp\">~ ^/(\\.user.ini|\\.htaccess|\\.git|\\.svn|\\.project|LICENSE|README.md)</span></span><br><span class=\"line\"><span class=\"regexp\"></span>    &#123;</span><br><span class=\"line\">        <span class=\"attribute\">return</span> <span class=\"number\">404</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#一键申请SSL证书验证目录相关设置</span></span><br><span class=\"line\">    <span class=\"attribute\">location</span> <span class=\"regexp\">~ \\.well-known</span>&#123;</span><br><span class=\"line\">        <span class=\"attribute\">allow</span> all;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"attribute\">access_log</span>  /www/wwwlogs/ff.cn.log;</span><br><span class=\"line\">    <span class=\"attribute\">error_log</span>  /www/wwwlogs/ff.cn.<span class=\"literal\">error</span>.log;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<figure class=\"highlight nginx\"><figcaption><span>configuration</span></figcaption><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#PROXY-START/travel/</span></span><br><span class=\"line\"><span class=\"attribute\">location</span>  <span class=\"regexp\">~* \\.(php|jsp|js|css|png|cgi|asp|aspx)$</span></span><br><span class=\"line\"><span class=\"regexp\"></span>&#123;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_pass</span> http://127.0.0.1;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> Host $host;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> X-Real-IP $remote_addr;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> REMOTE-HOST $remote_addr;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"attribute\">location</span> /travel/</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_pass</span> http://127.0.0.1:886/;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> Host $host;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> X-Real-IP $remote_addr;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">    <span class=\"attribute\">proxy_set_header</span> REMOTE-HOST $remote_addr;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"attribute\">add_header</span> X-Cache $upstream_cache_status;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">#Set Nginx Cache</span></span><br><span class=\"line\">    <span class=\"attribute\">add_header</span> Cache-Control <span class=\"literal\">no</span>-cache;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">#PROXY-END/travel/</span></span><br></pre></td></tr></table></div></figure>\n<p>  可以发现，问题出现在了代理配置中的<code>location ~* \\.(php|jsp|js|css|png|cgi|asp|aspx)$</code>这一块。当接受到<code>ff.cn/travel/hello.js</code>请求时，根据代理配置进行转发，js/css/png等文件匹配上了第一条规则，于是请求被发往<code>127.0.0.1:80/travel/hello.js</code>，也就刚好是<code>ff.cn/travel/hello.js</code>自身，造成了死循环。将这一片段或者<code>js|css|png</code>删除即可解决</p>\n\n        <h2 id=\"后记\"   >\n          <a href=\"#后记\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#后记\"></a> 后记</h2>\n      \n<p>  宝塔确实有点诡异，上一秒还好好访问的，结果突然就重定向了。以后碰到问题多看日志，更容易发现问题所在的地方。</p>\n","categories":["软件/程序"],"tags":["反向代理","Nginx"]},{"title":"使用Echarts绘制名侦探柯南人物关系图","url":"/posts/202104-conan.html","content":"\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  《名侦探柯南绯色的子弹》就要上映了，npy想要和我一起去看，但是她又搞不懂人物关系，所以就用<code>Echarts</code>做一个柯南的人物关系表了解一下。<br />\n  <code>ECharts</code>是使用<code>JavaScript</code>实现的开源可视化库，可以做出很多精巧的图片，最初由百度团队开源，后于2018年初捐赠给Apache基金会，成为ASF孵化级项目。</p>\n<span id=\"more\"></span>\n\n        <h2 id=\"步骤\"   >\n          <a href=\"#步骤\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#步骤\"></a> 步骤</h2>\n      \n<ol>\n<li>引入<code>jquery</code>和<code>echarts</code>的js文件</li>\n</ol>\n<figure class=\"highlight html\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.bootcdn.net/ajax/libs/echarts/5.0.2/echarts.min.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<ol start=\"2\">\n<li>获取<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://cdn.jsdelivr.net/gh/YiHui-Liu/Fox-Home-CDN/Detective-Conan.json\" >人物关系json文件</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span><br />\n  json文件中主要分为3部分，分别是<code>nodes</code>表示人物，<code>links</code>表示关系连接，<code>categories</code>表示阵营/类别。</li>\n</ol>\n<ul>\n<li>nodes</li>\n</ul>\n<figure class=\"highlight json\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 必填，二选一</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;id&quot;</span>: <span class=\"string\">&quot;0&quot;</span>,   <span class=\"comment\">// 人物id</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;name&quot;</span>: <span class=\"string\">&quot;柯南&quot;</span>,   <span class=\"comment\">// 人物名称</span></span><br><span class=\"line\">    <span class=\"comment\">// 选填</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;symbolSize&quot;</span>: <span class=\"number\">50</span>,   <span class=\"comment\">// 点的大小</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;value&quot;</span>: <span class=\"number\">100</span>,   <span class=\"comment\">// 力引导布局(force)中连线长度</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;category&quot;</span>: <span class=\"number\">0</span>,   <span class=\"comment\">// 人物类别</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;itemStyle&quot;</span>: &#123;   <span class=\"comment\">// 自定义样式</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;normal&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">&quot;color&quot;</span>: <span class=\"string\">&quot;blue&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<ul>\n<li>links</li>\n</ul>\n<figure class=\"highlight json\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 必填</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;source&quot;</span>: <span class=\"string\">&quot;1&quot;</span>,   <span class=\"comment\">// 源节点名称或者id</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;target&quot;</span>: <span class=\"string\">&quot;0&quot;</span>,   <span class=\"comment\">// 目标节点名称或者id</span></span><br><span class=\"line\">    <span class=\"comment\">// 选填</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;value&quot;</span>: <span class=\"number\">100</span>,   <span class=\"comment\">// 力引导布局(force)中连线长度</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;name&quot;</span>: <span class=\"string\">&quot;伙伴&quot;</span>   <span class=\"comment\">// 关系名称</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<ul>\n<li>categories</li>\n</ul>\n<figure class=\"highlight json\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 必填</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;name&quot;</span>: <span class=\"string\">&quot;黑衣组织&quot;</span>,   <span class=\"comment\">// 类别名称</span></span><br><span class=\"line\">    <span class=\"comment\">// 选填</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;symbol&quot;</span>: <span class=\"string\">&quot;circle&quot;</span>,   <span class=\"comment\">// 类目节点标记的图形</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;symbolSize&quot;</span>: <span class=\"number\">10</span>,   <span class=\"comment\">// 类目节点的默认大小</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n<ol start=\"3\">\n<li>配置前端</li>\n</ol>\n<figure class=\"highlight html\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;conan_container&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<figure class=\"highlight js\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> conan = echarts.init(<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">&quot;conan_container&quot;</span>));</span><br><span class=\"line\">    <span class=\"keyword\">var</span> option;</span><br><span class=\"line\">    conan.showLoading();</span><br><span class=\"line\">    $.getJSON(<span class=\"string\">&#x27;https://cdn.jsdelivr.net/gh/YiHui-Liu/Fox-Home-CDN/Detective-Conan.json&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">graph</span>) </span>&#123;</span><br><span class=\"line\">        conan.hideLoading();</span><br><span class=\"line\">        option = &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 图表标题与位置</span></span><br><span class=\"line\">            title: &#123;</span><br><span class=\"line\">                text: <span class=\"string\">&#x27;Detective Conan&#x27;</span>,</span><br><span class=\"line\">                top: <span class=\"string\">&#x27;bottom&#x27;</span>,</span><br><span class=\"line\">                left: <span class=\"string\">&#x27;right&#x27;</span></span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            tooltip: &#123;&#125;,</span><br><span class=\"line\">            legend: [&#123;</span><br><span class=\"line\">                <span class=\"comment\">// selectedMode: &#x27;single&#x27;,</span></span><br><span class=\"line\">                data: graph.categories.map(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">a</span>) </span>&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> a.name;</span><br><span class=\"line\">                &#125;)</span><br><span class=\"line\">            &#125;],</span><br><span class=\"line\">            animationDuration: <span class=\"number\">1500</span>,</span><br><span class=\"line\">            animationEasingUpdate: <span class=\"string\">&#x27;quinticInOut&#x27;</span>,</span><br><span class=\"line\">            series: [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    name: <span class=\"string\">&#x27;Detective Conan&#x27;</span>,</span><br><span class=\"line\">                    type: <span class=\"string\">&#x27;graph&#x27;</span>,</span><br><span class=\"line\">                    <span class=\"comment\">// 布局，none使用节点中提供的x、y作为节点的位置；circular采用环形布局；force采用力引导布局</span></span><br><span class=\"line\">                    layout: <span class=\"string\">&#x27;circular&#x27;</span>,</span><br><span class=\"line\">                    data: graph.nodes,</span><br><span class=\"line\">                    links: graph.links,</span><br><span class=\"line\">                    categories: graph.categories,</span><br><span class=\"line\">                    symbolSize: <span class=\"number\">15</span>,</span><br><span class=\"line\">                    value: <span class=\"number\">30</span>,</span><br><span class=\"line\">                    roam: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                    label: &#123;</span><br><span class=\"line\">                        show: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                        position: <span class=\"string\">&#x27;right&#x27;</span>,</span><br><span class=\"line\">                        formatter: <span class=\"string\">&#x27;&#123;b&#125;&#x27;</span></span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    labelLayout: &#123;</span><br><span class=\"line\">                        hideOverlap: <span class=\"literal\">true</span></span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    lineStyle: &#123;</span><br><span class=\"line\">                        color: <span class=\"string\">&#x27;source&#x27;</span>,</span><br><span class=\"line\">                        curveness: <span class=\"number\">0.3</span></span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    <span class=\"comment\">// 突出显示有连接的人物</span></span><br><span class=\"line\">                    emphasis: &#123;</span><br><span class=\"line\">                        focus: <span class=\"string\">&#x27;adjacency&#x27;</span>,</span><br><span class=\"line\">                        lineStyle: &#123;</span><br><span class=\"line\">                            width: <span class=\"number\">10</span></span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    <span class=\"comment\">// 缩放限制</span></span><br><span class=\"line\">                    scaleLimit: &#123;</span><br><span class=\"line\">                        min: <span class=\"number\">0.6</span>,</span><br><span class=\"line\">                        max: <span class=\"number\">3</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"comment\">// 显示links的名称</span></span><br><span class=\"line\">                    <span class=\"comment\">// edgeSymbolSize: [4, 10],</span></span><br><span class=\"line\">                    <span class=\"comment\">// edgeLabel: &#123;</span></span><br><span class=\"line\">                    <span class=\"comment\">//     show: true,</span></span><br><span class=\"line\">                    <span class=\"comment\">//     formatter: function (x) &#123;</span></span><br><span class=\"line\">                    <span class=\"comment\">//         return x.data.name;</span></span><br><span class=\"line\">                    <span class=\"comment\">//     &#125;,</span></span><br><span class=\"line\">                    <span class=\"comment\">//     textStyle: &#123;</span></span><br><span class=\"line\">                    <span class=\"comment\">//         fontSize: 20</span></span><br><span class=\"line\">                    <span class=\"comment\">//     &#125;</span></span><br><span class=\"line\">                    <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">                    <span class=\"comment\">// 力引导布局的设置</span></span><br><span class=\"line\">                    <span class=\"comment\">// force: &#123;</span></span><br><span class=\"line\">                    <span class=\"comment\">//     repulsion: 2500,</span></span><br><span class=\"line\">                    <span class=\"comment\">//     edgeLength: [10, 50]</span></span><br><span class=\"line\">                    <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        conan.setOption(option);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (option &amp;&amp; <span class=\"keyword\">typeof</span> option === <span class=\"string\">&#x27;object&#x27;</span>) &#123;</span><br><span class=\"line\">        conan.setOption(option);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"效果展示\"   >\n          <a href=\"#效果展示\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#效果展示\"></a> 效果展示</h2>\n      \n<script type=\"text/javascript\" src=\"https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js\"></script>\n<script type=\"text/javascript\" src=\"https://cdn.bootcdn.net/ajax/libs/echarts/5.0.2/echarts.min.js\"></script>\n<div id=\"conan_container\" style=\"max-width: 900px;height: 600px;\"></div>\n<script type=\"text/javascript\">\n    var conan = echarts.init(document.getElementById(\"conan_container\"));\n    var option;\n    conan.showLoading();\n    $.getJSON('https://cdn.jsdelivr.net/gh/YiHui-Liu/Fox-Home-CDN/Detective-Conan.json', function (graph) {\n        conan.hideLoading();\n        option = {\n            title: {\n                text: 'Detective Conan',\n                top: 'bottom',\n                left: 'right'\n            },\n            tooltip: {\n                formatter: function (x) {\n                    return x.data.des;\n                }\n            },\n            legend: [{\n                // selectedMode: 'single',\n                data: graph.categories.map(function (a) {\n                    return a.name;\n                })\n            }],\n            animationDuration: 1500,\n            animationEasingUpdate: 'quinticInOut',\n            series: [\n                {\n                    name: 'Detective Conan',\n                    type: 'graph',\n                    layout: 'circular',\n                    data: graph.nodes,\n                    links: graph.links,\n                    categories: graph.categories,\n                    symbolSize: 15,\n                    value: 30,\n                    roam: true,\n                    label: {\n                        show: true,\n                        position: 'right',\n                        formatter: '{b}'\n                    },\n                    labelLayout: {\n                        hideOverlap: true\n                    },\n                    lineStyle: {\n                        color: 'source',\n                        curveness: 0.3\n                    },\n                    emphasis: {\n                        focus: 'adjacency',\n                        lineStyle: {\n                            width: 10\n                        }\n                    },\n                    scaleLimit: {\n                        min: 0.6,\n                        max: 3\n                    }\n                }\n            ]\n        };\n        conan.setOption(option);\n    });\n    if (option && typeof option === 'object') {\n        conan.setOption(option);\n    }\n</script>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ol>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.csdn.net/weixin_38409915/article/details/114369054\" >人物关系图谱:ECharts 实现</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://echarts.apache.org/examples/zh/index.html\" >Echarts文档</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://echarts.apache.org/zh/option.html\" >Echarts示例</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ol>\n","categories":["软件/程序"],"tags":["Echarts","名侦探柯南","Javascript"]},{"title":"博客成长日志 | 评论系统Waline","url":"/posts/202104-waline.html","content":"\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://waline.js.org/\" >waline</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>是由<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/lizheming\" >lizheming</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>开发的博客评论系统，从<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://valine.js.org/\" >Valine</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>衍生的带后端评论系统。可以将<code>Waline</code>等价成<code>With backend Valine</code>。<br />\n  Waline的服务端可以部署在<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://vercel.com/\" >Vercel</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>、<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.cloudbase.net\" >CloudBase</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>或者服务器上，数据库可以使用<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.leancloud.cn/\" >LeanCloud</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>、MySQL等，总计有多达48钟部署方式。在官方教程中，使用云服务部署都介绍的比较详细，下面介绍两种本地部署方式，可以自定义端口，配合多种数据库使用。</p>\n<span id=\"more\"></span>\n\n        <h2 id=\"docker\"   >\n          <a href=\"#docker\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#docker\"></a> Docker</h2>\n      \n<p>  在Docker容器内运行<code>vanilla.js</code>文件。</p>\n<ol>\n<li>修改<code>Node.js</code>淘宝源</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 单次使用</span></span><br><span class=\"line\">npm install module_name --registry=https://registry.npm.taobao.org</span><br><span class=\"line\"><span class=\"comment\"># 永久修改</span></span><br><span class=\"line\">npm config <span class=\"built_in\">set</span> registry https://registry.npm.taobao.org</span><br><span class=\"line\"><span class=\"comment\"># 使用cnpm，安装了cnpm之后，npm install 都可以换成cnpm install</span></span><br><span class=\"line\">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></div></figure>\n<ol start=\"2\">\n<li>构建镜像</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/lizheming/waline.git</span><br><span class=\"line\"><span class=\"built_in\">cd</span> waline</span><br><span class=\"line\">docker build -t image_name -f packages/server/Dockerfile .</span><br></pre></td></tr></table></div></figure>\n<ol start=\"3\">\n<li>修改配置<code>packages/client/.env</code>，参考文档中所需环境变量配置即可</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">SKIP_PREFLIGHT_CHECK=<span class=\"literal\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 数据库配置，参考https://waline.js.org/server/databases.html</span></span><br><span class=\"line\">MYSQL_HOST=127.0.0.1</span><br><span class=\"line\">MYSQL_DB=db_name</span><br><span class=\"line\">MYSQL_USER=db_user</span><br><span class=\"line\">MYSQL_PASSWORD=password</span><br><span class=\"line\"></span><br><span class=\"line\">AKISMET_KEY=guess</span><br><span class=\"line\"></span><br><span class=\"line\">SITE_NAME=Fox Home</span><br><span class=\"line\">SITE_URL=https://foolishfox.cn</span><br><span class=\"line\">AUTHOR_EMAIL=fox@foolishfox.cn</span><br><span class=\"line\"></span><br><span class=\"line\">SC_KEY=SCK232027Td54bfab83cfabf0aereq2c31b6552cd35fe1a43720074</span><br><span class=\"line\"></span><br><span class=\"line\">SMTP_HOST=smtp.ym.163.com</span><br><span class=\"line\">SMTP_PORT=465</span><br><span class=\"line\">SMTP_USER=fox@foolishfox.cn</span><br><span class=\"line\">SMTP_PASS=password</span><br><span class=\"line\">SENDER_NAME=fox</span><br><span class=\"line\">SENDER_EMAIL=fox@foolishfox.cn</span><br></pre></td></tr></table></div></figure>\n<ol start=\"4\">\n<li>运行镜像</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run --env-file ./packages/client/.env -p 8360:8360 -d image_name</span><br></pre></td></tr></table></div></figure>\n<ol start=\"5\">\n<li>设置反向目录代理，将<code>api.foolishfox.cn/waline</code>指向<code>127.0.0.1:8360</code></li>\n<li>进入容器</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看容器id</span></span><br><span class=\"line\">root@iZ2ze8k2vy63cz277rsw8zZ:$ docker ps -a</span><br><span class=\"line\">CONTAINER ID   IMAGE              COMMAND                  CREATED          STATUS          PORTS                    NAMES</span><br><span class=\"line\">cebd15a83483   lizheming/waline   <span class=\"string\">&quot;docker-entrypoint.s…&quot;</span>   44 seconds ago   Up 42 seconds   0.0.0.0:8360-&gt;8360/tcp   admiring_noether</span><br><span class=\"line\"><span class=\"comment\"># 进入容器</span></span><br><span class=\"line\">root@iZ2ze8k2vy63cz277rsw8zZ:$ docker <span class=\"built_in\">exec</span> -it cebd15a83483 /bin/bash</span><br></pre></td></tr></table></div></figure>\n<ol start=\"7\">\n<li>安装<code>vim</code>（可跳过）与验证组件</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">apt update</span><br><span class=\"line\">apt install vim</span><br><span class=\"line\">apt install apt-transport-https ca-certificates</span><br></pre></td></tr></table></div></figure>\n<ol start=\"8\">\n<li>更新软件源（使用<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://mirrors.tuna.tsinghua.edu.cn/help/debian/\" >清华源</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>）</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 备份</span></span><br><span class=\"line\">mv /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class=\"line\"><span class=\"comment\"># vim修改</span></span><br><span class=\"line\">vim /etc/apt/sources.list</span><br><span class=\"line\"><span class=\"comment\"># echo修改</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster main contrib non-free&quot;</span> &gt;/etc/apt/sources.list</span><br><span class=\"line\"><span class=\"comment\"># 更新</span></span><br><span class=\"line\">apt update</span><br><span class=\"line\">...</span><br></pre></td></tr></table></div></figure>\n<figure class=\"highlight plain\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span><br><span class=\"line\">deb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;debian&#x2F; buster main contrib non-free</span><br><span class=\"line\"># deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;debian&#x2F; buster main contrib non-free</span><br><span class=\"line\">deb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;debian&#x2F; buster-updates main contrib non-free</span><br><span class=\"line\"># deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;debian&#x2F; buster-updates main contrib non-free</span><br><span class=\"line\">deb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;debian&#x2F; buster-backports main contrib non-free</span><br><span class=\"line\"># deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;debian&#x2F; buster-backports main contrib non-free</span><br><span class=\"line\">deb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;debian-security buster&#x2F;updates main contrib non-free</span><br><span class=\"line\"># deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;debian-security buster&#x2F;updates main contrib non-free</span><br></pre></td></tr></table></div></figure>\n<ol start=\"9\">\n<li>配置<code>config.js</code>，路径为：<code>node_modules/@waline/vercel/config.js</code>，参考<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://waline.js.org/server/basic.html#%E4%BB%A3%E7%A0%81%E9%85%8D%E7%BD%AE\" >服务端配置</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ol>\n<figure class=\"highlight js\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    secureDomains: [</span><br><span class=\"line\">        <span class=\"string\">&#x27;foolishfox.cn&#x27;</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;api.foolishfox.cn&#x27;</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;localhost&#x27;</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;127.0.0.1&#x27;</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    forbiddenWords: [</span><br><span class=\"line\">        <span class=\"string\">&#x27;空包&#x27;</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;快递&#x27;</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;下单&#x27;</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    disallowIPList: [</span><br><span class=\"line\">        <span class=\"string\">&#x27;8.8.8.8&#x27;</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></div></figure>\n<ol start=\"10\">\n<li>修改主程序<code>vanilla.js</code>，导入自定义配置</li>\n</ol>\n<figure class=\"highlight js\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> Application = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;thinkjs&#x27;</span>);</span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"keyword\">let</span> config = &#123;&#125;</span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    config = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;./config.js&#x27;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span>(e) &#123;&#125;</span><br><span class=\"line\">...</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"直接部署\"   >\n          <a href=\"#直接部署\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#直接部署\"></a> 直接部署</h2>\n      \n<p>  直接部署方便对配置进行修改，不需要更新镜像，安装好模块后使用<code>Node.js</code>运行模块内的<code>vanilla.js</code>文件即可。</p>\n<ol>\n<li>安装waline</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir walinejs &amp;&amp; <span class=\"built_in\">cd</span> walinejs</span><br><span class=\"line\">cnpm install @waline/vercel --save</span><br></pre></td></tr></table></div></figure>\n<ol start=\"2\">\n<li>编辑<code>.bashrc</code>，添加环境变量，最好将字符串用<code>&quot;</code>或者<code>'</code>包起来，避免<code>$</code>、<code>&amp;</code>等字符的影响</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">MYSQL_HOST=<span class=\"string\">&#x27;rm-*.mysql.rds.aliyuncs.com&#x27;</span></span><br><span class=\"line\">...</span><br><span class=\"line\">SENDER_EMAIL=<span class=\"string\">&#x27;fox@foolishfox.cn&#x27;</span></span><br></pre></td></tr></table></div></figure>\n<ol start=\"3\">\n<li>创建软链接，方便后续操作</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">ln -s node_modules/@waline/vercel ./waline</span><br><span class=\"line\"><span class=\"built_in\">cd</span> waline</span><br></pre></td></tr></table></div></figure>\n<ol start=\"4\">\n<li>配置服务端<code>vim config.js</code>，见上</li>\n<li>修改主程序<code>vanilla.js</code>，见上</li>\n<li>使用pm2运行程序</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">cnpm install -g pm2</span><br><span class=\"line\">pm2 start vanilla.js --name waline</span><br></pre></td></tr></table></div></figure>\n<ol start=\"7\">\n<li>设置反向目录代理，将<code>api.foolishfox.cn/waline</code>指向<code>127.0.0.1:8360</code></li>\n</ol>\n\n        <h2 id=\"前端配置\"   >\n          <a href=\"#前端配置\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前端配置\"></a> 前端配置</h2>\n      \n<p>  参考<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://waline.js.org/client/basic.html\" >文档</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，需要注意的有：</p>\n<ol>\n<li>本地(localhost)访问不增加计数（以<code>hexo</code>为例）</li>\n</ol>\n<figure class=\"highlight js\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> Waline(&#123;</span><br><span class=\"line\">    el: <span class=\"string\">&#x27;#waline&#x27;</span>,</span><br><span class=\"line\">    path: location.pathname,</span><br><span class=\"line\">    serverURL: <span class=\"string\">&#x27;https://your-serverURL.domain.com&#x27;</span>,</span><br><span class=\"line\">    visitor: location.hostname!==<span class=\"string\">&#x27;localhost&#x27;</span> &amp;&amp; !&#123; theme.waline.visitor &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ol>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://waline.js.org/\" >waline</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><a href=\"/posts/move.html\">博客服务器迁移过程</a></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.e-learn.cn/content/qita/2389149\" >pm2入门</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ol>\n","categories":["博客成长日志"],"tags":["安装","反向代理","Waline"]},{"title":"博客成长日志 | 服务器迁移","url":"/posts/202103-move.html","content":"\n    <div class=\"note-plugin info\">\n      <span class=\"note-plugin__icon note-plugin__icon--info\">\n              <i class=\"fas fa-info-circle\"></i>\n            </span>\n      <p><strong>Info</strong><br />本文记录迁移过程备忘，方便后面再次迁移</p>\n    </div>\n  \n\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  阿里云ECS学生机要过期了，由于自己曾经升级过ECS的带宽（从1M到3M），所以不能享受续费优惠，无奈之下，只能选择进行服务器迁移。备选的方案有腾讯云CVM、阿里云轻量应用服务器和硅云ECS。</p>\n<span id=\"more\"></span>\n<p>  硅云最早被Pass，毕竟和前面两家大厂相比不论是产品可选择性还是可靠性都略显不足，只能放在次要选择。腾讯云有学生优惠，2H4G3M服务器400+一年，还可以同样价格续费，很实惠。不过最终综合价格和便捷，还是选择了阿里云，初购96/年的轻量应用服务器，毕竟我的RDS数据库和OSS（被我用又拍云云储存顶替了）都是阿里云的。</p>\n\n        <h2 id=\"准备\"   >\n          <a href=\"#准备\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#准备\"></a> 准备</h2>\n      \n<p>  买好服务器后，首先配置一下shh免密码登录，方便后面的过程进行。<br />\n  下一步查看一下有哪些东西需要进行迁移。我的服务都已经添加了监控，可以直接在<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://status.foolishfox.cn/\" >监控-服务</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>看到：<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/03/20210330202813.png\"  alt=\"\" />\n      <br />\n  仔细清点过后，需要进行迁移的服务有：</p>\n<ul>\n<li>API-Img: 图片、视频等静态文件API，阿里云OSS -&gt; 又拍云云储存</li>\n<li>API-Waline: 评论后台，ECS -&gt; swas</li>\n<li>Site-Blog: 博客主体，ECS -&gt; swas</li>\n<li>Site-Editor: 在线编辑器，ECS -&gt; swas</li>\n<li>Site-Guard: ServerStatus，ECS -&gt; swas</li>\n<li>Site-Travel: 旅行地图，ECS -&gt; swas</li>\n</ul>\n\n        <h2 id=\"迁移\"   >\n          <a href=\"#迁移\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#迁移\"></a> 迁移</h2>\n      \n\n        <h3 id=\"api-img\"   >\n          <a href=\"#api-img\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#api-img\"></a> API-Img</h3>\n      \n<p>  根据又拍云文档创建云储存服务，更改img.foolishfox.cn的CNAME的解析，备份文件即可。</p>\n\n        <h3 id=\"site-blog\"   >\n          <a href=\"#site-blog\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#site-blog\"></a> Site-Blog</h3>\n      \n<p>  又进行一次之前的迁移，可以看之前的<a href=\"/posts/202012-heog.html\">文章</a>。<br />\n  为了方便下一步的安装，可以选择安装<code>n</code>进行<code>Node.js</code>的版本管理，另外还可以更改<code>npm</code>源为淘宝源，加快下载、安装速度。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/03/20210330204237.png\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"site-editor\"   >\n          <a href=\"#site-editor\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#site-editor\"></a> Site-Editor</h3>\n      \n<p>  进行了上一步之后，服务器已经安装好了<code>Node.js</code>环境，剩下的只需要安照<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://winwin_2011.gitee.io/winwin-hexo-editor/\" >文档</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>安装即可。<br />\n  使用<code>pm2</code>启动后，需要设置<code>Nginx</code>反向代理，方便通过域名进行访问。例如<code>winwin-hexo-editor</code>运行在8900端口，设置<code>write.foolishfox.cn</code>的反向代理为<code>127.0.0.1:8900</code>。</p>\n\n        <h3 id=\"site-guard\"   >\n          <a href=\"#site-guard\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#site-guard\"></a> Site-Guard</h3>\n      \n<p>  ServerStatus一开始是一个老外的项目，可以理解为多服务器探针、多服务器云监控。后来国人进行了汉化和修改，我这里使用的是<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/nyawork/\" >nyawork</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>开发的<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/nyawork/ServerStatus-Hotaru\" >ServerStatus-Hotaru</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>版本。安装十分简单，只需要下载好文件，按照步骤进行即可。</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">root@vultr:~<span class=\"comment\"># wget https://raw.githubusercontent.com/nyawork/ServerStatus-Hotaru/master/status.sh</span></span><br><span class=\"line\">root@vultr:~<span class=\"comment\"># chmod +x status.sh</span></span><br></pre></td></tr></table></div></figure>\n<p>  因为要从Github下载文件，所以安装速度比较慢。例如下载<code>master.zip</code>，可以打开<code>status.sh</code>文件找到下载链接，下载好之后更改文件名为<code>master.zip</code>，再上传到<code>/tmp</code>文件夹下，这样速度会快很多。除了<code>master.zip</code>，还有一个文件是<code>jq</code>，事先创建好<code>/usr/local/ServerStatus</code>文件夹，将下载好的文件重命名后放在该文件下。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/03/20210330205244.png\"  alt=\"\" />\n      <br />\n  要修改的话，可以直接更改<code>/usr/local/ServerStatus/server/config.json</code>文件，重启<code>status.sh</code>即可。</p>\n\n        <h3 id=\"site-travel\"   >\n          <a href=\"#site-travel\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#site-travel\"></a> Site-Travel</h3>\n      \n<p>  <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/yc111/footprint\" >footprint</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>是由<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/yc111/\" >yc111</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>开发的利用echarts展示旅行足迹的项目。前面已经配置好了<code>Node.js</code>环境，只需安装依赖即可运行。然后设置Nginx反向目录代理，将<code>api.foolishfox.cn/travel</code>指向<code>127.0.0.1:1024</code>。</p>\n\n        <h3 id=\"api-waline\"   >\n          <a href=\"#api-waline\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#api-waline\"></a> API-Waline</h3>\n      \n<p>  <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://waline.js.org/\" >waline</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>是由<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/lizheming\" >lizheming</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>开发的博客评论系统，是最难配置的一部分。Waline有多达48钟部署方式，下面介绍两种部署方式：</p>\n\n        <h4 id=\"docker\"   >\n          <a href=\"#docker\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#docker\"></a> Docker</h4>\n      \n<p>  由于有自己的服务器和数据库，最开始选择了Waline/client+Docker+MySQL的方式进行部署。</p>\n<ol>\n<li>修改<code>Node.js</code>淘宝源</li>\n<li>构建镜像</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/lizheming/waline.git</span><br><span class=\"line\"><span class=\"built_in\">cd</span> waline</span><br><span class=\"line\">docker build -t lizheming/waline -f packages/server/Dockerfile .</span><br></pre></td></tr></table></div></figure>\n<ol start=\"3\">\n<li>修改配置<code>packages/client/.env</code></li>\n</ol>\n<figure class=\"highlight plain\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">SITE_NAME&#x3D;Fox Home</span><br><span class=\"line\">SITE_URL&#x3D;https:&#x2F;&#x2F;foolishfox.cn</span><br><span class=\"line\"></span><br><span class=\"line\"># 配置参考：</span><br><span class=\"line\"># https:&#x2F;&#x2F;waline.js.org&#x2F;server&#x2F;databases.html</span><br><span class=\"line\"># https:&#x2F;&#x2F;waline.js.org&#x2F;server&#x2F;notification.html</span><br><span class=\"line\">MYSQL_HOST&#x3D;127.0.0.1</span><br><span class=\"line\">MYSQL_DB&#x3D;db_name</span><br><span class=\"line\">MYSQL_USER&#x3D;db_user</span><br><span class=\"line\">MYSQL_PASSWORD&#x3D;password</span><br><span class=\"line\">SC_KEY&#x3D;SCK232027Td54bfab83cfabf0aereq2c31b6552cd35fe1a43720074</span><br><span class=\"line\">AUTHOR_EMAIL&#x3D;fox@foolishfox.cn</span><br></pre></td></tr></table></div></figure>\n<ol start=\"4\">\n<li>运行镜像</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run --env-file ./packages/client/.env -p 8360:8360 -d lizheming/waline</span><br></pre></td></tr></table></div></figure>\n<ol start=\"5\">\n<li>设置反向目录代理，将<code>api.foolishfox.cn/waline</code>指向<code>127.0.0.1:8360</code></li>\n</ol>\n\n        <h4 id=\"独立部署\"   >\n          <a href=\"#独立部署\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#独立部署\"></a> 独立部署</h4>\n      \n<p>  由于方便对配置进行修改，不需要更新镜像等原因，后来弃用了Docker部署，改为直接使用<code>Node.js</code>运行。</p>\n<ol>\n<li>安装waline</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir walinejs &amp;&amp; <span class=\"built_in\">cd</span> walinejs</span><br><span class=\"line\">cnpm install @waline/vercel --save</span><br></pre></td></tr></table></div></figure>\n<ol start=\"2\">\n<li>编辑<code>.bashrc</code>，添加环境变量，最好将字符串用<code>&quot;</code>或者<code>'</code>包起来，避免<code>$</code>、<code>&amp;</code>等字符的影响</li>\n<li>创建软链接，方便后续操作</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">ln -s node_modules/@waline/vercel ./waline</span><br><span class=\"line\"><span class=\"built_in\">cd</span> waline</span><br></pre></td></tr></table></div></figure>\n<ol start=\"4\">\n<li>配置服务端<code>vim config.js</code></li>\n</ol>\n<figure class=\"highlight js\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">    secureDomains: [</span><br><span class=\"line\">        <span class=\"string\">&#x27;localhost&#x27;</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;127.0.0.1&#x27;</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></div></figure>\n<ol start=\"5\">\n<li>修改主程序<code>vanilla.js</code></li>\n</ol>\n<figure class=\"highlight js\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> Application = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;thinkjs&#x27;</span>);</span><br><span class=\"line\">...</span><br><span class=\"line\"><span class=\"keyword\">let</span> config = &#123;&#125;</span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    config = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;./config.js&#x27;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span>(e) &#123;&#125;</span><br><span class=\"line\">...</span><br></pre></td></tr></table></div></figure>\n<ol start=\"6\">\n<li>使用pm2运行程序</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">cnpm install -g pm2</span><br><span class=\"line\">pm2 start vanilla.js --name waline</span><br></pre></td></tr></table></div></figure>\n<ol start=\"7\">\n<li>设置反向目录代理，将<code>api.foolishfox.cn/waline</code>指向<code>127.0.0.1:8360</code></li>\n</ol>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ol>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://segmentfault.com/a/1190000023054090\" >Windows SSH 免密登录详解</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><a href=\"/posts/202012-heog.html\">从WordPress搬迁——使用Hexo搭建博客</a></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://newsn.net/say/node-n.html\" >如何利用n轻松切换nodejs的版本</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://winwin_2011.gitee.io/winwin-hexo-editor/\" >winwin-hexo-editor</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/nyawork/ServerStatus-Hotaru\" >ServerStatus-Hotaru</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/yc111/footprint\" >footprint</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://waline.js.org/\" >waline</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ol>\n","categories":["博客成长日志"],"tags":["Hexo","安装","反向代理","Waline"]},{"title":"AE9/AP9/SPM | GUI使用","url":"/posts/202103-ae9-4.html","content":"\n        <h2 id=\"概述\"   >\n          <a href=\"#概述\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#概述\"></a> 概述</h2>\n      \n<p>  <code>Ae9Ap9Gui.exe</code>提供了一个简单的图形用户界面前端，使用<code>CmdLineAe9Ap9.exe</code>运行模型。根据用户界面中的选择，将生成具有相应参数设置的输入文件，然后运行模型，可能会生成计算结果的二维图。</p>\n<span id=\"more\"></span>\n<p>  对于每一次模型的运行，用户需要指定<code>Run Name</code>作为文件名前缀，<code>Run Directory</code>作为保存输出文件的目录，分别默认为<code>Run1</code>和<code>Run</code>。文件名前缀会影响输入和输出文件，输出目录通常是<code>Ae9Ap9Gui.exe</code>的相对目录，但可以是绝对目录路径。</p>\n\n    <div class=\"note-plugin info\">\n      <span class=\"note-plugin__icon note-plugin__icon--info\">\n              <i class=\"fas fa-info-circle\"></i>\n            </span>\n      <p><strong>Tip</strong><br />可以使用环境变量</p>\n    </div>\n  \n<p>  GUI使用用户指定的配置文件来定义模型数据库文件，并记录GUI的使用状态。如果不存在配置文件，将会自动生成默认的配置文件，路径为：<code>%AppData%/Ae9Ap9/Gui_v1.50.ini</code>.<br />\n  GUI窗口右上角的<code>Config</code>菜单按钮允许用户修改配置，还可以选择将所有GUI项目重置为默认设置。如果需要，可以更新模型数据库或者目录设置。在非必要的情况下，推荐仅使用模型随附的数据库文件。</p>\n\n    <div class=\"note-plugin info\">\n      <span class=\"note-plugin__icon note-plugin__icon--info\">\n              <i class=\"fas fa-info-circle\"></i>\n            </span>\n      <p><strong>Tip</strong><br />GUI对高分辨率屏幕的适配很差，可以参考<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.csdn.net/QXK2001/article/details/51296819\" >修改windows10在高分屏下的应用的dpi</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>解决</p>\n    </div>\n  \n<p>  如果使用快捷方式，则GUI可能会从二进制可执行文件目录以外的其他目录启动。模型数据库配置将需要修改，将默认相对路径更改为绝对路径。除非指定了采用绝对路径的<code>Run Directory</code>，否则将相对于该起始目录生成模型运行文件。先前生成的模型运行输入文件中的设置可用于初始化GUI状态，在命令行上将运行目录和名称指定为参数：</p>\n<figure class=\"highlight powershell\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">Ae9Ap9Gui [&lt;<span class=\"type\">RunDirectory</span>&gt; &lt;<span class=\"type\">RunName</span>&gt;]</span><br></pre></td></tr></table></div></figure>\n<p>  GUI拥有三个选项卡式页面，分别为<code>Satellite</code>，<code>Model</code>和<code>Plot</code>：在<code>Satellite</code>页面可以定义轨道路径，在<code>Model</code>页面可以模型参数，在<code>Plot</code>页面可以显示模型运行的结果。</p>\n\n        <h2 id=\"satellite-tab\"   >\n          <a href=\"#satellite-tab\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#satellite-tab\"></a> Satellite Tab</h2>\n      \n<p>  该页面设置用于定义在特定时间段和增量内沿卫星轨道路径计算辐射环境模型值的时间和轨道位置的参数。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/03/Satellite.png\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"orbit-specification-type\"   >\n          <a href=\"#orbit-specification-type\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#orbit-specification-type\"></a> Orbit Specification Type</h3>\n      \n<p>  在这里可以选择用不同的类型指定轨道，在界面右侧的<code>Ephemeris File Content</code>会显示相应的需要设定的参数。</p>\n<p>  如果需要使用现有的星历文件，选择<code>Ephemeris (Time+Pos)</code>模式，然后在<code>Input File</code>中输入文件路径。为了使<code>CmdLineAe9Ap9.exe</code>正确处理此文件中包含的时间和位置信息，必须在右侧的<code>Time Format</code>中指定其格式。除此之外，右侧还可以设置坐标系和数据分割符。</p>\n\n    <div class=\"note-plugin warning\">\n      <span class=\"note-plugin__icon note-plugin__icon--warning\">\n              <i class=\"fas fa-exclamation-circle\"></i>\n            </span>\n      <p><strong>Warn</strong><br />请注意，日期必须在1950年1月1日至2049年12月31日的范围内，对应简化儒略日(Modified Julian Date, MJD)的范围是：33282.0 – 69806.9999</p>\n    </div>\n  \n\n        <h3 id=\"ephemeris-file-content\"   >\n          <a href=\"#ephemeris-file-content\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#ephemeris-file-content\"></a> Ephemeris File Content</h3>\n      \n<p>  位于右侧的是用户界面控件，可以指定现有星历文件的时间格式，坐标系、单位以及数据列定界符。受支持的时间格式和坐标系见后表，受支持的数据定界符为逗号，空格和制表符。</p>\n\n        <h2 id=\"model-tab\"   >\n          <a href=\"#model-tab\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#model-tab\"></a> Model Tab</h2>\n      \n\n        <h2 id=\"plot-tab\"   >\n          <a href=\"#plot-tab\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#plot-tab\"></a> Plot Tab</h2>\n      \n","categories":["软件/程序"],"tags":["科普","AE9/AP9/SPM"]},{"title":"AE9/AP9/SPM | 输出数据","url":"/posts/202102-ae9-3.html","content":"<style>\n.content-wrap--noside {\n  width: 95%;\n  margin: 0 auto;\n}\n</style>\n\n        <h2 id=\"输出文件结构\"   >\n          <a href=\"#输出文件结构\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#输出文件结构\"></a> 输出文件结构</h2>\n      \n<p>  模型输出文件的名称主要由由输入文件中的<code>OutFile</code>和<code>FluxOut</code>参数决定，部分可选的输入文件参数参数值会影响后缀，在这种情况下，每个输出文件都有唯一的文件名，该文件名还可以提供内容的描述信息。</p>\n<span id=\"more\"></span>\n<style type=\"text/css\">\ntable.tftable {font-size:14px;color:#333333;width:100%;border-width: 1px;border-color: #729ea5;border-collapse: collapse;}\ntable.tftable th {background-color:#acc8cc;border-width: 1px;padding: 8px;border-style: solid;border-color: #729ea5;text-align: center;}\ntable.tftable tr {background-color:#ffffff;}\ntable.tftable td {border-width: 1px;padding: 8px;border-style: solid;border-color: #729ea5;text-align: center;}\n</style>\n<div class=\"table-container\"><table id=\"tfhover\" class=\"tftable\" border=\"1\">\n<tr><th>前缀</th><th>数据模式(由FluxOut决定)</th><th>数据类型(见下表)</th><th>Percentile, Scenario or Aggregation Id(由FluxOut和Aggregate决定)</th><th>文件拓展名</th></tr>\n<tr><td rowspan=\"4\">OutFile(不带文件拓展名)</td><td>_mean</td><td rowspan=\"4\">由*Out和AccumMode决定</td><td>-n/a- for mean</td><td rowspan=\"4\">OutFile的文件拓展名(默认为txt)</td></tr>\n<tr><td>_pctile</td><td>_## (percentile, in <FluxOut> value)</td></tr>\n<tr><td rowspan=\"2\">_pert<br />_mc</td><td>_### (scenario identification #)</td></tr>\n<tr><td>_agg_mean (usage is discouraged)<br />_conf_level_##</td></tr>\n</table></div>\n<div class=\"table-container\"><table id=\"tfhover\" class=\"tftable\" border=\"1\">\n<tr><th>AccumMode数据类型</th><th>Cumul</th><th>Interval</th><th>Full</th><th>Boxcar</th><th>Expon</th></tr>\n<tr><td>Flux</td><td>_flux</td><td>_fluxIntvAvg</td><td>_fluxFullAvg</td><td>_fluxRunAvg</td><td>_fluxExpAvg</td></tr>\n<tr><td>Fluence</td><td>_fluence</td><td>_fluenceIntv</td><td>_fluenceFull</td><td rowspan=\"3\" colspan=\"2\">- - - - - - -</td></tr>\n<tr><td>DoseRate</td><td>_doserate</td><td>_doserateIntvAvg</td><td>_doserateFullAvg</td></tr>\n<tr><td>DoseAccum</td><td>_doseaccum</td><td>_doseaccumIntv</td><td>_doseaccumFull</td></tr>\n</table></div>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/03/outconfig.jpg\"  alt=\"\" />\n      </p>\n<p style=\"margin: 0 auto;font-size: 14px;min-width: 100px;text-align: center;\"><b><scan>Fig1. input file</scan></b></p>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/03/outfile.jpg\"  alt=\"\" />\n      </p>\n<p style=\"margin: 0 auto;font-size: 14px;min-width: 100px;text-align: center;\"><b><scan>Fig2. output files</scan></b></p>\n\n        <h2 id=\"数据转化\"   >\n          <a href=\"#数据转化\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#数据转化\"></a> 数据转化</h2>\n      \n<p>  可以使用<code>ConvertToXlsx.py</code>，将生成的ASCII输出文件转换为Microsoft Excel格式的相应文件，该文件还能够转换生成的ASCII星历表、绝热不变输出文件以及由GUI应用程序生成的绘图文件。要运行该文件，需要在电脑上安装的Python版本不低于2.5，并且安装了<code>XlsxWriter</code>、<code>numpy</code>模块：</p>\n<figure class=\"highlight powershell\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">python ConvertToXlsx.py &lt;filename1&gt; [&lt;<span class=\"type\">filename2</span>&gt; … &lt;<span class=\"type\">filenameN</span>&gt;]</span><br></pre></td></tr></table></div></figure>\n<p>  生成的<code>*.xlsx</code>文件与输入文件位于同一目录中，文件头信息保留在新生成的Excel文件中。</p>\n","categories":["软件/程序"],"tags":["科普","AE9/AP9/SPM"]},{"title":"AE9/AP9/SPM | 输入文件","url":"/posts/202102-ae9-2.html","content":"<style>\n.content-wrap--noside {\n  width: 95%;\n  margin: 0 auto;\n}\n</style>\n\n        <h2 id=\"输入文件构造\"   >\n          <a href=\"#输入文件构造\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#输入文件构造\"></a> 输入文件构造</h2>\n      \n<p>  文件的基本格式是键值对：<code>Key:Value</code>，关键字和键值都不区分大小写，以<code>#</code>开头的行将被认为是注释。各参数可以分为以下四类：</p>\n<ul>\n<li>基本模型参数(Basic Model Inputs)：核心参数，任何输入文件都需要</li>\n<li>高级模型参数(Advanced Model Inputs)：类似输入输出格式或者俯仰角的可选参数</li>\n<li>聚合参数(Accumulation and Aggregation Inputs)：用于组合复杂输出结果的可选参数</li>\n<li>剂量计算参数(Dose Calculation Inputs)：驱动<code>ShieldDose2</code>模型进行计算的可选参数</li>\n<li>轨道预报参数(Orbit Propagator Inputs)：用于生成轨道星历的可选参数</li>\n</ul>\n<span id=\"more\"></span>\n\n    <div class=\"note-plugin info\">\n      <span class=\"note-plugin__icon note-plugin__icon--info\">\n              <i class=\"fas fa-info-circle\"></i>\n            </span>\n      <p><strong>Tip</strong><br />可以使用环境变量来代替表示路径或者文件名的参数值，例如在环境变量中设置好<code>AX9HOME</code>，然后可以在文件中使用<code>MagFieldDB: %AX9HOME%/modelData/igrfDB.h5</code></p>\n    </div>\n  \n<style>\n  table {\n    font-size: 14px;\n  }\n</style>\n\n        <h3 id=\"基本参数\"   >\n          <a href=\"#基本参数\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#基本参数\"></a> 基本参数</h3>\n      \n<div class=\"table-container\"><table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><strong>关键字</strong></th>\n<th style=\"text-align:center\"><strong>可选值</strong></th>\n<th style=\"text-align:center\"><strong>默认</strong></th>\n<th style=\"text-align:center\"><strong>必选</strong></th>\n<th style=\"text-align:center\"><strong>描述</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">ModelType</td>\n<td style=\"text-align:center\">AE9 AP9 PLASMA</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Y</td>\n<td style=\"text-align:center\">模型类型，需要在ModelDB参数中指定的相应数据库文件<br />除非指定了俯仰角或方向矢量，否则计算得出的模型结果将是全方向的</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ModelDB</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Y</td>\n<td style=\"text-align:center\">用于驱动模型的数据库文件，与选定的ModelType相对应<br />必须包含文件的路径(绝对路径或相对于CmdLineAe9Ap9应用程序执行位置的路径)<br /> 对于PLASMA：指定适当的<code>SPM*</code>种类文件：<code>E</code>(电子)/<code>H</code>/<code>HE</code>(He)/<code>O</code></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MagFieldDB</td>\n<td style=\"text-align:center\">igrfDB.h5</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Y</td>\n<td style=\"text-align:center\">磁场模型的数据库文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">KPhiNNetDB</td>\n<td style=\"text-align:center\">fastPhi_net.mat</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Y</td>\n<td style=\"text-align:center\">K/Phi坐标神经网络的数据库文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">KHminNNetDB</td>\n<td style=\"text-align:center\">fast_hmin_net.mat</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Y</td>\n<td style=\"text-align:center\">K/Hmin坐标神经网络的数据库文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">OutFile</td>\n<td style=\"text-align:center\">有效路径和文件名</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Y</td>\n<td style=\"text-align:center\">生成模型输出文件时使用的路径和文件名前缀</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">OrbitFile</td>\n<td style=\"text-align:center\">星历文件的有效路径和文件名</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Y</td>\n<td style=\"text-align:center\">包含时间和位置信息的文件，有以下两种方式：<br />1. 输出：同时指定轨道类型和预测参数时，将生成星历表并写入该文件<br />通过TimeSpec，CoordSys，CoordUnits，CoordOrder和DataDelim描述格式<br />2. 输入：从现有文件中读取<br />通过InTimeSpec，InCoordSys，InCoordUnits，InCoordOrder和InDataDelim描述格式</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">FluxType</td>\n<td style=\"text-align:center\">1PtDiff 2PtDiff* Integral <sup class=\"footnote-ref\"><a href=\"#fn1\" id=\"fnref1\">1</a></sup></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Y</td>\n<td style=\"text-align:center\">计算的通量类型</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Energies</td>\n<td style=\"text-align:center\">AE9: 0.04 – 10.0 (MeV)<br />AP9: 0.1 – 2000.0 (MeV)<br />Plasma/electrons: 0.001 – 0.040 (MeV)<br />Plasma/ions: 0.00115 – 0.1643 (MeV)</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Y</td>\n<td style=\"text-align:center\">以MeV表示的能级列表计算通量值，能量值限制在模型的范围内</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Energies2</td>\n<td style=\"text-align:center\">同Energies</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">N</td>\n<td style=\"text-align:center\">仅在FluxType=2PtDiff时使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">FluxOut</td>\n<td style=\"text-align:center\">Mean<br />Percentile, ##<br />Perturbed, ###<br />MonteCarlo, ###* <sup class=\"footnote-ref\"><a href=\"#fn2\" id=\"fnref2\">2</a></sup></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Y</td>\n<td style=\"text-align:center\">要生成/输出的通量数据模式，此参数可能会出现多次<br />百分数在1-99之间<br />扰动均值和蒙特卡洛scenario identification numbers在1-999之间</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">FluenceOut<br />FlueOut</td>\n<td style=\"text-align:center\">True or False</td>\n<td style=\"text-align:center\">F</td>\n<td style=\"text-align:center\">N</td>\n<td style=\"text-align:center\">要生成/输出的通量数据</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DoseRateOut<br />DoseOut</td>\n<td style=\"text-align:center\">True or False</td>\n<td style=\"text-align:center\">F</td>\n<td style=\"text-align:center\">N</td>\n<td style=\"text-align:center\">要生成/输出的剂量率数据 <sup class=\"footnote-ref\"><a href=\"#fn3\" id=\"fnref3\">3</a></sup></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DoseAccumOut<br />CDoseOut</td>\n<td style=\"text-align:center\">True or False</td>\n<td style=\"text-align:center\">F</td>\n<td style=\"text-align:center\">N</td>\n<td style=\"text-align:center\">要生成/输出的累积剂量数据 <sup class=\"footnote-ref\"><a href=\"#fn3\" id=\"fnref3:1\">3:1</a></sup></td>\n</tr>\n</tbody>\n</table></div>\n\n        <h3 id=\"高级参数\"   >\n          <a href=\"#高级参数\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#高级参数\"></a> 高级参数</h3>\n      \n<p>  待更新</p>\n\n        <h3 id=\"聚合参数\"   >\n          <a href=\"#聚合参数\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#聚合参数\"></a> 聚合参数</h3>\n      \n<p>  待更新</p>\n\n        <h3 id=\"计量参数\"   >\n          <a href=\"#计量参数\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#计量参数\"></a> 计量参数</h3>\n      \n<p>  待更新</p>\n\n        <h3 id=\"轨道参数\"   >\n          <a href=\"#轨道参数\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#轨道参数\"></a> 轨道参数</h3>\n      \n<p>  待更新</p>\n\n        <h2 id=\"附录\"   >\n          <a href=\"#附录\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#附录\"></a> 附录</h2>\n      \n\n        <h3 id=\"支持的坐标系\"   >\n          <a href=\"#支持的坐标系\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#支持的坐标系\"></a> 支持的坐标系</h3>\n      \n<p>  有关坐标系的完整说明，参见<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://scholar.googleusercontent.com/scholar?q=cache:RfsVMa2oC_wJ:scholar.google.com/&amp;hl=zh-CN&amp;as_sdt=0,5\" >Bhavnani和Vancour, 1991</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span><sup class=\"footnote-ref\"><a href=\"#fn4\" id=\"fnref4\">4</a></sup><sup class=\"footnote-ref\"><a href=\"#fn5\" id=\"fnref5\">5</a></sup></p>\n<div class=\"table-container\"><table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><strong>简称</strong></th>\n<th style=\"text-align:center\"><strong>全称</strong></th>\n<th style=\"text-align:center\"><strong>默认参数及单位</strong><sup class=\"footnote-ref\"><a href=\"#fn6\" id=\"fnref6\">6</a></sup></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">GEI</td>\n<td style=\"text-align:center\">地心惯性系</td>\n<td style=\"text-align:center\">X(Re), Y(Re), Z(Re)<sup class=\"footnote-ref\"><a href=\"#fn7\" id=\"fnref7\">7</a></sup></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">GEO</td>\n<td style=\"text-align:center\">地理坐标系</td>\n<td style=\"text-align:center\">X(Re), Y(Re), Z(Re)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">GDZ</td>\n<td style=\"text-align:center\">World Geodetic System 1984</td>\n<td style=\"text-align:center\">Altitude(km), Lat(deg), Lon(deg)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">GSM</td>\n<td style=\"text-align:center\">地心太阳磁轴系</td>\n<td style=\"text-align:center\">X(Re), Y(Re), Z(Re)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">GSE</td>\n<td style=\"text-align:center\">地心太阳黄道系</td>\n<td style=\"text-align:center\">X(Re), Y(Re), Z(Re)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SM</td>\n<td style=\"text-align:center\">太阳磁坐标</td>\n<td style=\"text-align:center\">X(Re), Y(Re), Z(Re)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MAG</td>\n<td style=\"text-align:center\">地磁坐标系</td>\n<td style=\"text-align:center\">X(Re), Y(Re), Z(Re)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SPH</td>\n<td style=\"text-align:center\">球坐标</td>\n<td style=\"text-align:center\">Radius(Re), Colatitude(deg), Lon(deg)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">RLL</td>\n<td style=\"text-align:center\">半径，纬度，经度</td>\n<td style=\"text-align:center\">Radius(Re), Lat(deg), Lon(deg)</td>\n</tr>\n</tbody>\n</table></div>\n<hr class=\"footnotes-sep\" />\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"fn1\" class=\"footnote-item\"><p>剂量计算只能使用<code>1PtDiff</code> <a href=\"#fnref1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn2\" class=\"footnote-item\"><p>可以在同一行上用逗号分割多个值，例如<code>perturbed,1,2,5-10,20</code> <a href=\"#fnref2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn3\" class=\"footnote-item\"><p>不适用于SPM模型 <a href=\"#fnref3\" class=\"footnote-backref\">↩︎</a> <a href=\"#fnref3:1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn4\" class=\"footnote-item\"><p>NASA参考系说明：<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://sscweb.gsfc.nasa.gov/users_guide/Appendix_C.html\" >https://sscweb.gsfc.nasa.gov/users_guide/Appendix_C.html</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span> <a href=\"#fnref4\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn5\" class=\"footnote-item\"><p>ESA参考系说明：<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.spenvis.oma.be/help/background/coortran/coortran.html\" >https://www.spenvis.oma.be/help/background/coortran/coortran.html</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span> <a href=\"#fnref5\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn6\" class=\"footnote-item\"><p>坐标范围：Latitude=-90°—90°;Colatitude=0°—180°;Longitude=-180°—360° <a href=\"#fnref6\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"fn7\" class=\"footnote-item\"><p>1 Re = 6371.2 km <a href=\"#fnref7\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>\n</section>\n","categories":["软件/程序"],"tags":["科普","AE9/AP9/SPM"]},{"title":"AE9/AP9/SPM | 介绍与安装","url":"/posts/202102-ae9-1.html","content":"\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  <code>AE9/AP9/SPM</code>是由美国空军研究实验室(Air Force Research Laboratory)开发的，用于模拟近地空间辐射的模型。<code>AE9/AP9/SPM</code>分别用于模拟高能电子，高能质子和等离子体模型，给定卫星轨道根数或星历表，该模型将返回指定量的通量，注量或剂量，并为这些量选择适合的统计数据。<code>AE9/AP9/SPM</code>提供了两种安装模式：命令行版本和GUI版本。在国际合作者加入该项目之后，该模型被重命名为近地国际辐射环境(IRENE)。</p>\n<span id=\"more\"></span>\n\n        <h2 id=\"下载\"   >\n          <a href=\"#下载\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#下载\"></a> 下载</h2>\n      \n<p>  <code>AE9/AP9/SPM</code>的项目地址位于<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.vdl.afrl.af.mil/programs/ae9ap9/\" >VDL</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，该网站需要使用美国IP才可进行访问。我们选择使用<code>Public AE9AP9 Account</code>进行下载，而不使用<code>VDL Account</code>，因为后者需要年满18周岁的美国政府雇员，承包商或学术人员才能够申请注册。</p>\n<p>  在填写<code>Public AE9AP9 Account</code>注册信息时，注意邮箱不能使用国内邮箱或者hotmail、yahoo，Zip Code填写为00000即可。注册完成之后，密码将会通过注册邮箱发送给你，由于不可知的原因你很有可能无法收到邮件，你可以向<code>ae9ap9@vdl.afrl.af.mil</code>发送邮件进行询问，在得到回复之后选择重置密码即可。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/02/email_compressed.jpg\"  alt=\"\" />\n      </p>\n<p>  <code>AE9/AP9/SPM</code>默认只提供Windows版本，源代码或者Linux版本需要发邮件索求之后自行编译。</p>\n\n        <h2 id=\"第三方依赖\"   >\n          <a href=\"#第三方依赖\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#第三方依赖\"></a> 第三方依赖</h2>\n      \n\n    <div class=\"note-plugin warning\">\n      <span class=\"note-plugin__icon note-plugin__icon--warning\">\n              <i class=\"fas fa-exclamation-circle\"></i>\n            </span>\n      <p><strong>Warning</strong><br />只有编译源代码才需要安装依赖，否则直接使用即可!</p>\n    </div>\n  \n\n        <h3 id=\"cmake\"   >\n          <a href=\"#cmake\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#cmake\"></a> CMake</h3>\n      \n<p>  <code>CMake</code>版本不低于2.6，推荐选择下载Binary distributions，源代码需要编译才能使用。</p>\n\n        <h3 id=\"visual-studio-2012\"   >\n          <a href=\"#visual-studio-2012\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#visual-studio-2012\"></a> Visual Studio 2012</h3>\n      \n<p>  下载旧版本的<code>Visual Studio 2012</code>或者2008。</p>\n\n    <div class=\"note-plugin info\">\n      <span class=\"note-plugin__icon note-plugin__icon--info\">\n              <i class=\"fas fa-info-circle\"></i>\n            </span>\n      <p><strong>Tip</strong><br />A Windows-based FORTRAN compiler is also needed for a full source code compilation, but unfortunately, is not freely available. However, by default, the build process links to an included pre-compiled library of these FORTRAN-based routines.</p>\n    </div>\n  \n\n        <h3 id=\"python-recommended\"   >\n          <a href=\"#python-recommended\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#python-recommended\"></a> Python (Recommended)</h3>\n      \n<p>  推荐下载<code>Miniconda</code>，并且更改源：</p>\n<figure class=\"highlight sh\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">pip config <span class=\"built_in\">set</span> global.index-url https://mirrors.aliyun.com/pypi/simple/</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"qt-and-qwt-optional\"   >\n          <a href=\"#qt-and-qwt-optional\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#qt-and-qwt-optional\"></a> Qt and Qwt (optional)</h3>\n      \n<p>  QTW是QT的一个第三方库，两者都可以直接下载安装。</p>\n\n        <h3 id=\"hdf5-188\"   >\n          <a href=\"#hdf5-188\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#hdf5-188\"></a> HDF5 1.8.8</h3>\n      \n<p>  HDF的全程是<code>Hierarchical Data Format</code>，可以存储不同类型的图像和数码数据的文件格式，文件后缀名为<code>.hdf</code>，下载二进制版本安装即可。</p>\n\n        <h3 id=\"boost-1580\"   >\n          <a href=\"#boost-1580\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#boost-1580\"></a> Boost 1.58.0</h3>\n      \n<p>  Boost是为C++标准库提供扩展的程序库，下载解压后目录如图所示，依照参考资料5安装即可。<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/02/boost_compressed.jpg\"  alt=\"\" />\n      </p>\n\n        <h2 id=\"解压\"   >\n          <a href=\"#解压\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#解压\"></a> 解压</h2>\n      \n<p>  下载得到的是一个压缩文件，解压后目录结构为：</p>\n<figure class=\"highlight plain\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">Ae9Ap9</span><br><span class=\"line\">  bin</span><br><span class=\"line\">    win32 - 预编译32位二进制文件(Windows XP&#x2F;7)</span><br><span class=\"line\">    win64 - 预编译64位二进制文件(Windows 7)</span><br><span class=\"line\">  documents - 发行说明, 用户指南, 编译指南, 版权说明等</span><br><span class=\"line\">  modelData - 模型数据文件</span><br><span class=\"line\">  samples   - 模型样例</span><br><span class=\"line\">  unitTests - 模型的拓展数据集</span><br><span class=\"line\">  source    - 源代码根目录构建脚本(基础发行版中不存在源代码)</span><br><span class=\"line\">    Ae9Ap9Mpi      - Ae9Ap9 源代码</span><br><span class=\"line\">    SpWx_Ae9Ap9    - Ae9Ap9 所依赖的空间天气模型的源代码</span><br><span class=\"line\">    Ae9Ap9GuiMpi   - GUI 应用源代码</span><br><span class=\"line\">    buildAe9Ap9.py - Python 脚本, 用于linux, win32和win64平台的自动构建</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"编译\"   >\n          <a href=\"#编译\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#编译\"></a> 编译</h2>\n      \n\n    <div class=\"note-plugin warning\">\n      <span class=\"note-plugin__icon note-plugin__icon--warning\">\n              <i class=\"fas fa-exclamation-circle\"></i>\n            </span>\n      <p><strong>Warning</strong><br />只有源代码才需要编译，否则直接使用即可!</p>\n    </div>\n  \n<ol>\n<li>Taking note of the include and library paths for the third-party dependencies installed in the previous step, using a plain text editor, update these in the three build script configuration files:\n<ul>\n<li>Ae9Ap9/source/SpWx_Ae9Ap9/Common/internal_utils.cmake<br />\nThe configuration file contains several platform-specific sections of commands that set these paths.</li>\n</ul>\n <figure class=\"highlight cmake\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">Scroll down in the <span class=\"keyword\">file</span> to where these lines are showing:</span><br><span class=\"line\"><span class=\"comment\">##############################################################</span></span><br><span class=\"line\"><span class=\"comment\"># config_include_lib_paths</span></span><br><span class=\"line\">From here, all settings that may require modification are preceded with this line:</span><br><span class=\"line\"><span class=\"comment\"># &lt;&lt;== END-USER MODIFIABLE ==&gt;&gt;</span></span><br></pre></td></tr></table></div></figure>\n \n    <div class=\"note-plugin info\">\n      <span class=\"note-plugin__icon note-plugin__icon--info\">\n              <i class=\"fas fa-info-circle\"></i>\n            </span>\n      <p><strong>Tip</strong><br />For Windows, use forward slashes (<code>/</code>) in path references.Note the <code>set</code> of the EXT_LIBS_ROOT variable, and its subsequent reference $(EXT_LIBS_ROOT), for ease of use in multiple places. For Windows, it is suggested to set EXT_LIBS_ROOT to <code>C:/Program Files</code>.</p>\n    </div>\n  \n<ul>\n<li>Ae9Ap9/source/Ae9Ap9Mpi/internal_utils.cmake<br />\nThis file is updated in the same way as the previous file, if the GUI application is desired.</li>\n<li>Ae9Ap9/source/Ae9Ap9GuiMpi/trunk/Ae9Ap9Gui.pro<br />\nThe Ae9Ap9Gui source tree utilizes <code>qmake</code> (part of the Qt development environment) for the build process, and thus uses a slightly different file and syntax for defining the include and library paths. Important: on Linux systems, verify that the correct <code>qmake</code> version is being used; update the <code>path</code> environment variable as necessary.<br />\nThe Qt include and library paths will be automatically set properly with the installation of the Qt software. This file must only explicitly set paths for the Qwt include and library paths, as shown below. Note the platform-specific sections are also present here.</li>\n</ul>\n <figure class=\"highlight plain\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">win32 &#123;</span><br><span class=\"line\">  INCLUDEPATH +&#x3D; c:\\Qt\\qwt-5.2.1\\src</span><br><span class=\"line\">  LIBS +&#x3D; &quot;c:\\Qt\\qwt-5.2.1\\lib\\libqwt5.a&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">win64 &#123;</span><br><span class=\"line\">  INCLUDEPATH +&#x3D; c:\\Qt64\\qwt-5.2.1\\src</span><br><span class=\"line\">  LIBS +&#x3D; &quot;c:\\Qt64\\qwt-5.2.1\\lib\\libqwt5.a&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">unix &#123;</span><br><span class=\"line\">  INCLUDEPATH +&#x3D; &#x2F;nas&#x2F;ExternalLibs&#x2F;Qt&#x2F;qwt-5.2&#x2F;src</span><br><span class=\"line\">  LIBS +&#x3D; &#x2F;nas&#x2F;ExternalLibs&#x2F;Qt&#x2F;qwt-5.2&#x2F;lib&#x2F;libqwt.so</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li>Automated Build<br />\nThe preferred method of building a source distribution of IRENE (AE9/AP9/SPM) on a supported platform is to utilize the python script called <span class=\"exturl\"><a class=\"exturl__link\"   href=\"http://buildAe9Ap9.py\" >buildAe9Ap9.py</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>, located in the Ae9Ap9/source directory of the distribution. This script will build the model library and the command-line and gui driver applications, then place them in a platform-specific subdirectory under Ae9Ap9/bin in the distribution.<br />\nDuring the build process, the script will generate a log file called buildAe9Ap9.log in the Ae9Ap9/source directory; this can be used to identify any build errors encountered. At a command prompt in the <code>Ae9Ap9/source</code> directory, invoke the python build script, specifying the operating system name and, if needed, the mode (defaults to <code>release</code>): python <span class=\"exturl\"><a class=\"exturl__link\"   href=\"http://buildAe9Ap9.py\" >buildAe9Ap9.py</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span> --os=&lt;platform_name&gt; [ --mode=<type> ] [ --nompi ] [ --nogui ] where &lt;platform_name&gt; can be linux , win32 or win64, and <type> can be release or debug.<br />\nBy default, both the single- and multi-threaded versions of the programs are built, unless the optional argument <code>--nompi</code> (required for win32 builds) is specified. The GUI application is also built by default; to skip this, specify the optional argument <code>--nogui</code>. For RedHat EL or CentOS 5.x installations only, the --gcc=gcc44 option should also be included.</li>\n</ol>\n\n    <div class=\"note-plugin warning\">\n      <span class=\"note-plugin__icon note-plugin__icon--warning\">\n              <i class=\"fas fa-exclamation-circle\"></i>\n            </span>\n      <p><strong>Warning</strong><br /><code>debug</code> mode increases program execution time by a factor of 10 to 20.</p>\n    </div>\n  \n\n        <h2 id=\"安装测试\"   >\n          <a href=\"#安装测试\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装测试\"></a> 安装测试</h2>\n      \n\n        <h3 id=\"cli\"   >\n          <a href=\"#cli\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#cli\"></a> CLI</h3>\n      \n<p>  根据所用平台，在PowerShell中进入对应的二进制文件所在的目录(例如<code>Ae9Ap9\\bin\\win64</code>)，输入命令：</p>\n<figure class=\"highlight powershell\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">.\\CmdLineAe9Ap9.exe <span class=\"literal\">-i</span> ..\\..\\samples\\Ap9ShortInput.txt</span><br></pre></td></tr></table></div></figure>\n<p>  生成的输出文件位于<code>Ae9Ap9\\samples</code>文件夹下，可以根据文件生成时间判断。我们可以通过验证生成的文件数量以及相应的文件内容是否与位于<code>Ae9Ap9\\samples\\expectedOutput</code>目录中以<code>Ap9ShortOutput</code>为前缀的文件是否相同来判断是否工作正常。</p>\n\n        <h3 id=\"gui\"   >\n          <a href=\"#gui\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#gui\"></a> GUI</h3>\n      \n<p>  在同一命令行中，可以运行<code>Ae9Ap9Gui.exe</code>来启动GUI程序<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/02/GUI.jpg\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"其他\"   >\n          <a href=\"#其他\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#其他\"></a> 其他</h3>\n      \n<p>  在<code>Ae9Ap9\\bin\\win64</code>目录下还有很多其他文件，其中只有<code>CmdLineAe9Ap9.exe</code>、<code>Ae9Ap9Gui.exe</code>、<code>TotalDose.exe</code>、<code>IntegralPlasma.exe</code>、<code>ConvertToXlsx.py</code>需要用到，其他的都是辅助程序。</p>\n<div class=\"table-container\"><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">参数</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">-h</td>\n<td style=\"text-align:center\">帮助，列出所有参数说明</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-v</td>\n<td style=\"text-align:center\">输出版本信息</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-i <filename></td>\n<td style=\"text-align:center\">指定模型输入文件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-n <numproc></td>\n<td style=\"text-align:center\">指定要使用的处理器数量（默认为1）<br /> 使用多线程时包括一个主处理器，会覆盖输入文件中的NumProc参数</td>\n</tr>\n</tbody>\n</table></div>\n\n    <div class=\"note-plugin warning\">\n      <span class=\"note-plugin__icon note-plugin__icon--warning\">\n              <i class=\"fas fa-exclamation-circle\"></i>\n            </span>\n      <p><strong>Warning</strong><br />在运行时不要更改输入输入文件，因为应用程序可能会多次访问该文件</p>\n    </div>\n  \n\n        <h2 id=\"下载地址\"   >\n          <a href=\"#下载地址\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#下载地址\"></a> 下载地址</h2>\n      \n<div class=\"table-container\"><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Name</th>\n<th style=\"text-align:center\">Version</th>\n<th style=\"text-align:center\">URL</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">AE9/AP9/SPM</td>\n<td style=\"text-align:center\">1.50.1</td>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.vdl.afrl.af.mil/programs/ae9ap9/downloads.php\" >https://www.vdl.afrl.af.mil/programs/ae9ap9/downloads.php</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CMake</td>\n<td style=\"text-align:center\">≥2.6</td>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://cmake.org/download/\" >https://cmake.org/download/</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Visual Studio</td>\n<td style=\"text-align:center\">2008 or 2012</td>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://visualstudio.microsoft.com/zh-hans/vs/older-downloads/\" >https://visualstudio.microsoft.com/zh-hans/vs/older-downloads/</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Miniconda</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/\" >https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Qt</td>\n<td style=\"text-align:center\">4.6.2</td>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://download.qt.io/archive/qt/4.6/\" >https://download.qt.io/archive/qt/4.6/</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">QtW</td>\n<td style=\"text-align:center\">5.2.1</td>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://sourceforge.net/projects/qwt/files/qwt/5.2.1/\" >https://sourceforge.net/projects/qwt/files/qwt/5.2.1/</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">HDF5</td>\n<td style=\"text-align:center\">1.8.8</td>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://support.hdfgroup.org/ftp/HDF5/releases/hdf5-1.8/hdf5-1.8.8/\" >https://support.hdfgroup.org/ftp/HDF5/releases/hdf5-1.8/hdf5-1.8.8/</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Boost</td>\n<td style=\"text-align:center\">1.58.0</td>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://sourceforge.net/projects/boost/files/boost/1.58.0/\" >https://sourceforge.net/projects/boost/files/boost/1.58.0/</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n</tr>\n</tbody>\n</table></div>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ol>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.vdl.afrl.af.mil/programs/ae9ap9/\" >AE9/AP9/SPM</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.csdn.net/weixin_40011728/article/details/77924614\" >QT第三方库：Qwt的安装与使用</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.csdn.net/maweifei/article/details/80961541\" >Windows下HDF5静态库的封装与测试</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.jianshu.com/p/bf2fd1752f7f\" >在windows平台使用CMAKE安装HDF5</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.csdn.net/bxbjk/article/details/100760154\" >Windows环境下Boost的安装</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ol>\n","categories":["软件/程序"],"tags":["科普","安装","AE9/AP9/SPM"]},{"title":"安装MTProxy，轻松使用Telegram","url":"/posts/202102-mtproxy.html","content":"\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  Telegram是一款类似于QQ和微信的即时通讯软件，中文名叫电报。Telegram最大的特点，也是主打的招牌就是加密与安全：除了服务器本身加密外，还可以额外用户对用户加密，还支持设置阅后即焚，保证通信隐私安全。目前最新版本的客户端支持发送所有类型的文件和进行语音通话。</p>\n<span id=\"more\"></span>\n<p>  不过正是由于Telegram的加密特性，导致不少地区都对Telegram进行封杀，必须使用特殊手段才能使用Telegram，基于此类问题，电报官方开发了一款专门用于Telegram的代理工具——MTProxy。</p>\n<p>  MTProxy特别适合主要通过手机使用Telegram的用户，电脑一般一直开启科学上网工具，但手机不同，所以使用MTProxy可以让手机更方便地使用Telegram。</p>\n\n        <h2 id=\"手动安装\"   >\n          <a href=\"#手动安装\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#手动安装\"></a> 手动安装</h2>\n      \n\n        <h3 id=\"准备\"   >\n          <a href=\"#准备\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#准备\"></a> 准备</h3>\n      \n<p>  在安装之前，需要确认你的服务器上拥有一些基本工具：<code>openssl</code>、<code>zlib</code>、<code>gcc</code>等。</p>\n\n        <h3 id=\"build\"   >\n          <a href=\"#build\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#build\"></a> Build</h3>\n      \n<ol>\n<li>拉取源码</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/TelegramMessenger/MTProxy</span><br></pre></td></tr></table></div></figure>\n<ol start=\"2\">\n<li>编译，生成的二进制文件是objs/bin/mtproto-proxy</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> MTProxy</span><br><span class=\"line\">make &amp;&amp; <span class=\"built_in\">cd</span> objs/bin</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"config\"   >\n          <a href=\"#config\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#config\"></a> Config</h3>\n      \n<ol start=\"3\">\n<li>连接Telegram服务器，并获取配置文件</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">curl -s https://core.telegram.org/getProxySecret -o proxy-secret</span><br><span class=\"line\">curl -s https://core.telegram.org/getProxyConfig -o proxy-multi.conf</span><br></pre></td></tr></table></div></figure>\n<ol start=\"4\">\n<li>生成密钥，一定要<strong>记得记录下来</strong></li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">head -c 16 /dev/urandom | xxd -ps</span><br></pre></td></tr></table></div></figure>\n<ol start=\"5\">\n<li>创建systemd服务文件，并且填充内容</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">nano /etc/systemd/system/MTProxy.service</span><br><span class=\"line\"></span><br><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=MTProxy</span><br><span class=\"line\">After=network.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Type=simple</span><br><span class=\"line\">WorkingDirectory=/opt/MTProxy</span><br><span class=\"line\">ExecStart=/opt/MTProxy/mtproto-proxy -u <span class=\"variable\">$username</span> -p <span class=\"variable\">$localport</span> -H <span class=\"variable\">$connectport</span> -S <span class=\"variable\">$secret</span> --aes-pwd proxy-secret proxy-multi.conf -M <span class=\"variable\">$num</span></span><br><span class=\"line\">Restart=on-failure</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=multi-user.target</span><br></pre></td></tr></table></div></figure>\n<div class=\"table-container\"><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">变量名</th>\n<th style=\"text-align:center\">含义</th>\n<th style=\"text-align:center\">备注</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">username</td>\n<td style=\"text-align:center\">用户名</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">localport</td>\n<td style=\"text-align:center\">统计端口</td>\n<td style=\"text-align:center\">wget localhost:8888/stats</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">connectport</td>\n<td style=\"text-align:center\">连接端口</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">secret</td>\n<td style=\"text-align:center\">密钥</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">num</td>\n<td style=\"text-align:center\">进程数目</td>\n<td style=\"text-align:center\">默认为1即可</td>\n</tr>\n</tbody>\n</table></div>\n\n        <h3 id=\"run\"   >\n          <a href=\"#run\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#run\"></a> Run</h3>\n      \n<ol start=\"6\">\n<li>重新加载进程守护（daemons）</li>\n</ol>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl daemon-reload</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start MTProxy.service     <span class=\"comment\"># 启动MTProxy</span></span><br><span class=\"line\">systemctl stop MTProxy.service      <span class=\"comment\"># 停止MTProxy</span></span><br><span class=\"line\">systemctl restart MTProxy.service   <span class=\"comment\"># 重启MTProxy</span></span><br><span class=\"line\">systemctl status MTProxy.service    <span class=\"comment\"># 查看状态</span></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> MTProxy.service    <span class=\"comment\"># 允许开机自启</span></span><br></pre></td></tr></table></div></figure>\n<ol start=\"7\">\n<li>获取链接：<code>tg://proxy?server=SERVER_IP/SERVER_DOMAIN&amp;port=PORT&amp;secret=SECRET</code>，将其发送至任一tg聊天窗口，点击添加链接即可</li>\n</ol>\n\n        <h3 id=\"mtproxy-admin-bot\"   >\n          <a href=\"#mtproxy-admin-bot\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#mtproxy-admin-bot\"></a> MTProxy Admin Bot</h3>\n      \n<p>  MTProxy Admin Bot是Telegram官方帮助使用代理的工具，搜索添加后，通过<code>/newproxy</code>命令生成代理链接：<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/02/proxy-min.gif\"  alt=\"\" />\n      </p>\n\n        <h2 id=\"脚本安装tls伪装\"   >\n          <a href=\"#脚本安装tls伪装\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#脚本安装tls伪装\"></a> 脚本安装+TLS伪装</h2>\n      \n<p>  上面的安装过程略显繁琐，容易出错，而且更重要的问题是这样安装的代理使用的流量特征十分明显，特别容易被GFW识别，导致服务器端口甚至IP被封，最好使用其他方法进行伪装，所以可以使用一键安装脚本，例如<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/sunpma/mtp\" >MTProxy TLS</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>或者<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/ellermister/mtproxy\" >mtproxy</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，安装过程与上面类似，使用方法在Github主页中有描述：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">bash mtproxy.sh start</span><br><span class=\"line\">bash mtproxy.sh debug</span><br><span class=\"line\">bash mtproxy.sh stop</span><br><span class=\"line\">bash mtproxy.sh restart</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"qa\"   >\n          <a href=\"#qa\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#qa\"></a> Q&amp;A</h2>\n      \n<ol>\n<li>脚本安装之后无法启动<br />\n  可以使用<code>bash mtproxy.sh debug</code>命令查看问题，一般问题都是类似这样：<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/02/vultr-min-plus.png\"  alt=\"\" />\n      <br />\n  这是因为脚本下载的mtproto-proxy版本太老了，可以看到是用gcc-8编译的去年的老版本，可能和你的电脑不匹配，我的解决方案是：\n<ol>\n<li>下载原版：git clone <span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/TelegramMessenger/MTProxy\" >https://github.com/TelegramMessenger/MTProxy</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li>使用服务器上的gcc进行编译，将编译产生的mtproto-proxy二进制文件复制到一键管理脚本所在目录下，再次启动</li>\n<li>有可能出现无法运行的情况，可以将原版代码中common/pid.c中的这一行注释掉，重新编译，重复上面的步骤：</li>\n</ol>\n <figure class=\"highlight c\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">assert (!(p &amp; <span class=\"number\">0xffff0000</span>));</span><br></pre></td></tr></table></div></figure>\n</li>\n</ol>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ol>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/TelegramMessenger/MTProxy\" >MTProxy</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/sunpma/mtp\" >MTProxy TLS 绿色版一键安装脚本</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/ellermister/mtproxy\" >mtproxy</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.zxar520.com/linux/1439.html\" >MTProxy+FakeTLS|Telegram稳定代理配置教程</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html\" >Systemd 入门教程：命令篇</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ol>\n","categories":["软件/程序"],"tags":["安装","MTProxy"]},{"title":"Windows | 包管理器Scoop的安装与使用","url":"/posts/202101-a.html","content":"\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\">sudo apt install git</span><br></pre></td></tr></table></div></figure>\n<p>  在<code>Ubuntu</code>安装软件的时候敲入上面的命令是一件令人舒适的事情，而且也很便捷，想要在<code>MacOS</code>上这样操作，也可以使用<code>homebrew</code>等诸多的包管理工具。然而如果想在<code>Windows</code>安装软件，你<strong>可能</strong>需要：</p>\n<ol>\n<li>打开百度搜索软件</li>\n<li>在搜索结果中找到无毒无捆绑的版本</li>\n<li>进行安装，不停点击<code>Next</code>或者下一步</li>\n<li>结束安装</li>\n</ol>\n<span id=\"more\"></span>\n<p>  在这个过程中，你还要担心是否会混入病毒，是否会有捆绑软件同时下载；软件还很可能会索要管理员权限，把它自己安装在C盘的好位置；有些开发工具还可能会搞乱你的环境变量；最最重要的是，最后你要卸载它的时候不知道有多麻烦。</p>\n<p>  所以就有天降猛男来解决这个问题，开发了<code>Windows</code>的包管理工具。在<code>scoop</code>之前，<code>Windows</code>上的包管理工具中比较出名的是<code>Chocolaty</code>。在<code>scoop</code>横空出世之后，由于其自定义程度高、拓展性强的特性而发展迅猛，目前社区中总计有2000+的软件；另外<code>scoop</code>安装软件不依赖管理员权限，安装路径和环境变量管理也深得我这一类“绿色用户”的欢心。</p>\n\n        <h2 id=\"安装scoop\"   >\n          <a href=\"#安装scoop\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装scoop\"></a> 安装scoop</h2>\n      \n\n        <h3 id=\"安装要求\"   >\n          <a href=\"#安装要求\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装要求\"></a> 安装要求</h3>\n      \n<ul>\n<li>Windows 7或更高版本</li>\n<li>PowerShell 5.0或更高版本</li>\n<li>.NET Framework 4.5或更高版本</li>\n<li>User Name不含中文字符</li>\n<li>确认打开了远程安装权限</li>\n</ul>\n<figure class=\"highlight powershell\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$PSVersionTable</span>.PSVersion.Major                      <span class=\"comment\"># 查看Powershell版本</span></span><br><span class=\"line\"><span class=\"variable\">$PSVersionTable</span>.CLRVersion.Major                     <span class=\"comment\"># 查看.NET Framework版本</span></span><br><span class=\"line\"><span class=\"built_in\">set-executionpolicy</span> remotesigned <span class=\"literal\">-scope</span> currentuser  <span class=\"comment\"># 打开远程权限</span></span><br></pre></td></tr></table></div></figure>\n<p>  当然还有很重要的一点就是能够正常访问<code>Github</code>。</p>\n\n        <h3 id=\"配置\"   >\n          <a href=\"#配置\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#配置\"></a> 配置</h3>\n      \n<p>  默认情况下,scoop以及大多数安装的软件都位于<code>%USERPROFILE%\\scoop</code>,全局安装的程序位于<code>C:\\ProgramData\\scoop</code>，当然我们也可以自定义安装位置：</p>\n<figure class=\"highlight powershell\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$env:scoop</span>=<span class=\"string\">&#x27;D:\\scoop&#x27;</span></span><br><span class=\"line\">[<span class=\"type\">Environment</span>]::SetEnvironmentVariable(<span class=\"string\">&#x27;scoop&#x27;</span>, <span class=\"variable\">$env:scoop</span>, <span class=\"string\">&#x27;User&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$env:scoop_GLOBAL</span>=<span class=\"string\">&#x27;D:\\scoop\\GlobalApps&#x27;</span></span><br><span class=\"line\">[<span class=\"type\">Environment</span>]::SetEnvironmentVariable(<span class=\"string\">&#x27;scoop_GLOBAL&#x27;</span>, <span class=\"variable\">$env:scoop_GLOBAL</span>, <span class=\"string\">&#x27;Machine&#x27;</span>)</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"安装\"   >\n          <a href=\"#安装\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装\"></a> 安装</h3>\n      \n<figure class=\"highlight powershell\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Invoke-Expression</span> (<span class=\"built_in\">New-Object</span> System.Net.WebClient).DownloadString(<span class=\"string\">&#x27;https://get.scoop.sh&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># or the shorter:</span></span><br><span class=\"line\"><span class=\"built_in\">iwr</span> <span class=\"literal\">-useb</span> get.scoop.sh | <span class=\"built_in\">iex</span></span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"卸载\"   >\n          <a href=\"#卸载\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#卸载\"></a> 卸载</h3>\n      \n<p>  以毒攻毒，以<code>scoop</code>卸载<code>scoop</code>(先卸载其他软件)：</p>\n<figure class=\"highlight powershell\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">scoop uninstall scoop</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"基础\"   >\n          <a href=\"#基础\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#基础\"></a> 基础</h2>\n      \n\n        <h3 id=\"常用命令\"   >\n          <a href=\"#常用命令\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#常用命令\"></a> 常用命令</h3>\n      \n<p>  <code>scoop</code>的命令设计逻辑是<code>scoop + command + [object] + [options]</code>，例如<code>scoop install git -g</code>，常用的基础命令有：</p>\n<div class=\"table-container\"><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">命令</th>\n<th style=\"text-align:center\">作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">help <command></td>\n<td style=\"text-align:center\">查看帮助</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">bucket add/rm [args]</td>\n<td style=\"text-align:center\">添加、删除仓库</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">bucket list/know</td>\n<td style=\"text-align:center\">查看已有/已知仓库</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">search <appname></td>\n<td style=\"text-align:center\">匹配查找</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">info <app></td>\n<td style=\"text-align:center\">查看详情</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">home <app></td>\n<td style=\"text-align:center\">查看主页</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">install <app> [options]</td>\n<td style=\"text-align:center\">安装</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">uninstall <app> [options]</td>\n<td style=\"text-align:center\">卸载</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">update <app> [options]</td>\n<td style=\"text-align:center\">更新</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">list</td>\n<td style=\"text-align:center\">查看已安装软件</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">cache show/rm [app]</td>\n<td style=\"text-align:center\">查看或删除缓存</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">cleanup <app> [options]</td>\n<td style=\"text-align:center\">删除旧版本</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">checkup</td>\n<td style=\"text-align:center\">自检查</td>\n</tr>\n</tbody>\n</table></div>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/01/command-1-min.gif\"  alt=\"\" />\n      <br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/01/command-2-min.gif\"  alt=\"\" />\n      <br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/01/command-3-min.gif\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"安装位置\"   >\n          <a href=\"#安装位置\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装位置\"></a> 安装位置</h3>\n      \n<p>  在<a href=\"#%E9%85%8D%E7%BD%AE\">配置</a>这一步中，我们设置了<code>scoop</code>的安装位置为<code>D:\\Scoop</code>，在这个文件夹下，会有这几个子目录：</p>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/01/scoopdir.png\"  alt=\"\" />\n      </p>\n<p>  <code>app</code>就是软件的安装位置；<code>buckets</code>则是已添加的仓库（后文会提到，<code>scoop</code>的仓库实际上就是<code>git</code>的<code>repository</code>，所以该文件夹下其实就是一个一个<code>git repository</code>）；<code>cache</code>是下载缓存；<code>GlobalApps</code>是自定义的全局安装位置；<code>persist</code>则是一些配置文件；<code>shim</code>会创建一些应用的软链接，让应用之间不会互相干扰。</p>\n\n        <h3 id=\"加速\"   >\n          <a href=\"#加速\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#加速\"></a> 加速</h3>\n      \n\n        <h4 id=\"使用aria2\"   >\n          <a href=\"#使用aria2\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#使用aria2\"></a> 使用aria2</h4>\n      \n<p>  <code>aria2</code>可以利用多线程加速下载：</p>\n<figure class=\"highlight powershell\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">scoop install aria2</span><br><span class=\"line\"><span class=\"comment\"># 关闭aria2（默认开启）</span></span><br><span class=\"line\">scoop config aria2<span class=\"literal\">-enabled</span> false</span><br><span class=\"line\"><span class=\"comment\"># 配置aria2 ：重试秒数 单任务最大线程数(最大为16) 同一服务器最大连接数 最小文件分片大小</span></span><br><span class=\"line\">scoop config aria2<span class=\"literal\">-retry</span><span class=\"literal\">-wait</span> <span class=\"number\">4</span></span><br><span class=\"line\">scoop config aria2<span class=\"operator\">-split</span> <span class=\"number\">16</span></span><br><span class=\"line\">scoop config aria2<span class=\"literal\">-max</span><span class=\"literal\">-connection</span><span class=\"literal\">-per</span><span class=\"literal\">-server</span> <span class=\"number\">16</span></span><br><span class=\"line\">scoop config aria2<span class=\"literal\">-min</span><span class=\"operator\">-split</span><span class=\"literal\">-size</span> <span class=\"number\">4</span>M</span><br></pre></td></tr></table></div></figure>\n\n        <h4 id=\"设置代理\"   >\n          <a href=\"#设置代理\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#设置代理\"></a> 设置代理</h4>\n      \n<p>  <code>scoop</code>在拉取仓库更新和下载大部分软件时，都需要从国外服务器下载，速度十分感人，因此使用代理可以大大加速下载。有两种方式可以在<code>scoop</code>下载时使用代理：</p>\n<ol>\n<li>在Powershell内设置环境变量：<code>$Env:http_proxy=&quot;http://127.0.0.1:1080&quot;;$Env:https_proxy=&quot;http://127.0.0.1:1080&quot;</code></li>\n<li>更改代理设置：<code>scoop config proxy [username:password@]host:port</code>，具体配置可以查看参考资料[5]</li>\n</ol>\n\n        <h2 id=\"bucket管理\"   >\n          <a href=\"#bucket管理\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#bucket管理\"></a> Bucket管理</h2>\n      \n\n        <h3 id=\"介绍\"   >\n          <a href=\"#介绍\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#介绍\"></a> 介绍</h3>\n      \n<p>  <code>Bucket</code>其实就是一个<code>git repository</code>，主要组成就是描述如何安装软件的<code>json</code>文件。在安装<code>scoop</code>时已经附带安装<code>main bucket</code>，然后这个仓库的收录标准十分严格：</p>\n<ul>\n<li>主流的开发者工具</li>\n<li>维护中的最新版本的软件</li>\n<li>完整版本的软件</li>\n<li>不可以有GUI</li>\n<li>……</li>\n</ul>\n<p>  这使得我们只能在<code>main</code>中找到部分软件，不可以有<code>GUI</code>这一点使得大部分日常使用软件都无法下载，所以我们需要添加其他仓库，可以使用<code>scoop bucket know</code>查看官方维护的仓库，还可以在<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://scoop.netlify.app/buckets/\" >这里</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>查看较受欢迎的仓库，较完整的仓库列表可以在<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/rasa/scoop-directory/blob/master/by-score.md\" >这里</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>查看。</p>\n\n        <h3 id=\"管理\"   >\n          <a href=\"#管理\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#管理\"></a> 管理</h3>\n      \n<p>  官方维护的仓库可以直接添加，例如<code>scoop bucket add extras</code>；对于社区维护的仓库，使用<code>scoop bucket add &lt;name&gt; &lt;url&gt;</code>进行添加，例如<code>scoop bucket add dorado https://github.com/chawyehsu/dorado</code>。<br />\n  每一次安装和更新软件之前，<code>scoop</code>首先会从<code>github</code>拉取已添加仓库的更新，然后再进行操作。如果碰到不同的仓库中拥有名字相同的软件，可以加上仓库名以示区分，例如<code>scoop install main/git</code>。</p>\n\n        <h3 id=\"建立自己的bucket\"   >\n          <a href=\"#建立自己的bucket\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#建立自己的bucket\"></a> 建立自己的bucket</h3>\n      \n<p>  参考<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://zhuanlan.zhihu.com/p/165635039\" >scoop 进阶 - 建立自己 的Bucket</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></p>\n\n        <h2 id=\"app查询\"   >\n          <a href=\"#app查询\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#app查询\"></a> App查询</h2>\n      \n<p>  为了在<code>scoop</code>的许多仓库中找到自己需要的软件，可以在<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://scoop.netlify.app/apps/\" >这里</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>查询安装脚本所在的bucket。</p>\n\n        <h2 id=\"qa\"   >\n          <a href=\"#qa\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#qa\"></a> Q&amp;A</h2>\n      \n<ul>\n<li>还有其他的包管理工具吗？<br />\n  有呀，例如<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/microsoft/winget-cli\" >winget</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，是由官方推出的推出命令行安装工具，全称<code>windows package manager client</code></li>\n</ul>\n\n        <h2 id=\"仓库\"   >\n          <a href=\"#仓库\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#仓库\"></a> 仓库</h2>\n      \n<div class=\"table-container\"><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">名称</th>\n<th style=\"text-align:center\">简介</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/chawyehsu/dorado\" >dorado</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n<td style=\"text-align:center\">Yet another bucket for scoop.</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/integzz/scoopet\" >scoopet</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n<td style=\"text-align:center\">A Bucket for the Best Windows Package Manager scoop : Continuously Assisting in Academic Research.</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/kidonng/sushi\" >sushi</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n<td style=\"text-align:center\">A tasty and inclusive scoop bucket, providing various kinds of applications.</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/YiHui-Liu/limpit\" >limpit</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></td>\n<td style=\"text-align:center\">我的 scoop 的软件仓库</td>\n</tr>\n</tbody>\n</table></div>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ol>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.jianshu.com/p/29e9d40bd7a2\" >Windows下最好的包管理器–scoop</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.jianshu.com/p/50993df76b1c\" >scoop——强大的Windows命令行包管理工具</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://sspai.com/post/52710\" >给 scoop 加上这些软件仓库，让它变成强大的 Windows 软件管理器</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/lukesampson/scoop/wiki/Using-scoop-behind-a-proxy\" >Using scoop behind a proxy</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/lukesampson/scoop/wiki/Quick-Start\" >Quick Start</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://chawyehsu.com/blog/talk-about-scoop-the-package-manager-for-windows-again\" >再谈谈 scoop 这个 Windows 下的软件包管理器</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.csdn.net/muoyangoren/article/details/79531851\" >Aria2下载简述</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ol>\n","categories":["软件/程序"],"tags":["安装","Scoop"]},{"title":"在Ubuntu18.04安装ROS","url":"/posts/202101-rosinstall.html","content":"\n        <h2 id=\"简介\"   >\n          <a href=\"#简介\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#简介\"></a> 简介</h2>\n      \n<p>  ROS的全称是<code>Robot Operating System</code>，即机器人操作系统，原型来自于<code>Stanford University</code>的<code>STanford Artificial Intelligence Robot</code>和 <code>Personal Robotics</code>项目。</p>\n<p>  ROS有很多的发行版，与Ubuntu发行版本的概念类似，有LTS版本提供5年的更新。每一个版本都有对应的推荐操作系统，可以在<span class=\"exturl\"><a class=\"exturl__link\"   href=\"http://wiki.ros.org/Distributions\" >这里</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>查看目前发行的版本。版本生命周期还未结束的有：</p>\n<div class=\"table-container\"><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">版本名称</th>\n<th style=\"text-align:center\">发布日期</th>\n<th style=\"text-align:center\">提供支持至</th>\n<th style=\"text-align:center\">推荐系统</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">ROS Noetic Ninjemys</td>\n<td style=\"text-align:center\">2020年5月</td>\n<td style=\"text-align:center\">2025年5月</td>\n<td style=\"text-align:center\">Ubuntu 20.04</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ROS Melodic Morenia</td>\n<td style=\"text-align:center\">2018年5月</td>\n<td style=\"text-align:center\">2023年5月</td>\n<td style=\"text-align:center\">Ubuntu 17.10|Ubuntu 18.04|Debian 9</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ROS Kinetic Kame</td>\n<td style=\"text-align:center\">2016年5月</td>\n<td style=\"text-align:center\">2021年4月</td>\n<td style=\"text-align:center\">Ubuntu 15.10|Ubuntu 16.04|Debian 8</td>\n</tr>\n</tbody>\n</table></div>\n<span id=\"more\"></span>\n<p>  我在<code>VM ware</code>中安装的是<code>Ubuntu 18.04</code>版本，所以选择安装<code>ROS Melodic Morenia</code>。</p>\n\n        <h2 id=\"安装\"   >\n          <a href=\"#安装\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装\"></a> 安装</h2>\n      \n<p>  打开<span class=\"exturl\"><a class=\"exturl__link\"   href=\"http://wiki.ros.org/melodic/Installation\" >官方安装教程</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，选择自己对应的操作系统，按步骤进行安装</p>\n\n        <h3 id=\"添加源与密钥\"   >\n          <a href=\"#添加源与密钥\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#添加源与密钥\"></a> 添加源与密钥</h3>\n      \n<p>  众所周知的原因，国外源在国内的访问速度简直令人落泪，所以我们可以选择<span class=\"exturl\"><a class=\"exturl__link\"   href=\"http://wiki.ros.org/ROS/Installation/UbuntuMirrors\" >镜像</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，例如我选择的是清华源：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">fox@foxhome:~$ sudo sh -c <span class=\"string\">&#x27;. /etc/lsb-release &amp;&amp; echo &quot;deb http://mirrors.tuna.tsinghua.edu.cn/ros/ubuntu/ `lsb_release -cs` main&quot; &gt; /etc/apt/sources.list.d/ros-latest.list&#x27;</span></span><br></pre></td></tr></table></div></figure>\n<p>  然后就需要添加密钥，直接使用官方的命令即可：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">fox@foxhome:~$ sudo apt-key adv --keyserver <span class=\"string\">&#x27;hkp://keyserver.ubuntu.com:80&#x27;</span> --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654</span><br><span class=\"line\">Executing: /tmp/apt-key-gpghome.OtMUWc2xuJ/gpg.1.sh --keyserver hkp://keyserver.ubuntu.com:80 --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654</span><br><span class=\"line\">gpg: 密钥 F42ED6FBAB17C654：公钥 “Open Robotics &lt;info@osrfoundation.org&gt;” 已导入</span><br><span class=\"line\">gpg: 处理的总数：1</span><br><span class=\"line\">gpg:               已导入：1</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"安装aptitude\"   >\n          <a href=\"#安装aptitude\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装aptitude\"></a> 安装aptitude</h3>\n      \n<p>  有时候使用<code>apt</code>安装时，会遇到依赖问题，解决起来很麻烦，这个时候可以使用Linux下的一个小工具：<code>aptitiude</code>，它是在<code>apt</code>基础上的升级，可以帮助我们解决依赖关系问题，可以点<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://www.cnblogs.com/wangkangluo1/archive/2012/12/30/2839514.html\" >这里</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>了解更多。</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo apt install aptitude</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"安装ros\"   >\n          <a href=\"#安装ros\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装ros\"></a> 安装ROS</h3>\n      \n<p>  选择你想要的<code>ROS packages</code>进行安装，例如安装所有的包：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo aptitude install ros-melodic-desktop-full</span><br></pre></td></tr></table></div></figure>\n<p>  aptitude会给出安装方案，包括依赖问题的解决，直接<code>Y</code>继续即可</p>\n\n        <h3 id=\"设置环境变量\"   >\n          <a href=\"#设置环境变量\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#设置环境变量\"></a> 设置环境变量</h3>\n      \n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">fox@foxhome:~$ <span class=\"built_in\">echo</span> <span class=\"string\">&quot;source /opt/ros/melodic/setup.bash&quot;</span> &gt;&gt; ~/.bashrc</span><br><span class=\"line\">fox@foxhome:~$ <span class=\"built_in\">source</span> ~/.bashrc</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"检查\"   >\n          <a href=\"#检查\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#检查\"></a> 检查</h2>\n      \n<p>  在终端输入<code>roscore</code>开启ROS的运行核心(master)，注意不能在两个终端同时开启两个master<br />\n  然后打开一个新的终端，输入<code>rosrun turtlesim turtlesim_node</code>，如果弹出下图的窗口，那就安装成功了<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2021/01/rosrun.png\"  alt=\"\" />\n      </p>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ul>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://zhuanlan.zhihu.com/p/84821192\" >ROS安装教程(ROS Melodic + Ubuntu18.04)</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ul>\n","categories":["软件/程序"],"tags":["安装","ROS"]},{"title":"最低工资与资本剥削","url":"/posts/202012-c.html","content":"\n        <h2 id=\"最低工资与资本剥削\"   >\n          <a href=\"#最低工资与资本剥削\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#最低工资与资本剥削\"></a> 最低工资与资本剥削</h2>\n      \n<p>  最低工资法是国家制定的最低工资标准的法律，规定了劳动者在正常劳动的情况下，用人单位应当给予的最低劳动报酬，这个标准一般是根据劳动者的最低生活需要来制定的。而以薛兆丰为代表的一帮自由主义经济学家发表言论称：</p>\n<blockquote>\n<p>最低工资法是世界上最典型的法定福利，这种硬性规定的后果，是低薪工人失业<br />\n用命令或法律来规定工资和福利的高低，就是枉费心机</p>\n</blockquote>\n<span id=\"more\"></span>\n\n        <h3 id=\"材料\"   >\n          <a href=\"#材料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#材料\"></a> 材料</h3>\n      \n<ol>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"http://xuezhaofeng.com/blog/?p=33\" >最低工资法不可取-薛兆丰</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"http://xuezhaofeng.com/blog/?p=833\" >为什么反对最低工资制度</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>（见第十点）</li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"http://money.163.com/special/0025404U/zuidigongzihairen.html\" >最低工资法以善意伤害穷人</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/Propic.png\"  alt=\"截图\" />\n      </li>\n</ol>\n<p>  首先应该明白这一段话只是这些人的一家之言，没有充分的现实依据作为支撑。例如美国在1967至1969年间的最低工资标准是历史最高的，而同一时期的失业率低于4%，属于历史上低水平。而薛兆丰等人以某些年份的某些样本为证据，试图说明最低工资会影响到就业与贫困，是以点带面的行为。</p>\n<p>  为了说明这一类观点是错误的，就应该先了解他的逻辑。材料认为<strong>市场的供需是劳动力价格的惟一决定因素</strong>，而<strong>供需曲线</strong>证明最低工资将增加失业：劳动力作为<strong>商品</strong>（劳动力商品），如果商品提价了，企业或者用人单位作为<strong>顾客</strong>，购买商品的意愿就会降低，所以会雇佣更少的工人，而且<strong>劳动价值</strong>低于最低工资的人将再难以获得工作机会。</p>\n\n        <h3 id=\"市场经济三大规律\"   >\n          <a href=\"#市场经济三大规律\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#市场经济三大规律\"></a> 市场经济三大规律</h3>\n      \n<p>  马克思主义认为<strong>市场经济有三大规律</strong>：</p>\n<ol>\n<li>价值规律，由马克思在《哲学的贫困》一书中被阐明，它是指人类工作产品的经济交换的规范法则：产品在贸易中的相对的交换价值，通常被表示为金钱-价格，是与人类劳动时间的平均值成比例的，生产这些产品的人类劳动在当前社会是必要的，所以<strong>价值量由人类劳动的平均量决定</strong>。</li>\n<li>价格规律，即供求规律。<strong>供求调节着市场价格, 或者确切地说, 调节着市场价格同市场价值的偏离</strong>。</li>\n<li>价值决定价格规律。价格是现象，是价值的本质具象化的产物。价值量由人类劳动的平均量决定，而商品的交换价值（或者说价格）的波动是被它们的价值所控制，本质上是由资本主义的内在规律支配。从劳动价值理论出发，可以知道<strong>价值是价格围绕着运动的重心, 价格的不断涨落也是围绕着这个重心来拉平的</strong>。</li>\n</ol>\n<p>  由此出发，决定劳动力商品价格的应当是价值，而非市场的供需。所以材料中从<strong>供需曲线决定论</strong>出发来分析得到的结论也是不可取的。</p>\n\n        <h3 id=\"劳动力商品\"   >\n          <a href=\"#劳动力商品\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#劳动力商品\"></a> 劳动力商品</h3>\n      \n<p>  另外<strong>劳动力商品的价值是由维持和延续劳动力所必须的生活资料的价值决定的，是由生产和再生产自身劳动力商品所消耗的生活资料的价值决定的</strong>。在现实情况中劳动力的价格或者说工资水平一般是低于，甚至是远远低于其价值，因为资本家攫取了工人的剩余价值以谋得利润，而材料试图以供求关系压低工资（或者劳动力商品的价格）来掩盖资本家对工人的剥削：<strong>资本家们凭借对生产资料的垄断权在对抗性生产关系无偿占有了生产者的剩余价值</strong>。</p>\n<p>  材料中还认为最低工资是典型的“法定福利”，但实际上最低工资仅仅只是满足人的基本生存需要，这正是前文所提及的劳动力商品的价值的一部分，因此劳动价值低于最低工资的人难以找到工作的说法也是不成立的。</p>\n<p>  事实上低薪工人的失业本质是因为资本家不愿放弃剩余价值：就资本主义社会而言，<strong>只要是资本，就会追求价值增殖</strong>（即剩余价值的生产），<strong>其外在表现形式就是利润</strong>。而为了实现价格增值，资本就要从劳动者、生产者手中获取剩余价值，就要无偿占用工人的剩余劳动，这种<strong>资本家占有剩余价值的行为，就是资本对劳动的经济剥削</strong>，所以<strong>资本的增殖属性就带有剥削属性，不能将二者割裂开来</strong>。</p>\n<p>  为了能够剥削剩余价值，<strong>资本必须雇佣劳动，或必须与工人发生雇佣劳动关系</strong>，没有雇佣劳动就没有资本家。如果站在生产关系的高度看这种雇佣劳动，它就是<strong>死劳动对活劳动的一种单向度且不平等的权力支配关系</strong>，这种支配关系构成资本主义生产关系的内容。</p>\n<p>  马克思说：</p>\n<blockquote>\n<p>工人生产的财富越多，他的产品力量和数量越大，他就越贫穷。工人创造的产品越多，他就变成廉价的商品。物的世界的增值同人的世界的贬值成正比。</p>\n</blockquote>\n<p>  实际上，<strong>工资是异化劳动的直接结果</strong>。在资本家与劳动者的关系中，劳动者并不是在为自己劳动，生产出来的劳动产品不属于劳动者自身，而属于所谓的“产权”所有者，劳动仅仅是劳动者个人的生活手段，用以维持自己的生存，这造成了人和自己的类本质相异化，使人不成其为人。</p>\n\n        <h3 id=\"政治与经济因素\"   >\n          <a href=\"#政治与经济因素\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#政治与经济因素\"></a> 政治与经济因素</h3>\n      \n<p>  材料中还有一句话：</p>\n<blockquote>\n<p>用命令或法律来规定工资和福利的高低，就是枉费心机</p>\n</blockquote>\n<p>  从马克思主义的观点来看，法律和工资、福利等是政治或者经济的具体因素，<strong>越是具体，政治因素和经济因素往往相互作⽤</strong>。政治因素可以先于或者晚于某种具体的政治⾏为⽽出现，<strong>不存在谁决定谁，是双向影响关系</strong>。所以枉费心机一词也没有道理。</p>\n<p>  假设没有最低工资法的存在，资本家对于工人的优势，再加上资本本身的逐利性，资本家会追求以更低的工资雇佣更少的人（哪怕他们知道这样会导致消费水平降低），产生糟糕的结果。</p>\n<p>  现行的最低工资也有不足。工人的总收入除了工资之外还有各种福利，如果硬性规定了最低工资水平，贪图剩余价值的资本将会想方设法地从其他方面削减支出，最终可能导致工人的总收入降低，所以这还需要劳动法的进一步完善与更加详细的制约。</p>\n<p>  劳动力不单纯是生产要素，也不是资本中的商品，而应该被看成需要全面发展的人本身，这是马克思主义政治经济学的观点。随着社会的发展，逐步过渡到社会主义与共产主义，劳动力会逐渐去商品化，使人回归人的本质，使人成其为人。</p>\n\n        <h2 id=\"后记\"   >\n          <a href=\"#后记\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#后记\"></a> 后记</h2>\n      \n<p>  这是本人在学习马克思主义基本原理概论课程后的课程报告，体现的是本人对材料的看法、认识，稍显幼稚，肯定有很多不当、偏颇之处，欢迎批评指正，拒绝抬杠谩骂。</p>\n","categories":["随记"],"tags":["马列毛邓"]},{"title":"博客成长日志 | 使用Hexo搭建博客","url":"/posts/202012-heog.html","content":"\n        <h2 id=\"前言\"   >\n          <a href=\"#前言\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#前言\"></a> 前言</h2>\n      \n<p>  之前使用了很久的WordPress，用起来很方便，但是也有一些不令我满意的地方。首先，WordPress的源在国外，更新起来很慢很不方便，只好在服务器上面搭建了一个梯子。其次，WordPress的后端加载速度实在是太慢了，有点无法忍受。而且WordPress写文章感觉也没有直接写<code>markdown</code>方便。所以，哪怕WordPress还是有很多的优点，但我还是决定放弃WordPress。</p>\n<blockquote>\n<p>我知道有很多方法可以优化WordPress的加载速度，帮助更新，但是很麻烦不说，也不能从根本解决</p>\n</blockquote>\n<span id=\"more\"></span>\n<p>  然后在偶然的机会下，接触到了<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://hexo.io/zh-cn/\" >Hexo</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，看了一些示例文档，觉得不错，所以打算试一试，于是<strong>首先创建了一个ECS快照</strong>，防止操作失误数据丢失。然后趁此机会把服务器换回了我最常用的<code>Ubuntu</code>，安装了<code>Hexo</code>，按照教程进行之前数据的迁移和本身、主题等的配置，最终决定就用<code>Hexo</code>来搭建新博客。</p>\n<blockquote>\n<p>我在后面接触到了<code>Hugo</code>等其他静态博客的项目，感觉都不错，但是和<code>Hexo</code>相比没有碾压式的优越，所以也没有纠结，就继续采用<code>Hexo</code></p>\n</blockquote>\n\n        <h2 id=\"安装\"   >\n          <a href=\"#安装\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装\"></a> 安装</h2>\n      \n\n        <h3 id=\"安装路线\"   >\n          <a href=\"#安装路线\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装路线\"></a> 安装路线</h3>\n      \n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/hexoblog.png\"  alt=\"流程\" />\n      </p>\n\n        <h3 id=\"安装nodejs\"   >\n          <a href=\"#安装nodejs\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装nodejs\"></a> 安装Node.js</h3>\n      \n<p>  在安装<code>Hexo</code>之前需要安装好<code>node.js</code>。<code>Windows</code>可以直接在<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://nodejs.org/zh-cn/\" >官方网站</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>下载安装包，在安装的时候要记住<strong>加入环境变量</strong>中。<code>Linux</code>用户可以从<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/nodesource/distributions\" >NodeSource</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>安装。</p>\n<blockquote>\n<p><code>node.js</code>是基于<code>Chrome V8</code>引擎的<code>Javascript</code>运行环境，可以帮助我们在本地直接运行<code>Javascript</code>而不需要借助浏览器。</p>\n</blockquote>\n<p>  我在我的<code>Ubuntu</code>服务器上安装的时候，下载速度简直无法忍受，只好去安装了一个命令行版本的科学上网工具：<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/TyrantLucifer/ssr-command-client\" >ssr-command-client</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>。所以推荐<code>Linux</code>用户使用下载二进制文件的方式进行安装。</p>\n<blockquote>\n<p>在<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://nodejs.org/en/download/\" >官网</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>下载对应的二进制文件，可以在服务器使用<code>wget</code>的方式，也可以下载到本地，然后通过<code>FTP</code>工具上传。</p>\n</blockquote>\n<blockquote>\n<p>下载得到的是一个<code>*.tar.xz</code>文件，使用<code>tar -xvf *.tar.zx</code>进行安装，假设安装目录为<code>/usr/local/nodejs/</code>，然后添加环境变量，可以使用软链接：<code>ln -s /usr/local/nodejs/bin/node /usr/local/bin/node</code>，最后检查一下是否安装成功：</p>\n</blockquote>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">root@qjlyh:/usr/<span class=\"built_in\">local</span>/nodejs<span class=\"comment\"># node -v</span></span><br><span class=\"line\">v14.15.1</span><br><span class=\"line\">root@qjlyh:/usr/<span class=\"built_in\">local</span>/nodejs<span class=\"comment\"># npm -v</span></span><br><span class=\"line\">6.14.8</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"安装git\"   >\n          <a href=\"#安装git\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装git\"></a> 安装Git</h3>\n      \n<p>  直接下载安装包安装即可，依然注意<strong>环境变量</strong>的问题。<code>Linux</code>基本都自带了<code>git</code>，不用安装。所以关于<code>Git</code>的安装就不过多赘述。</p>\n\n        <h3 id=\"安装hexo\"   >\n          <a href=\"#安装hexo\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#安装hexo\"></a> 安装Hexo</h3>\n      \n<p>  直接按照<code>Hexo</code>官网的<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://hexo.io/zh-cn/docs/#%E5%AE%89%E8%A3%85-Hexo\" >介绍</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>安装即可：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm install hexo-cli -g</span><br></pre></td></tr></table></div></figure>\n<p>  注意之后的操作一般都是在<code>Hexo</code>的<strong>初始化目录（或者项目根目录）下进行的</strong>。如果执行失败，可以通过以下命令更改环境变量：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&#x27;PATH=&quot;$PATH:./node_modules/.bin&quot;&#x27;</span> &gt;&gt; ~/.profile</span><br></pre></td></tr></table></div></figure>\n\n        <h3 id=\"初始化\"   >\n          <a href=\"#初始化\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#初始化\"></a> 初始化</h3>\n      \n<p>  使用下面的命令初始化你的项目文件夹，并且进入文件夹安装<code>package.json</code>中的包：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo init &lt;folder&gt;</span><br><span class=\"line\"><span class=\"built_in\">cd</span> &lt;folder&gt;</span><br><span class=\"line\">npm install</span><br></pre></td></tr></table></div></figure>\n<p>  安装完成之后，项目的文件结构如下图：</p>\n<figure class=\"highlight plain\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">project folder</span><br><span class=\"line\">├── _config.yml   配置文件</span><br><span class=\"line\">├── package.json  应用程序信息</span><br><span class=\"line\">├── scaffolds     模板文件</span><br><span class=\"line\">├── source        源代码</span><br><span class=\"line\">│   ├── _drafts   草稿</span><br><span class=\"line\">│   └── _posts    文章</span><br><span class=\"line\">└── themes        主题</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"常用命令\"   >\n          <a href=\"#常用命令\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#常用命令\"></a> 常用命令</h2>\n      \n\n        <h3 id=\"写博客\"   >\n          <a href=\"#写博客\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#写博客\"></a> 写博客</h3>\n      \n<p>  <code>Hexo</code>本体支持<code>.md</code>和<code>.ejs</code>两种格式的文件，但是只要安装了对应的渲染器插件，例如<code>Hexo-renderer-pug</code>，就可以使用<code>.pug</code>格式进行写作。<br />\n  <code>scaffolds</code>文件夹以及各个主题的<code>layout</code>文件夹下，是各种页面的模板。<code>Hexo</code>自带了3个模板，都是<code>Markdown</code>格式的，分别对应草稿、文章和页面，生成新文件的命令是：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></table></div></figure>\n<p>  <code>layout</code>是可选参数，代表生成什么类型（草稿、文章或者页面），默认<code>_config.yml</code>中的<code>default_layout</code>参数；<code>title</code>是文件名。<br />\n  <strong>官方网站有很详细的说明！多读官方文档！！！</strong></p>\n\n        <h3 id=\"生成\"   >\n          <a href=\"#生成\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#生成\"></a> 生成</h3>\n      \n<p>  我们写的博文源码都是<code>.md</code>或者<code>.ejs</code>一类的文件，然后通过<code>Hexo</code>按照主题的配置生成<code>html</code>、<code>css</code>和<code>js</code>文件，使用的命令如下：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># hexo clean 可以清除缓存（删除/public目录下所有内容）</span></span><br><span class=\"line\">hexo generate</span><br><span class=\"line\">hexo g</span><br></pre></td></tr></table></div></figure>\n<p>  该命令会在根目录下生成<code>public</code>文件夹，该文件夹存储的就是网站所需要的文件了</p>\n<blockquote>\n<p>草稿很类似于所谓的私密文章，只有自己能够看到。如果想要将草稿发布，有两种办法：一种是直接将草稿从<code>_drafts</code>目录下移动到<code>_posts</code>目录，或者是使用<code>hexo publish [layout] &lt;title&gt;</code>的方式</p>\n</blockquote>\n\n        <h3 id=\"预览\"   >\n          <a href=\"#预览\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#预览\"></a> 预览</h3>\n      \n<p>  <code>Hexo</code>可以通过内置的<code>server</code>来预览生成的网站的效果：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo server --drafts</span><br><span class=\"line\">hexo s</span><br></pre></td></tr></table></div></figure>\n<p>  默认情况下不会显示草稿，–drafts参数可以强制显示草稿，或者是更改根目录下<code>_config.yml</code>的配置项：<code>render_drafts: true</code></p>\n\n        <h3 id=\"部署\"   >\n          <a href=\"#部署\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#部署\"></a> 部署</h3>\n      \n<p>  最后一步就是将你创作的内容发布，一般是通过这一个步骤将静态文件（也就是<code>public</code>文件夹）推送到<code>GitHub</code>的一个仓库中，生成<code>Github Pages</code>，首先要更改根目录下<code>_config.yml</code>的配置：</p>\n<figure class=\"highlight yaml\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">  <span class=\"attr\">type:</span> <span class=\"string\">git</span></span><br><span class=\"line\">  <span class=\"attr\">repo:</span> <span class=\"string\">&lt;repository</span> <span class=\"string\">url&gt;</span></span><br><span class=\"line\">  <span class=\"attr\">branch:</span> [<span class=\"string\">branch</span>]</span><br></pre></td></tr></table></div></figure>\n<p>  然后安装<code>hexo-deployer-git</code>插件，再执行下面的命令，就可以把<code>public</code>文件夹整体提交到<code>GitHub</code>的仓库中了：</p>\n<figure class=\"highlight bash\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">hexo deploy</span><br><span class=\"line\">hexo d</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"qa\"   >\n          <a href=\"#qa\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#qa\"></a> Q&amp;A</h2>\n      \n<ul>\n<li>为什么我不在本地搭建<code>node.js</code>环境，使用<code>Github Pages</code>搭建网站？<br />\n  首先是因为我不想在自己的电脑上安装太多的东西；其次是我通过阿里云的学生优惠，购买了一台ECS，尽管配置不高，但是应付我这个小站肯定是可以的，所以我想把它利用上。所以最终我才用的方案是：本机<code>VS Code</code>远程连接服务器进行写作，在服务器上进行部署，同时推送源码到<code>GitHub</code>仓库备份（强烈吹一波<code>VS Code</code>）</li>\n<li>在本机(<code>Windows</code>)安装这些东西太麻烦，有没有什么简便的方法？<br />\n  答案肯定是有的，可以使用<code>Chocolate</code>或者<code>Scoop</code>进行安装，强烈推荐这种方法，可以很方便的管理这些应用，不用担心把你的C盘搞得一团糟。</li>\n</ul>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ul>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://blog.csdn.net/itaffy/article/details/89455342\" >阿里云ECS服务器上安装nodejs</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://ccknbc.github.io/posts/hexo-toss/#%E5%AE%89%E8%A3%85-Node-js\" >HEXO 折腾</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://hexo.io/zh-cn/docs/\" >Hexo中文文档</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ul>\n","categories":["博客成长日志"],"tags":["Hexo","安装"]},{"title":"利用python通过百度和必应API主动推送收录","url":"/posts/202012-a.html","content":"<p>  自己写了博客，一般总是希望被更多的人看到，而他人找到你的网站的最好方法就是通过搜索引擎。所以为了能够让你的网站被收录在搜索引擎中，需要向搜索引擎主动提交(当然，如果你是dl，大可不必如此麻烦)</p>\n<span id=\"more\"></span>\n<p>  如果你是通过<code>Hexo</code>建立的网站，有很多的插件可以提供你使用，例如<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://github.com/cjh0613/hexo-submit-urls-to-search-engine\" >hexo-submit-urls-to-search-engine</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，配置可以看插件的<span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://cjh0613.com/20200603HexoSubmitUrlsToSearchEngine.html\" >文档</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span>，除了这种方法之外，还可以自己用<code>Python</code>写一个自动提交的程序。</p>\n\n        <h2 id=\"流程\"   >\n          <a href=\"#流程\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#流程\"></a> 流程</h2>\n      \n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/pushurl.png\"  alt=\"流程\" />\n      <br />\n  目前国内主要的搜索引擎就是百度，必应和谷歌，<s>如果需要主动推送谷歌的话，需要会科学上网，再加上个人觉得没什么必要，所以只添加了前两个的push</s><br />\n  2020.12.19:谷歌可以自动抓取，没必要主动推送</p>\n\n        <h2 id=\"依赖\"   >\n          <a href=\"#依赖\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#依赖\"></a> 依赖</h2>\n      \n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> re, os, urllib, requests</span><br><span class=\"line\"><span class=\"keyword\">from</span> urllib <span class=\"keyword\">import</span> request</span><br><span class=\"line\"><span class=\"keyword\">from</span> bs4 <span class=\"keyword\">import</span> BeautifulSoup</span><br><span class=\"line\"><span class=\"keyword\">import</span> xml.dom.minidom</span><br><span class=\"line\"><span class=\"keyword\">from</span> xml.dom.minidom <span class=\"keyword\">import</span> parse</span><br></pre></td></tr></table></div></figure>\n<p>  一般情况下，只要安装<code>BeautifulSoup</code>就好了</p>\n\n        <h2 id=\"收录情况\"   >\n          <a href=\"#收录情况\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#收录情况\"></a> 收录情况</h2>\n      \n<p>  在搜索引擎中输入<code>site:example.com</code>就可以查看你的网站的收录情况</p>\n\n        <h3 id=\"百度\"   >\n          <a href=\"#百度\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#百度\"></a> 百度</h3>\n      \n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">data      = requests.get(<span class=\"string\">&#x27;http://www.baidu.com/s?wd=site:&#x27;</span>+url)</span><br><span class=\"line\">content   = data.content.decode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">soup      = BeautifulSoup(content,<span class=\"string\">&#x27;lxml&#x27;</span>)</span><br><span class=\"line\">link_list = soup.find_all(<span class=\"string\">&#x27;a&#x27;</span>)</span><br></pre></td></tr></table></div></figure>\n<p>  这部分实现的是查询<code>site:example.com</code>，并且获取页面中所有的链接</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">site_list = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> link <span class=\"keyword\">in</span> link_list :</span><br><span class=\"line\">    url = link.get(<span class=\"string\">&#x27;href&#x27;</span>)</span><br><span class=\"line\">    rul = re.<span class=\"built_in\">compile</span>(<span class=\"string\">r&#x27;http://www.baidu.com/link\\?url=+.+&#x27;</span>)</span><br><span class=\"line\">    url = rul.findall(url)</span><br></pre></td></tr></table></div></figure>\n<p>  这部分是将无关的链接全部排除；百度的搜索结果都是以<code>http://www.baidu.com/link/?url=</code>进行替换的，而我们要获得的是真实网址，所以下一步要通过访问这个链接，获取真实指向的网址：</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span>:</span><br><span class=\"line\">    response = request.urlopen(url[<span class=\"number\">0</span>])</span><br><span class=\"line\">    realurl  = response.geturl()</span><br><span class=\"line\">    <span class=\"keyword\">if</span> realurl!=<span class=\"string\">&#x27;&#x27;</span> :</span><br><span class=\"line\">        site_list.append(realurl)</span><br><span class=\"line\"><span class=\"keyword\">except</span> request.HTTPError <span class=\"keyword\">as</span> e :</span><br><span class=\"line\">    print(e.code, e.reason)</span><br><span class=\"line\"><span class=\"keyword\">except</span> urllib.error.URLError <span class=\"keyword\">as</span> e :</span><br><span class=\"line\">    data = requests.get(url[<span class=\"number\">0</span>])</span><br></pre></td></tr></table></div></figure>\n<p>  <code>urllib.error.URLError</code>是为了防止有时候DNS解析不到某些域名的网址，导致程序直接退出</p>\n\n        <h3 id=\"必应\"   >\n          <a href=\"#必应\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#必应\"></a> 必应</h3>\n      \n<p>  必应和百度不同，搜索出来的结果直接就是页面链接，不需要获得真实网址：</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">data      = requests.get(<span class=\"string\">&#x27;https://cn.bing.com/search?q=site:&#123;&#125;&amp;first=&#123;&#125;0&#x27;</span>.<span class=\"built_in\">format</span>(url, page))</span><br><span class=\"line\">content   = data.content.decode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">soup      = BeautifulSoup(content,<span class=\"string\">&#x27;lxml&#x27;</span>)</span><br><span class=\"line\">link_list = soup.find_all(<span class=\"string\">&#x27;a&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">site_list = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> link <span class=\"keyword\">in</span> link_list :</span><br><span class=\"line\">    url = link.get(<span class=\"string\">&#x27;href&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> url==<span class=\"literal\">None</span> :</span><br><span class=\"line\">        <span class=\"keyword\">continue</span></span><br><span class=\"line\">    rul = re.<span class=\"built_in\">compile</span>(<span class=\"string\">r&#x27;https://foolishfox.cn/+.+&#x27;</span>)</span><br><span class=\"line\">    url = rul.findall(url)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> url==<span class=\"literal\">None</span> <span class=\"keyword\">or</span> <span class=\"keyword\">not</span> url :</span><br><span class=\"line\">        <span class=\"keyword\">continue</span></span><br><span class=\"line\">    site_list.append(url[<span class=\"number\">0</span>])</span><br><span class=\"line\"><span class=\"keyword\">return</span> site_list</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"站点链接\"   >\n          <a href=\"#站点链接\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#站点链接\"></a> 站点链接</h2>\n      \n<p>  可以通过很多手段获得站点地图。以我的网站为例，使用<code>hexo-generator-sitemap</code>直接获得了<code>sitemap.xml</code>文件</p>\n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">DOMTree   = xml.dom.minidom.parse(path)</span><br><span class=\"line\">sizemap   = DOMTree.getElementsByTagName(<span class=\"string\">&#x27;loc&#x27;</span>)</span><br><span class=\"line\">site_list = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(sizemap), <span class=\"number\">1</span>):</span><br><span class=\"line\">    url = sizemap[i].firstChild.data</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"string\">&#x27;tags&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> url <span class=\"keyword\">and</span> <span class=\"string\">&#x27;categories&#x27;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> url :</span><br><span class=\"line\">        site_list.append(url)</span><br><span class=\"line\"><span class=\"keyword\">return</span> site_list</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"百度提交\"   >\n          <a href=\"#百度提交\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#百度提交\"></a> 百度提交</h2>\n      \n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">s_url = <span class=\"string\">&#x27;http://data.zz.baidu.com/urls?site=https://foolishfox.cn&amp;token=&#x27;</span>+os.environ[<span class=\"string\">&#x27;baidu_token&#x27;</span>]</span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;content-type&#x27;</span> : <span class=\"string\">&#x27;text/plain&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;User-Agent&#x27;</span>   : <span class=\"string\">&#x27;curl/7.12.1&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;Host&#x27;</span>         : <span class=\"string\">&#x27;data.zz.baidu.com&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">url_string = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> link <span class=\"keyword\">in</span> url_list :</span><br><span class=\"line\">    url_string += link+<span class=\"string\">&#x27;\\n&#x27;</span></span><br><span class=\"line\">response = requests.request(<span class=\"string\">&#x27;POST&#x27;</span>, url=s_url, data=url_string, headers=headers)</span><br><span class=\"line\"><span class=\"keyword\">return</span> response.text</span><br></pre></td></tr></table></div></figure>\n<p>  百度API的token我已经提前设置在了环境变量中，可以避免对外公开。需要注意的是，<strong>百度API的格式要求是字符串</strong>，所以我将<code>list</code>拼接成了<code>string</code>。</p>\n\n        <h2 id=\"必应提交\"   >\n          <a href=\"#必应提交\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#必应提交\"></a> 必应提交</h2>\n      \n<figure class=\"highlight python\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\">s_url = <span class=\"string\">&#x27;https://ssl.bing.com/webmaster/api.svc/json/SubmitUrlbatch?apikey=&#x27;</span>+os.environ[<span class=\"string\">&#x27;bing_token&#x27;</span>]</span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;content-type&#x27;</span> : <span class=\"string\">&#x27;application/json&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;User-Agent&#x27;</span>   : <span class=\"string\">&#x27;curl/7.12.1&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">url_json = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;siteUrl&#x27;</span>: <span class=\"string\">&#x27;https://foolishfox.cn&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;urlList&#x27;</span>: []</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">for</span> link <span class=\"keyword\">in</span> url_list :</span><br><span class=\"line\">    url_json[<span class=\"string\">&#x27;url&#x27;</span>].append(link)</span><br><span class=\"line\">response = requests.request(<span class=\"string\">&#x27;POST&#x27;</span>, url=s_url, json=url_json, headers=headers)</span><br><span class=\"line\"><span class=\"keyword\">return</span> response.text</span><br></pre></td></tr></table></div></figure>\n<p>  必应可以采用<code>xml</code>和<code>json</code>两种格式提交，我用的是后者。如果提交单个链接，应该将<code>s_url</code>修改为<code>https://ssl.bing.com/webmaster/api.svc/json/SubmitUrl?apikey=</code>，将<code>json</code>中的<code>urlList</code>修改为<code>url</code></p>\n\n        <h2 id=\"自动提交\"   >\n          <a href=\"#自动提交\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#自动提交\"></a> 自动提交</h2>\n      \n<p>  最简单的方式就是通过<code>crontab</code>了，如果使用<code>Hexo</code>，还可以用<code>node.js</code>监听<code>hexo</code>事件，实现提交：</p>\n<figure class=\"highlight javascript\"><div class=\"table-container\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\thexo.on(<span class=\"string\">&#x27;deployAfter&#x27;</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">\t\trun();</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;Error: &quot;</span> + e.toString());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n        <h2 id=\"更新\"   >\n          <a href=\"#更新\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#更新\"></a> 更新</h2>\n      \n<ul>\n<li>2020.12.19: 修改代码中链接、流程和部分单词拼写错误</li>\n</ul>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ul>\n<li><span class=\"exturl\"><a class=\"exturl__link\"   href=\"https://cjh0613.com/20200602pythonBingUrlPush.html\" >python主动推送链接至必应Bing平台</a><span class=\"exturl__icon\"><i class=\"fas fa-external-link-alt\"></i></span></span></li>\n</ul>\n","categories":["软件/程序"],"tags":["Hexo","收录","Python"]},{"title":"星座与节气","url":"/posts/202009-a.html","content":"<p>  昨天天文协会在进行路边天文的时候，THTV的记者们采访了我们的新任会长，其中问到了一个是否相信星座的问题，让我想起了很久以前看到的一个东西，直接上表。</p>\n<span id=\"more\"></span>\n<div class=\"table-container\"><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">白羊座</th>\n<th style=\"text-align:center\">金牛座</th>\n<th style=\"text-align:center\">双子座</th>\n<th style=\"text-align:center\">巨蟹座</th>\n<th style=\"text-align:center\">狮子座</th>\n<th style=\"text-align:center\">处女座</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">3.21~4.19</td>\n<td style=\"text-align:center\">4.20~5.20</td>\n<td style=\"text-align:center\">5.21~6.21</td>\n<td style=\"text-align:center\">6.22~7.22</td>\n<td style=\"text-align:center\">7.23~8.22</td>\n<td style=\"text-align:center\">8.23~9.22</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">天秤座</td>\n<td style=\"text-align:center\">天蝎座</td>\n<td style=\"text-align:center\">射手座</td>\n<td style=\"text-align:center\">摩羯座</td>\n<td style=\"text-align:center\">水瓶座</td>\n<td style=\"text-align:center\">双鱼座</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">9.23~10.23</td>\n<td style=\"text-align:center\">10.24~11.22</td>\n<td style=\"text-align:center\">11.23~12.21</td>\n<td style=\"text-align:center\">12.22~1.19</td>\n<td style=\"text-align:center\">1.20~2.18</td>\n<td style=\"text-align:center\">2.18~3.20</td>\n</tr>\n</tbody>\n</table></div>\n<p>  然后我们看看二十四节气的情况:<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/24%E8%8A%82%E6%B0%94-1.png\"  alt=\"\" />\n      <br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/24%E8%8A%82%E6%B0%94-2.png\"  alt=\"\" />\n      <br />\n  如果我们把每个星座的首尾和中间日期拿出来(总共得到24个日期),会发现和二十四节气惊人得吻合,不得不感叹古人还真是聪明啊,哪怕地处东西两半球,却通过不同的形式表达了一套历法.<br />\n  PS:很久没有发文了,纯粹彰显一下存在感</p>\n","categories":["天文"],"tags":["科普","星座"]},{"title":"大宋清平 | 0.大宋之辩","url":"/posts/202004-a.html","content":"\n        <h2 id=\"正文\"   >\n          <a href=\"#正文\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#正文\"></a> 正文</h2>\n      \n<p>  这学期选修了历史系方城峰老师的《宋元史》：前八周讲宋史，后八周讲北方民族史；这一周刚好结束了宋史部分的最后一讲：宋代文化专题；恰逢《清平乐》7号开播，我们老师也在微信群里提到了这部剧，于是蹭蹭热度，来讲一讲这大宋，也当作是前半个学期的一些复习吧</p>\n<span id=\"more\"></span>\n<p>  提到大宋，应该有很多人的第一印象是羸弱，乃至有很多人叫弱宋，更有甚者称之为“弱怂”；他们认为，<strong>有宋一代，积贫积弱，重文轻武，尽管文化上十分发达，但是对外的软弱，导致了后来汉族的沉沦</strong>，这是从宋朝的结果来看，得出的最明显的结论；坚持这一观点的著名人物有<strong>钱穆</strong>，<strong>吕思勉</strong>，他们都是成长于<strong>中华民族备受外族凌辱，随时有可能国破家亡</strong>的时代[1]；因为，我们可以肯定，在他们坚持这一观点的背后，有一部分原因是想要**“以古论今”<strong>，为当时的政治服务；南宋的学者</strong>叶适**也曾发表过类似的言论，他说：“天下之弱势，历数古人之为国，无甚于本朝者。”</p>\n<p>  也有很多人坚持<strong>富宋论</strong>，这一观点是英国学者<strong>伊懋可</strong>提出的；与之持类似观点的还有美国学者<strong>费正清</strong>，费正清认为宋代是**“中国历史上最伟大的时期”<strong>；伊懋可主要是从</strong>经济<strong>角度去看待</strong>唐宋的变局**，他认为，<strong>唐宋变革</strong>其实是经济的转型、技术的转型、生产模式的转型；经济转型的一个主要方面，就是江南的农业开发和市场的发展造成了中国经济重心的南移[2]</p>\n<p>  但值得注意的是，他们在研究这一段历史时，采用的是西方学者管用的<strong>冲击-回应模式</strong>[3]，是为了解答为什么中国没有自主进入近现代化，反而在元朝之后陷入长久的停滞，费正清在他的《美国与中国》一书中也有所反映。他认为，“传统中国不是不变的，也不是静态的或停滞的。正相反，它曾经有过不断的变化，并且变化多端。可是变化总是在一个明显的文化形式与规章制度形式的范围之内。”</p>\n<p>  在十九世纪末、二十世纪初，日本<strong>京都学派</strong>的<strong>内藤湖南</strong>提出了<strong>唐宋变革论</strong>[4]，也就是前文提及的<strong>唐宋变革</strong>的来源；内藤湖南在《概括的唐宋时代观》中提到：“唐和宋在文化上有显著差异：唐代是中世的结束，而宋代则是近世的开始，其间包含了唐末至五代一段过渡期……从政治上来说，在于贵族政治的式微和君主独裁的出现”；其实类似的观点，在宋明乃至民国时期就有人提出，北宋的<strong>郑樵</strong>在《通志》卷二十五《氏族略》称：“自隋唐而上，官有簿状，家有谱系，官之选举必由于簿状，家之婚姻必由于谱系。”“自五季[5]以来，取士不问家世，婚姻不问阀阅。”</p>\n<p>  明朝人<strong>陈邦瞻</strong>更是从中国历史发展的大势来看待唐宋之际的大变动，而且把中国历史分作三个阶段。他在《宋史纪事本末•序》中说“然而未暇考其世已，宇宙[6]风气，其变之大者有三：鸿荒[7]一变而为唐、虞，以至于周，七国为极；再变而为汉，以至于唐，五季为极；宋其三变，而吾未其极也。变未极，则治不得不相为因。”</p>\n<p>  民国大师<strong>陈寅恪</strong>，对宋代也有自己的见解，他认为：“华夏民族之文化，历数千载之演进，<strong>造极于赵宋之世</strong>。后渐衰微，终必复振。”在建国后，<strong>胡如雷</strong>基于当时的政治形势，根据阶级斗争和土地所有制的变化，认为唐宋之际中国封建社会有着巨大变革</p>\n<p>  本文不想在这些事情上有过多的讨论，也不想发表自己的意见；于是，顺着《清平乐》的脚步，将剧中的故事娓娓道来，逐一展开，成了一个很好的选择</p>\n<p>  首先，关于这部剧的主角：宋仁宗，很多人不理解为什么要选这么一个主角。的确，在我们接受的小初高教育中，唯有秦皇汉武，唐宗宋祖，能够称之为天骄，才能够说对历史有重大贡献，至于高皇帝刘邦、宣帝刘洵、光武刘秀、三国三帝、北魏孝文、文帝杨坚、武后武曌、玄宗隆基，太祖重八、成祖朱棣、圣祖康熙、高宗乾隆也可以算是人杰</p>\n<p>  至于北宋仁宗，没有秦皇汉武的丰功伟业，没有唐宗宋祖的雄才大略，反而被他手下的臣子、一个又一个巨星所掩盖；吕夷简、宋痒、庞籍、晏殊、范仲淹、欧阳修、韩琦、富弼、文彦博、曾公亮、包拯、狄青、苏轼、曾巩、王安石、司马光、柳永、周敦颐、邵雍、张载、程颢、程颐、章惇、韩绛、吕诲、梅尧臣、王尧臣、王拱辰……这一长串的名字，让我们迷失在他们璀璨的光辉中，不由自主地忽视了散发着微弱光芒的仁宗</p>\n<p>  但是仁宗真的只是名声好，没有半点历史功绩吗？仁宗真的握着一手好牌，却打得稀巴烂吗？异国百姓、君王均为仁宗之死感到悲哀，是因为仁宗好欺负，难得遇上吗？这些问题，我们都可以在后面讲述的过程中，稍加思考；当然，仁者见仁智者见智，每个人得出的结论都会不一样，那就看各自的领悟啦</p>\n<p>  好啦，这一期就结束了，下一期开始进入正题</p>\n\n        <h2 id=\"注释\"   >\n          <a href=\"#注释\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#注释\"></a> 注释</h2>\n      \n<ol>\n<li>钱穆，1895-1900；吕思勉，1884-1957</li>\n<li>唐和北宋在实际上还没有完成经济重心南移的过程，实际上，在北宋，人口、科技、经济仍然集中在北方</li>\n<li>冲击-回应模式，强调了西方的冲击对中国进步的重要性</li>\n<li>除京都学派外，日本的东京学派也对中国的历史分期有所研究，但值得注意的是，两者在战前&amp;战时的学术研究，基本上是为了替日本侵略中国寻找合适的理由与借口</li>\n<li>五季，即五代，后梁、后唐、后晋、后汉、后周</li>\n<li>宇宙，宇代表空间，宙代表时间，与现在的宇宙有所不同</li>\n<li>鸿荒，指太古，混沌初开之世</li>\n</ol>\n\n        <h2 id=\"参考资料\"   >\n          <a href=\"#参考资料\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#参考资料\"></a> 参考资料</h2>\n      \n<ul>\n<li>课件&amp;课堂讲授，清华大学历史系，方城峰</li>\n<li>唐宋变革论究竟是怎么回事，北京大学历史系，陆扬</li>\n<li>唐宋变革论的由来与发展，首都师范大学历史学院，李华瑞</li>\n</ul>\n","categories":["历史"],"tags":["科普","宋代"]},{"title":"哈勃分歧 | 2.分析","url":"/posts/202004-c.html","content":"<p>  上一次,我介绍了测量Hubble Constant的两种方法,发现测量值有差异;这一期,我将简要分析存在差异的可能原因,并介绍一些前沿的测量哈勃常数的方法.</p>\n\n        <h2 id=\"原因\"   >\n          <a href=\"#原因\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#原因\"></a> 原因</h2>\n      \n\n        <h3 id=\"宇宙加速膨胀因子\"   >\n          <a href=\"#宇宙加速膨胀因子\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#宇宙加速膨胀因子\"></a> 宇宙加速膨胀因子</h3>\n      \n<p>  前文介绍了,哈勃常数其实是时间的函数,因此将哈勃常数对时间求导,可以得到H’(t)=-H^2(t)(1+q)</p>\n<span id=\"more\"></span>\n<p>  其中q被称为宇宙加速膨胀因子.当一个天体的红移量较大的时候,其视向速度的计算不再按照前文的公式,而需要引入参量q引入该参量之后在较高红移区域得到的哈勃常数比低红移区域要小.<br />\n  但是q的值在当今仍然无法确定,采用不同方法测定的q值相差甚远,可能影响到距离阶梯法对哈勃常数的测定.<br />\n  下图中,上方绿线是采用前文公式计算的结果,下方蓝线是考虑q=0.5后计算的结果,横轴为红移量,纵轴为v/c<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/02_q%E7%9A%84%E5%BD%B1%E5%93%8D.png\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"距离差异大\"   >\n          <a href=\"#距离差异大\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#距离差异大\"></a> 距离差异大</h3>\n      \n<p>  CMB方法测量的哈勃常数是在高红移(z=1100)的情况下.而目前造父变星周光关系的测距方法只能适用到一亿光年左右,再远的造父变星我们无法将其从本底星系中分辨出. 通过Ia型超新星,我们可以将测量更远范围内的哈勃常数,但是其最远距离依然限制在z＜1内,远远不如z=1100.<br />\n  在z=1到1100的广阔空间内,哈勃常数有着怎样的变化我们并不清楚,可能我们当前假定的哈勃常数在空间中是定值是错误的,这需要我们进一步拓展距离阶梯法的测距范围,能够得到更远距离的哈勃常数值来修正当前测量值.</p>\n\n        <h3 id=\"宇宙演化模型存在错误\"   >\n          <a href=\"#宇宙演化模型存在错误\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#宇宙演化模型存在错误\"></a> 宇宙演化模型存在错误</h3>\n      \n<p>  诺贝尔奖得主亚当·里斯(Adam Guy Riess)曾说:用CMB相关的方法测量哈勃常数,就像根据一个人童年时的照片推断现在的身体特征;用造父变星与Ia型超新星等方法计算哈勃常数,就像直接看这个人当前的特征.<br />\n  使用CMB相关方法进行测量时,我们需要建立一套理论模型来进行推断.如果这套理论模型存在错误,显然我们会得到一个错误的观测结果;为了在这种情形下得到现有的观测结果,我们就必须对初始条件进行修改,得到了错误的测量值.<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/CMB.jpg\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"其他\"   >\n          <a href=\"#其他\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#其他\"></a> 其他</h3>\n      \n<p>  当然,上面的猜测纯属作者的一派胡言;真实的原因可能非常复杂,甚至可能牵扯到一些更深层次的假设,例如我们目前普遍认为的大部分星光基本各向同性等.<br />\n  除了这些,我们可能还需要考虑到我们的仪器:我们的原始数据准确吗?可信吗?我们能不能找到更加先进的设备和方法去测量Hubble Constant这一重要的物理常数?这些都需要未来的天文学家,物理学家去思考,解决.</p>\n\n        <h2 id=\"新方法\"   >\n          <a href=\"#新方法\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#新方法\"></a> 新方法</h2>\n      \n<p>  下面将介绍一些最新的测量Hubble Constant的方法.</p>\n\n        <h3 id=\"bao重子声波振荡\"   >\n          <a href=\"#bao重子声波振荡\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#bao重子声波振荡\"></a> BAO重子声波振荡</h3>\n      \n<p>  光子－重子在早期宇宙的等离子体中碰撞产生声学振荡(BAO).它们会在背景光子里留下印记,形成冷热不均的斑点.几亿年后,物质在热斑所在的区域聚集,产生了星系.研究这些星系,也就可以探索出BAO的特征.<br />\n  除此之外,正如超新星可以作为标准烛光,BAO的物质成团性也可以作为测量宇宙学距离的标准尺,目前大约能够达到5亿光年.<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/05_BAO.jpg\"  alt=\"\" />\n      <br />\n  目前采用BAO方法得到的数值(69.8)与CMB相关方法得到的相差不大,但是目前BAO方法的样本太小,获得的数据太少.不过这项工作目前正由中国科学家进行研究.</p>\n\n        <h3 id=\"引力波\"   >\n          <a href=\"#引力波\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#引力波\"></a> 引力波</h3>\n      \n<p>  自2016年人类首次探测到引力波以来,对引力波的研究进入了全新时代.<br />\n  双中子星合并的引力波源往往存在电磁对映体,观测可以得到一种特定的光面曲线(千新星),从这个光面曲线中我们可以得到其电磁对映体的红移,进而推断出其视向速度.<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/06_%E5%8D%83%E6%96%B0%E6%98%9F.jpeg\"  alt=\"\" />\n      <br />\n  <scan style=\"font-size: 12px;color: grey;text-algin: center\">GW170817 引力波事件发生前后所在天区光学成像照片(负片)的对比。右图箭头所指黑点即为千新星AT2017gfo(SSS17a)，其附近的亮斑是它的宿主星系NGC4993</scan><br />\n  通过对合并前后引力波曲线的分析,我们可以得到合并前两个天体分别的质量以及合并后天体的质量,计算出损失的质量,进而计算出引力波所拥有的能量.通过测量我们所处位置的引力波强度,再前文测算绝对星等的方法(假定各向同性),我们可以得到引力波源的距离.<br />\n  目前双中子星合并的实例暂时只有一例,得到的Hubble Constant的值为70,但是在未来必将观测到更多的案例.</p>\n\n        <h3 id=\"红巨星\"   >\n          <a href=\"#红巨星\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#红巨星\"></a> 红巨星</h3>\n      \n<p>  红巨星(TRGB)是恒星演化过程中的一个阶段,是恒星的老年期.在这个阶段,恒星由于点燃了壳层的氢聚变反应,使得外面包层受热膨胀,体积很快增大数千倍以上,温度降低.但是由于表面积巨大,因此在地球上看来极为明亮.<br />\n  红巨星形成之前,晚年恒星内部的氦核处于简并态.当内部氦核质量达到一定程度时,恒星将会发生氦闪,其亮度大致恒定为-4等,因此也可以作为标准烛光.<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/03_TRGB.png\"  alt=\"\" />\n      <br />\n  温迪·佛里德曼(Wendy L. Freedman)通过分析来自HST(哈勃望远镜)的18个红巨星的数据,得到的哈勃常数值为:<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/07_Hubble-Constant.png\"  alt=\"\" />\n      <br />\n  目前红巨星的数据只有18个,随着数据量的积累,这种方法的分析精度将会进一步提高,为最终确定哈勃常数提供重要依据.<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/01_%E5%B0%81%E9%9D%A2.png\"  alt=\"\" />\n      </p>\n","categories":["天文"],"tags":["科普","哈勃常数"]},{"title":"哈勃分歧 | 1.测定","url":"/posts/202004-b.html","content":"<p>  哈勃常数是哈勃定律中的退行速度与距离的比值,是一个常数值;传统的方法通过距离阶梯测量出星际间的距离,再根据多普勒效应和红移计算出退行速度,由此得到哈勃常数;现代科学家通过测量宇宙微波背景辐射,结合宇宙的演化理论,得到哈勃常数;而两种方法得到的哈勃常数的值有大约9%的差异.这个差异我们称之为<strong>哈勃分歧(the tension of Hubble Constant)</strong></p>\n<span id=\"more\"></span>\n\n        <h2 id=\"背景\"   >\n          <a href=\"#背景\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#背景\"></a> 背景</h2>\n      \n\n        <h3 id=\"哈勃定律\"   >\n          <a href=\"#哈勃定律\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#哈勃定律\"></a> 哈勃定律</h3>\n      \n<p>  1929年哈勃对河外星系的视向速度与距离的关系进行了研究,得出了<strong>视向速度与距离之间大致的线性正比关系</strong>:<br />\n<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>v</mi><mo>=</mo><mi>H</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">v=Hd</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathdefault\">d</span></span></span></span><br />\n  其中v为退行速度,d为星系距离,H为比例常数,称为<strong>哈勃常数(Hubble constant)</strong>.下图中,z可以表征v.<br />\n  实际上,哈勃常数并不是一个常数,而是<strong>随时间变化的一个函数</strong>,准确的称呼应该是哈勃参量.<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/02_d-z%E5%9B%BE.png\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"造父变星\"   >\n          <a href=\"#造父变星\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#造父变星\"></a> 造父变星</h3>\n      \n<p>  上一期中提到了<strong>造父变星(Cepheid)<strong>以及周光关系,下面介绍一下造父变星的光变机理.造父变星是脉动变星的一种,<strong>光变周期稍长,变化星等不大,周期稳定</strong>;造父变星分为长周期造父变星和短周期造父变星,其中长周期造父变星又分为</strong>经典造父变星和室女座W型变星</strong>,两种类型的周光关系零点不同.<br />\n  当恒星演化到一定阶段,内部会出现不稳定性,引力和辐射压力会失去平衡,外部包层会出现<strong>周期性的膨胀和收缩</strong>,但这个脉动不涉及恒星的核心.造父变星的光变机理是基于上述原理产生的星体本身的膨胀收缩,引起半径周期性的增大与减小,表面积也周期性的增加与减少,温度和总辐射能量都发生变化,因而光度也周期性的增大与减小.另外恒星的颜色,光谱型,以及视向速度都会发生变化.<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/Cepheid.jpg\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"宇宙微波背景辐射\"   >\n          <a href=\"#宇宙微波背景辐射\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#宇宙微波背景辐射\"></a> 宇宙微波背景辐射</h3>\n      \n<p>  1965年,贝尔实验室的彭齐亚斯(Arno Penzias)和威尔逊(Robert Wilson)在调试一个为回声卫星计划而建造的角形反射天线时,在射电波段意外发现了约为3.5K的过剩天线温度.在排除了辐射来自天线内部或临近环境的可能性后,他们肯定这一<strong>各向同性,非极化</strong>的,与季节无关的辐射是来自宇宙远处的辐射信号.科学家认为,这就是宇宙微波背景辐射(cosmic microwave background,CMB)的信号.<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/CMB.jpg\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"红移\"   >\n          <a href=\"#红移\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#红移\"></a> 红移</h3>\n      \n<p>  观测发现,宇宙中绝大部分的<strong>星系,恒星都远离我们而去</strong>,这在光谱上的体现就是红移,而只有极少部分的天体谱线蓝移.这充分体现了<strong>宇宙大爆炸和宇宙膨胀</strong>的思想.<br />\n  红移的大小由红移量衡量,用z表示:<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>z</mi><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">Δ</mi><mi>λ</mi></mrow><mi>λ</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">z=\\frac{\\Delta\\lambda}{\\lambda}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2251079999999999em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8801079999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">λ</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">Δ</span><span class=\"mord mathdefault mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><br />\n  其中,λ是谱线原本的波长.</p>\n\n        <h3 id=\"测速\"   >\n          <a href=\"#测速\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#测速\"></a> 测速</h3>\n      \n<p>  通过测得光谱红(蓝)移量,我们可以利用多普勒效应的简化公式计算出天体的视向速度:<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>z</mi><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">Δ</mi><mi>λ</mi></mrow><mi>λ</mi></mfrac><mo>=</mo><mfrac><mi>v</mi><mi>c</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">z=\\frac{\\Delta\\lambda}{\\lambda}=\\frac{v}{c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2251079999999999em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8801079999999999em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">λ</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">Δ</span><span class=\"mord mathdefault mtight\">λ</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.040392em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.695392em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">c</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><br />\n  但是当速度接近光速时,简化公式不再适用,这时必须使用按相对论推导出的严格公式进行计算:<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>z</mi><mo>=</mo><msqrt><mfrac><mrow><mi>c</mi><mo>+</mo><mi>v</mi></mrow><mrow><mi>c</mi><mo>−</mo><mi>v</mi></mrow></mfrac></msqrt><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">z=\\sqrt{\\frac{c+v}{c-v}}-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8399999999999999em;vertical-align:-0.6555000000000001em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1844999999999999em;\"><span class=\"svg-align\" style=\"top:-3.8em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.802331em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">c</span><span class=\"mbin mtight\">−</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">c</span><span class=\"mbin mtight\">+</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.403331em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.1445em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.8800000000000001em;\"><svg width='400em' height='1.8800000000000001em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,\n572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,\n-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39\nc-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60\ns208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,\n-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10z\nM1001 80H400000v40H1013z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6555000000000001em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span><br />\n  由此我们可以通过<strong>测量天体的红移量,进而测定出天体的视向速度.</strong></p>\n\n        <h3 id=\"周光关系\"   >\n          <a href=\"#周光关系\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#周光关系\"></a> 周光关系</h3>\n      \n<p>  造父变星的<strong>绝对星等与光变周期之间存在简单的线性关系</strong>,通过多种方法均可得到该线性方程.通过多种方法的综合利用,现在得到的两种类型的造父变星的周光关系公式为(M为绝对照相星等,P为光变周期,以天为单位): M=-1.80-1.74lgP (经典造父变星) M=-0.35-1.75lgP (室女座W型变星)<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/03_PL-relation.jpg\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"视星等与绝对星等\"   >\n          <a href=\"#视星等与绝对星等\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#视星等与绝对星等\"></a> 视星等与绝对星等</h3>\n      \n<p>  视星等(m)是指肉眼或通过天体辐射接收器所观测到的恒星亮度,实际上是<strong>接收到的星光的照度</strong>,而绝对星等(M)是天文学家为了比较恒星亮度的真实差异定义的,数值上等于<strong>恒星在10pc(32.6ly)处的视星等.</strong> 星等公式：M=m+5-5lgr(r为距离) 发展</p>\n\n        <h2 id=\"测量\"   >\n          <a href=\"#测量\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#测量\"></a> 测量</h2>\n      \n\n        <h3 id=\"距离阶梯法\"   >\n          <a href=\"#距离阶梯法\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#距离阶梯法\"></a> 距离阶梯法</h3>\n      \n<p>  有了上述的方法,我们就可以计算出哈勃常数了(e=10):<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/H.png\"  alt=\"\" />\n      <br />\n  在科学发展的过程中,科学家通过新的观测目标来代替造父变星,特别是星系距离远到一定程度时,现有的望远镜无法分辨出单独的恒星,新的观测目标其中之一就是<strong>Ⅰa型超新星(被称为标准烛光)</strong>.拓展的方法我们称之为距离阶梯法.<br />\n  迄今为止,由距离阶梯法测得的较为精确的值是:<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/H1.png\"  alt=\"\" />\n      </p>\n\n        <h3 id=\"宇宙大爆炸\"   >\n          <a href=\"#宇宙大爆炸\" class=\"heading-link\"><i class=\"fas fa-link\"></i></a><a class=\"markdownIt-Anchor\" href=\"#宇宙大爆炸\"></a> 宇宙大爆炸</h3>\n      \n<p>  根据宇宙大爆炸模型,大爆炸后最初的宇宙是“一锅粒子汤”,均匀的分布在当时的宇宙中.但是在这原始能量分布中有<strong>微小的涨落</strong>.大约在大爆炸后10-35s,宇宙开始经历<strong>暴涨</strong>,原本的微小涨落随着宇宙的暴涨也从微观尺度急剧放大,造成的影响在宇宙中传播,从而造成了<strong>物质分布的不均匀</strong>(即微小的<strong>各向异性</strong>),其中密度较大的“沟”在未来发育成为第一代的恒星与星系.<br />\n  在宇宙暴涨和冷却的过程中,离子和电子结合形成中性原子,这些<strong>中性原子不再吸收热辐射</strong>,宇宙不再是不透明的“云雾”,光子可以在宇宙中传播,这创世的第一缕曙光残留到今天就是宇宙微波背景辐射.<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/Big-bang.jpg\"  alt=\"\" />\n      <br />\n  涨落的影响在宇宙中的传播速度与哈勃常数有关,而这种影响造成的各向异性被记录在微波背景辐射中.目前通过卫星对微波背景辐射的扫描测量,我们可以从CMB的观测数据中得到这种影响的大小,再通过宇宙的演化模型来估计哈勃常数值.这是测量的方法之一.现代天文学家采用了ΛCDM模型的方法.<br />\n  目前通过普朗克卫星测得哈勃常数值为:<br />\n\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/H2.png\"  alt=\"\" />\n      </p>\n","categories":["天文"],"tags":["科普","哈勃常数"]},{"title":"夜空 | 2020-03-31","url":"/posts/202004-d.html","content":"<p>  昨天是难得一遇的晴天，作为星空摄影小白的我，拿着手机去拍星空，也是为了我《天文学导论》的个人观星作业：<br />\n  在晴朗无月的夜晚，向北找到<strong>北极星和北斗七星</strong>，向南找到<strong>天狼星和猎户座</strong>，观测并记录<strong>这些星星在天球上的运行规律</strong>。分别在<strong>相距至少一个月的两个晴朗无月</strong>的夜晚，用相机拍摄（或手绘）以上星星组成的图像（手绘时注意各星的相对位置）</p>\n<span id=\"more\"></span>\n<p>  在图像上，按照标准的星座方式把<strong>北斗七星和猎户座中的星星用线连接起来，并标出每颗星的中文名</strong>。在每个夜晚要选择两个<strong>间隔不少于3个小时的任意两个时间节点</strong>进行拍摄和手绘。特别提醒：图像中所标注的星星必须是<strong>裸眼可见</strong>的。为了表明<strong>星群位置是否有相对变化</strong>，图中需明确画出<strong>子午线和正北（正南）位置</strong><br />\n  由于昨晚有课，下课就九点了，没有三个小时的间隔，那就只能采用手绘+拍摄的方式啦。下面是昨晚的情况：<br />\n  地点：<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>2</mn><msup><mn>8</mn><mi mathvariant=\"normal\">°</mi></msup><mn>2</mn><msup><mn>0</mn><mi mathvariant=\"normal\">′</mi></msup><mn>5</mn><msup><mn>8</mn><mi mathvariant=\"normal\">″</mi></msup><mi>N</mi><mn>11</mn><msup><mn>1</mn><mi mathvariant=\"normal\">°</mi></msup><mn>5</mn><msup><mn>0</mn><mi mathvariant=\"normal\">′</mi></msup><mn>4</mn><msup><mn>4</mn><mi mathvariant=\"normal\">″</mi></msup><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">28^{°}20^{′}58^{″}N   111^{°}50^{′}44^{″}E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.849108em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord\">8</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">°</span></span></span></span></span></span></span></span></span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mord\">5</span><span class=\"mord\"><span class=\"mord\">8</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.363em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">″</span></span></span></span></span></span></span></span></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord\">1</span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.849108em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">°</span></span></span></span></span></span></span></span></span><span class=\"mord\">5</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mord\">4</span><span class=\"mord\"><span class=\"mord\">4</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.363em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">″</span></span></span></span></span></span></span></span></span><span class=\"mord mathdefault\" style=\"margin-right:0.05764em;\">E</span></span></span></span>   时间：<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>22</mn><mo>:</mo><mn>00</mn><mo>−</mo><mn>23</mn><mo>:</mo><mn>10</mn></mrow><annotation encoding=\"application/x-tex\">22:00-23:10</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span></span></span></span><br />\n  首先找到的是<strong>北斗七星</strong>，这是北半球最常见，也是我们最熟悉的星象了：</p>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/IMG_20200331_222813.jpg\"  alt=\"\" />\n      </p>\n<p>  上面的是<strong>北斗七星</strong>，是<strong>大熊座</strong>的一部分。小时候还没有那么大的光污染，在老家能够轻而易举的看见明亮的勺状北斗；中间的是<strong>天龙座(Dragon)</strong>，所以就会有<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>ζ</mi><mi>D</mi><mi>r</mi><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">\\zeta Dra</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07378em;\">ζ</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathdefault\">a</span></span></span></span>这种名字；中心偏左的是<strong>小北斗</strong>，是<strong>小熊座</strong>的一部分，**北极星(勾陈一)**是其中的一颗；这张图不太清晰，下面是一张相对而言更高清的图片：</p>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/IMG_20200331_222839.jpg\"  alt=\"\" />\n      </p>\n<p>  昨晚我拍照的时候，我的星座：<strong>狮子座</strong>就在我的头顶，但是没有把它拍下来；而且昨晚虽然不是满月，但是初八正巧是上弦月，月光也是蛮强的，对拍摄也造成了一定影响：</p>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/IMG_20200331_225051.jpg\"  alt=\"\" />\n      </p>\n<p>  天空中的最亮的那一块就是月亮了，旁边有两颗亮星。下方那颗是<strong>猎户座</strong>的<strong>参宿四</strong>，下方的电线中间，掩藏着<strong>猎户座</strong>的<strong>腰带三星</strong>；上方那颗是<strong>双子座</strong>的四只脚之一：<strong>井宿三</strong>，还有一只脚被月亮挡住了；月亮上方的两颗亮星是<strong>双子座</strong>的两个头：<strong>北河二</strong>、<strong>北河三</strong><br />\n  左侧的电线杆旁边的亮星是<strong>天狼星</strong>，是整个夜空中最亮的一颗恒星，也是<strong>大犬座</strong>的一部分；而最上方的三根电线的中间那一根上面，有着<strong>小犬座</strong>仅有的两颗恒星之一：<strong>南河二</strong>，旁边的那颗亮星是<strong>小犬座</strong>的另一颗恒星：<strong>南河三</strong><br />\n  现在让我们掉头，看向我们的身后，有一颗十分明亮的星星：<strong>大角星</strong>：</p>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/IMG_20200331_222933.jpg\"  alt=\"\" />\n      </p>\n<p>  上方那一个星座是<strong>牧夫座</strong>，<strong>大角星</strong>是<strong>牧夫座</strong>的主星；中间的星座因为看着就像一个皇冠一样，然后又在北天球，所以称之为<strong>北冕座</strong>；右侧的那一条直线，是<strong>室女座</strong>的一条腿；下方的三个星座中，左侧是<strong>武仙座</strong>的一条手臂和部分躯干；中间是<strong>巨蛇座</strong>的头；右边是<strong>天秤座</strong>的一颗亮星</p>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/IMG_20200331_222944.jpg\"  alt=\"\" />\n      </p>\n<p>  除了这些星座的照片，我还花了10min拍了一个<strong>星轨</strong>，但是这一切却被一辆车的车灯毁了，大哭😭，流泪😭，下面的人影是我自己，想着把车灯挡住，然而并没有起到什么效果：</p>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/2020/12/13/IMG_20200331_224609.jpg\"  alt=\"\" />\n      </p>\n<p>  可以明显地看到，圆弧状的<strong>星轨</strong>都围绕着一个共同的圆心：<strong>北天极</strong>，<strong>北极星</strong>就是因为靠近<strong>北天极</strong>而得名，在<strong>南天极</strong>附近没有明显的亮星，所以大家是不是也没有听过<strong>南极星</strong>这个名字？而且<strong>北极星</strong>一直在不断变化，现在的<strong>北极星</strong>是<strong>勾陈一</strong>，而我们很熟悉的“牛郎织女”中的<strong>织女星</strong>也会在一段时间内成为<strong>北极星</strong><br />\n  今天又是一个大晴天，尽管晚上要上宋元史的课，十点才下课，但是我还是可以找机会拍一拍<strong>狮子座</strong>嘛，那么，星空，晚上再会！</p>\n","categories":["天文"],"tags":["科普","观星","星座"]},{"title":"世界，您好！","url":"/posts/202003-a.html","content":"<p>  多年前在DevC++上敲下第一行代码#include<iostream>，向世界说：“Hello! World!”</p>\n<span id=\"more\"></span>\n<p>  现在开通了第一个博客，同样说一声：“世界你好”</p>\n<p>  不怎么会说话，就引用一句歌词吧：</p>\n<p>\n        <img   class=\"lazyload lazyload-gif\"\n          src=\"/images/loading.svg\" data-src=\"https://img.foolishfox.cn/images/static/fox_paint.jpg\"  alt=\"\" />\n      </p>\n<p>  我还是从前那个少年，没有一丝丝改变；时间只不过是考验，种在心中信念丝毫未减</p>\n<p>        ——梦然</p>\n","categories":["随记"]}]